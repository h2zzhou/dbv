/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/google-closure-library/master/LICENSE
 *
 *  - zlib.js, the ultimate gzip/zlib javascript implementation (https://github.com/imaya/zlib.js)
 *    LICENSE: https://raw.github.com/imaya/zlib.js/master/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
 
// BUILT from https://github.com/ivmartel/X
 
function l(a){throw a;}var p=void 0,q=!0,s=null,t=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function v(a){return function(){return this[a]}}var w,ca=ca||{},ga=this;function ha(a){return a!==p}function x(a,b,c){a=a.split(".");c=c||ga;!(a[0]in c)&&c.execScript&&c.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&ha(b)?c[e]=b:c=c[e]?c[e]:c[e]={}}x("goog.LOCALE","en");x("goog.TRUSTED_SITE",q);x("goog.STRICT_MODE_COMPATIBLE",t);
x("goog.ENABLE_DEBUG_LOADER",q);function ia(){}
function ja(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ka(a){return"array"==ja(a)}function ma(a){var b=ja(a);return"array"==b||"object"==b&&"number"==typeof a.length}function na(a){return"string"==typeof a}function A(a){return"number"==typeof a}function pa(a){return"function"==ja(a)}function qa(a){var b=typeof a;return"object"==b&&a!=s||"function"==b}var ra="closure_uid_"+(1E9*Math.random()>>>0),sa=0;function ta(a,b,c){return a.call.apply(a.bind,arguments)}
function ua(a,b,c){a||l(Error());if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,e);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function va(a,b,c){va=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:ua;return va.apply(s,arguments)}
function wa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var xa=ca.gi&&Date.now||function(){return+new Date};function C(a,b){x(a,b,p)}function D(a,b){function c(){}c.prototype=b.prototype;a.A=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Gi=function(a,c,f){var g=Array.prototype.slice.call(arguments,2);b.prototype[c].apply(a,g)}};function ya(a,b,c){this.Ua=this.Ta=this.Sa=0;3==arguments.length?(this.Sa=Number(a),this.Ta=Number(b),this.Ua=Number(c)):a instanceof ya?(this.Sa=Number(a.x()),this.Ta=Number(a.y()),this.Ua=Number(a.d())):(this.Sa=Number(a[0]),this.Ta=Number(a[1]),this.Ua=Number(a[2]))}
ya.prototype={l:function(){return new ya(this.Sa,this.Ta,this.Ua)},ac:function(a){return this.Sa*a.x()+this.Ta*a.y()+this.Ua*a.d()},ye:function(a,b){return za(this,Aa(Ca(a,this),b))},length:function(){return Math.sqrt(this.ac(this))},mc:function(a){return new ya(this.Ta*a.d()-this.Ua*a.y(),this.Ua*a.x()-this.Sa*a.d(),this.Sa*a.y()-this.Ta*a.x())},x:v("Sa"),y:v("Ta"),d:v("Ua")};function Da(a){var b=a.length();return new ya(a.Sa/b,a.Ta/b,a.Ua/b)}
function Aa(a,b){return new ya(a.Sa*b,a.Ta*b,a.Ua*b)}function Ca(a,b){return new ya(a.Sa-b.x(),a.Ta-b.y(),a.Ua-b.d())}function za(a,b){return new ya(a.Sa+b.x(),a.Ta+b.y(),a.Ua+b.d())}function Ea(a){return new ya(-a.Sa,-a.Ta,-a.Ua)};var I=I||{};I.hl=q;I.Fa=function(a){eval("X.DEV === undefined")||window.console.time(a)};I.za=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.ri=0;this.Tk=function(){return this.ri++}};function Ga(a,b){for(var c in b){var e=b.__lookupGetter__(c),d=b.__lookupSetter__(c);c in a||(e||d?(e&&a.__defineGetter__(c,e),d&&a.__defineSetter__(c,d)):a[c]=b[c])}}var Ha=window.Th;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,d.concat(e.call(arguments)))}function c(){}"function"!==typeof this&&l(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var e=Array.prototype.slice,d=e.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
for(var Ia=0,Ja=["ms","moz","webkit","o"],Ka=0;Ka<Ja.length&&!window.requestAnimationFrame;++Ka)window.requestAnimationFrame=window[Ja[Ka]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Ja[Ka]+"CancelAnimationFrame"]||window[Ja[Ka]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-Ia)),e=window.setTimeout(function(){a(b+c)},c);Ia=b+c;return e});
window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===p&&l(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var e=new ArrayBuffer(c-a),d=new Uint8Array(this),f=new Uint8Array(e),g=a,h=0;g<c;++g,++h)f[h]=d[g];return e});C("$",Ha);C("Function.prototype.bind",Function.prototype.bind);
C("window.requestAnimationFrame",window.requestAnimationFrame);C("window.cancelAnimationFrame",window.cancelAnimationFrame);var La={},Na;function Oa(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Oa);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}D(Oa,Error);Oa.prototype.name="CustomError";var Qa={};x("goog.string.DETECT_DOUBLE_ESCAPING",t);function Ra(a,b){for(var c=a.split("%s"),e="",d=Array.prototype.slice.call(arguments,1);d.length&&1<c.length;)e+=c.shift()+d.shift();return e+c.join("%s")}
function Sa(a){if(!Ta.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ua,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Va,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Wa,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Xa,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(Ya,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(Za,"&#0;"));Qa.ei&&-1!=a.indexOf("e")&&(a=a.replace($a,"&#101;"));return a}var Ua=/&/g,Va=/</g,Wa=/>/g,Xa=/"/g,Ya=/'/g,Za=/\x00/g,$a=/e/g,Ta=Qa.ei?/[\x00&<>"'e]/:/[\x00&<>"']/;var ab={};x("goog.asserts.ENABLE_ASSERTS",t);function bb(a,b){b.unshift(a);Oa.call(this,Ra.apply(s,b));b.shift();this.vm=a}D(bb,Oa);bb.prototype.name="AssertionError";function cb(a,b){ab.il&&l(new bb("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1)))};var db={};var fb="closure_listenable_"+(1E6*Math.random()|0);function gb(a){try{return!(!a||!a[fb])}catch(b){return t}}var hb=0;function ib(a,b,c,e,d,f){ib.jl&&(this.Oi=Error().stack);this.qc=a;this.Be=b;this.src=c;this.type=e;this.capture=!!d;this.ve=f;this.key=++hb;this.Xc=this.ke=t}x("goog.events.Listener.ENABLE_MONITORING",t);function jb(a){a.Xc=q;a.qc=s;a.Be=s;a.src=s;a.ve=s};function kb(a,b){for(var c in a)b.call(p,a[c],c,a)}function lb(a){var b=[],c=0,e;for(e in a)b[c++]=a[e];return b}var mb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ob(a,b){for(var c,e,d=1;d<arguments.length;d++){e=arguments[d];for(c in e)a[c]=e[c];for(var f=0;f<mb.length;f++)c=mb[f],Object.prototype.hasOwnProperty.call(e,c)&&(a[c]=e[c])}}
function pb(a){var b=arguments.length;if(1==b&&ka(arguments[0]))return pb.apply(s,arguments[0]);for(var c={},e=0;e<b;e++)c[arguments[e]]=q;return c};var rb={};x("goog.NATIVE_ARRAY_PROTOTYPES",ca.gi);x("goog.array.ASSUME_NATIVE_FUNCTIONS",t);
var sb=Array.prototype,wb=ca.Me&&(rb.Le||sb.indexOf)?function(a,b,c){return sb.indexOf.call(a,b,c)}:function(a,b,c){c=c==s?0:0>c?Math.max(0,a.length+c):c;if(na(a))return!na(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},xb=ca.Me&&(rb.Le||sb.forEach)?function(a,b,c){sb.forEach.call(a,b,c)}:function(a,b,c){for(var e=a.length,d=na(a)?a.split(""):a,f=0;f<e;f++)f in d&&b.call(c,d[f],f,a)},yb=ca.Me&&(rb.Le||sb.map)?function(a,b,c){return sb.map.call(a,b,c)}:
function(a,b,c){for(var e=a.length,d=Array(e),f=na(a)?a.split(""):a,g=0;g<e;g++)g in f&&(d[g]=b.call(c,f[g],g,a));return d},zb=ca.Me&&(rb.Le||sb.some)?function(a,b,c){return sb.some.call(a,b,c)}:function(a,b,c){for(var e=a.length,d=na(a)?a.split(""):a,f=0;f<e;f++)if(f in d&&b.call(c,d[f],f,a))return q;return t};function Ab(a,b){var c=wb(a,b),e;(e=0<=c)&&sb.splice.call(a,c,1);return e}function Bb(a){var b=a.length;if(0<b){for(var c=Array(b),e=0;e<b;e++)c[e]=a[e];return c}return[]}
function Cb(a,b,c){return 2>=arguments.length?sb.slice.call(a,b):sb.slice.call(a,b,c)};function Db(a){this.src=a;this.oa={};this.Pd=0}w=Db.prototype;w.add=function(a,b,c,e,d){var f=a.toString();a=this.oa[f];a||(a=this.oa[f]=[],this.Pd++);var g=Eb(a,b,e,d);-1<g?(b=a[g],c||(b.ke=t)):(b=new ib(b,s,this.src,f,!!e,d),b.ke=c,a.push(b));return b};w.remove=function(a,b,c,e){a=a.toString();if(!(a in this.oa))return t;var d=this.oa[a];b=Eb(d,b,c,e);return-1<b?(jb(d[b]),sb.splice.call(d,b,1),0==d.length&&(delete this.oa[a],this.Pd--),q):t};
function Fb(a,b){var c=b.type;if(!(c in a.oa))return t;var e=Ab(a.oa[c],b);e&&(jb(b),0==a.oa[c].length&&(delete a.oa[c],a.Pd--));return e}w.Md=function(a){a=a&&a.toString();var b=0,c;for(c in this.oa)if(!a||c==a){for(var e=this.oa[c],d=0;d<e.length;d++)++b,jb(e[d]);delete this.oa[c];this.Pd--}return b};w.Bd=function(a,b,c,e){a=this.oa[a.toString()];var d=-1;a&&(d=Eb(a,b,c,e));return-1<d?a[d]:s};
w.we=function(a,b){var c=ha(a),e=c?a.toString():"",d=ha(b),f;a:{f=this.oa;var g=function(a){for(var f=0;f<a.length;++f)if((!c||a[f].type==e)&&(!d||a[f].capture==b))return q;return t},h;for(h in f)if(g.call(p,f[h])){f=q;break a}f=t}return f};function Eb(a,b,c,e){for(var d=0;d<a.length;++d){var f=a[d];if(!f.Xc&&f.qc==b&&f.capture==!!c&&f.ve==e)return d}return-1};var Gb;a:{var Hb=ga.navigator;if(Hb){var Ib=Hb.userAgent;if(Ib){Gb=Ib;break a}}Gb=""}function Kb(a){return-1!=Gb.indexOf(a)};var Lb={},Mb,Nb,Ob,Pb;x("goog.userAgent.ASSUME_IE",t);x("goog.userAgent.ASSUME_GECKO",t);x("goog.userAgent.ASSUME_WEBKIT",t);x("goog.userAgent.ASSUME_MOBILE_WEBKIT",t);x("goog.userAgent.ASSUME_OPERA",t);x("goog.userAgent.ASSUME_ANY_VERSION",t);var Qb=Lb.Vh||Lb.Uh||Lb.Yh||Lb.ai||Lb.Zh;function Rb(){return ga.navigator||s}
var Sb=Qb?Lb.Zh:Kb("Opera")||Kb("OPR"),M=Qb?Lb.Vh:Kb("Trident")||Kb("MSIE"),Tb=Qb?Lb.Uh:Kb("Gecko")&&-1==Gb.toLowerCase().indexOf("webkit")&&!(Kb("Trident")||Kb("MSIE")),Ub=Qb?Lb.ai||Lb.Yh:-1!=Gb.toLowerCase().indexOf("webkit"),Vb,Wb=Rb();Vb=Wb&&Wb.platform||"";x("goog.userAgent.ASSUME_MAC",t);x("goog.userAgent.ASSUME_WINDOWS",t);x("goog.userAgent.ASSUME_LINUX",t);x("goog.userAgent.ASSUME_X11",t);x("goog.userAgent.ASSUME_ANDROID",t);x("goog.userAgent.ASSUME_IPHONE",t);
x("goog.userAgent.ASSUME_IPAD",t);var Xb=Lb.Xh||Lb.bi||Lb.Wh||Lb.ci||Lb.bl||Lb.el||Lb.dl;Xb||(Mb=-1!=Vb.indexOf("Mac"),Nb=-1!=Vb.indexOf("Win"),Ob=-1!=Vb.indexOf("Linux"),Pb=!!Rb()&&-1!=(Rb().appVersion||"").indexOf("X11"));var Yb=Xb?Lb.Xh:Mb,Zb=Xb?Lb.bi:Nb,$b=Xb?Lb.Wh:Ob,ac=Xb?Lb.ci:Pb;function bc(){var a=ga.document;return a?a.documentMode:p}
var cc=function(){var a="",b;if(Sb&&ga.opera)return a=ga.opera.version,pa(a)?a():a;Tb?b=/rv\:([^\);]+)(\)|;)/:M?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Ub&&(b=/WebKit\/(\S+)/);b&&(a=(a=b.exec(Gb))?a[1]:"");return M&&(b=bc(),b>parseFloat(a))?String(b):a}(),dc={};
function ec(a){var b;if(!(b=Lb.cl))if(!(b=dc[a])){b=0;for(var c=String(cc).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=Math.max(c.length,e.length),f=0;0==b&&f<d;f++){var g=c[f]||"",h=e[f]||"",m=RegExp("(\\d*)(\\D*)","g"),j=RegExp("(\\d*)(\\D*)","g");do{var k=m.exec(g)||["","",""],n=j.exec(h)||["","",""];if(0==k[0].length&&0==n[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==n[1].length?0:parseInt(n[1],10))?-1:(0==k[1].length?
0:parseInt(k[1],10))>(0==n[1].length?0:parseInt(n[1],10))?1:0)||((0==k[2].length)<(0==n[2].length)?-1:(0==k[2].length)>(0==n[2].length)?1:0)||(k[2]<n[2]?-1:k[2]>n[2]?1:0)}while(0==b)}b=dc[a]=0<=b}return b}var fc=ga.document,gc=!fc||!M?p:bc()||("CSS1Compat"==fc.compatMode?parseInt(cc,10):5);var hc=!M||M&&9<=gc,ic=M&&!ec("9");!Ub||ec("528");Tb&&ec("1.9b")||M&&ec("8")||Sb&&ec("9.5")||Ub&&ec("528");Tb&&!ec("8")||M&&ec("9");function jc(){jc.nl!=kc&&(jc.kl&&(this.Oi=Error().stack),this[ra]||(this[ra]=++sa))}var kc=0;x("goog.Disposable.MONITORING_MODE",0);x("goog.Disposable.INCLUDE_STACK_ON_CREATION",q);function lc(a,b){this.type=a;this.currentTarget=this.target=b;this.defaultPrevented=this.sc=t;this.Eh=q}lc.prototype.stopPropagation=function(){this.sc=q};lc.prototype.preventDefault=function(){this.defaultPrevented=q;this.Eh=t};function mc(a){mc[" "](a);return a}mc[" "]=ia;function nc(a,b){nc.Gi(this,"constructor",a?a.type:"");this.relatedTarget=this.currentTarget=this.target=s;this.charCode=this.keyCode=this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=t;this.state=s;this.yk=t;this.lb=s;a&&this.Xa(a,b)}D(nc,lc);
nc.prototype.Xa=function(a,b){var c=this.type=a.type;this.target=a.target||a.srcElement;this.currentTarget=b;var e=a.relatedTarget;if(e){if(Tb){var d;a:{try{mc(e.nodeName);d=q;break a}catch(f){}d=t}d||(e=s)}}else"mouseover"==c?e=a.fromElement:"mouseout"==c&&(e=a.toElement);this.relatedTarget=e;this.offsetX=Ub||a.offsetX!==p?a.offsetX:a.layerX;this.offsetY=Ub||a.offsetY!==p?a.offsetY:a.layerY;this.clientX=a.clientX!==p?a.clientX:a.pageX;this.clientY=a.clientY!==p?a.clientY:a.pageY;this.screenX=a.screenX||
0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.yk=Yb?a.metaKey:a.ctrlKey;this.state=a.state;this.lb=a;a.defaultPrevented&&this.preventDefault()};nc.prototype.stopPropagation=function(){nc.A.stopPropagation.call(this);this.lb.stopPropagation?this.lb.stopPropagation():this.lb.cancelBubble=q};
nc.prototype.preventDefault=function(){nc.A.preventDefault.call(this);var a=this.lb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=t,ic)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};nc.prototype.fj=v("lb");var oc="closure_lm_"+(1E6*Math.random()|0),pc={};x("goog.events.CAPTURE_SIMULATION_MODE",2);var qc=0;function P(a,b,c,e,d){if(ka(b)){for(var f=0;f<b.length;f++)P(a,b[f],c,e,d);return s}c=rc(c);return gb(a)?a.pc(b,c,e,d):sc(a,b,c,t,e,d)}
function sc(a,b,c,e,d,f){b||l(Error("Invalid event type"));var g=!!d;if(g&&!hc){if(0==db.hg)return cb("Can not register capture listener in IE8-."),s;if(1==db.hg)return s}var h=tc(a);h||(a[oc]=h=new Db(a));c=h.add(b,c,e,d,f);if(c.Be)return c;var m=uc,j=hc?function(a){return m.call(j.src,j.qc,a)}:function(a){a=m.call(j.src,j.qc,a);if(!a)return a};e=j;c.Be=e;e.src=a;e.qc=c;a.addEventListener?a.addEventListener(b.toString(),e,g):a.attachEvent(b.toString()in pc?pc[b.toString()]:pc[b.toString()]="on"+
b.toString(),e);qc++;return c}function vc(a,b,c,e,d){if(ka(b)){for(var f=0;f<b.length;f++)vc(a,b[f],c,e,d);return s}c=rc(c);return gb(a)?a.fh(b,c,e,d):sc(a,b,c,q,e,d)}function wc(a,b,c,e,d){if(ka(b))for(var f=0;f<b.length;f++)wc(a,b[f],c,e,d);else if(c=rc(c),gb(a))a.cg(b,c,e,d);else if(a&&(a=tc(a)))(b=a.Bd(b,c,!!e,d))&&xc(b)}
function xc(a){if(A(a)||!a||a.Xc)return t;var b=a.src;if(gb(b))return Fb(b.ub,a);var c=a.type,e=a.Be;b.removeEventListener?b.removeEventListener(c,e,a.capture):b.detachEvent&&b.detachEvent(c in pc?pc[c]:pc[c]="on"+c,e);qc--;(c=tc(b))?(Fb(c,a),0==c.Pd&&(c.src=s,b[oc]=s)):jb(a);return q}function yc(a,b){if(gb(a))return a.we(b,p);var c=tc(a);return!!c&&c.we(b,p)}
function zc(a,b,c,e){var d=1;if(a=tc(a))if(b=a.oa[b.toString()]){b=b.concat();for(a=0;a<b.length;a++){var f=b[a];f&&(f.capture==c&&!f.Xc)&&(d&=Ac(f,e)!==t)}}return Boolean(d)}function Ac(a,b){var c=a.qc,e=a.ve||a.src;a.ke&&xc(a);return c.call(e,b)}
function uc(a,b){if(a.Xc)return q;if(!hc){var c;if(!(c=b))a:{c=["window","event"];for(var e=ga,d;d=c.shift();)if(e[d]!=s)e=e[d];else{c=s;break a}c=e}d=c;c=new nc(d,this);e=q;if(2==db.hg){if(!(0>d.keyCode||d.returnValue!=p)){a:{var f=t;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){f=q}if(f||d.returnValue==p)d.returnValue=q}d=[];for(f=c.currentTarget;f;f=f.parentNode)d.push(f);for(var f=a.type,h=d.length-1;!c.sc&&0<=h;h--)c.currentTarget=d[h],e&=zc(d[h],f,q,c);for(h=0;!c.sc&&h<d.length;h++)c.currentTarget=
d[h],e&=zc(d[h],f,t,c)}}else e=Ac(a,c);return e}return Ac(a,new nc(b,this))}function tc(a){a=a[oc];return a instanceof Db?a:s}var Bc="__closure_events_fn_"+(1E9*Math.random()>>>0);function rc(a){return pa(a)?a:a[Bc]||(a[Bc]=function(b){return a.handleEvent(b)})};function Cc(){jc.call(this);this.ub=new Db(this);this.Bi=this}D(Cc,jc);Cc.prototype[fb]=q;w=Cc.prototype;w.Qf=s;w.Vf=ba("Qf");w.addEventListener=function(a,b,c,e){P(this,a,b,c,e)};w.removeEventListener=function(a,b,c,e){wc(this,a,b,c,e)};
w.dispatchEvent=function(a){var b,c=this.Qf;if(c)for(b=[];c;c=c.Qf)b.push(c);var c=this.Bi,e=a.type||a;if(na(a))a=new lc(a,c);else if(a instanceof lc)a.target=a.target||c;else{var d=a;a=new lc(e,c);ob(a,d)}var d=q,f;if(b)for(var g=b.length-1;!a.sc&&0<=g;g--)f=a.currentTarget=b[g],d=Dc(f,e,q,a)&&d;a.sc||(f=a.currentTarget=c,d=Dc(f,e,q,a)&&d,a.sc||(d=Dc(f,e,t,a)&&d));if(b)for(g=0;!a.sc&&g<b.length;g++)f=a.currentTarget=b[g],d=Dc(f,e,t,a)&&d;return d};
w.pc=function(a,b,c,e){return this.ub.add(String(a),b,t,c,e)};w.fh=function(a,b,c,e){return this.ub.add(String(a),b,q,c,e)};w.cg=function(a,b,c,e){return this.ub.remove(String(a),b,c,e)};function Dc(a,b,c,e){b=a.ub.oa[String(b)];if(!b)return q;b=Bb(b);for(var d=q,f=0;f<b.length;++f){var g=b[f];if(g&&!g.Xc&&g.capture==c){var h=g.qc,m=g.ve||g.src;g.ke&&Fb(a.ub,g);d=h.call(m,e)!==t&&d}}return d&&e.Eh!=t}w.Bd=function(a,b,c,e){return this.ub.Bd(String(a),b,c,e)};
w.we=function(a,b){return this.ub.we(ha(a)?String(a):p,b)};function R(){Cc.call(this);this.f="base";this.wa=window["X.counter"].Tk();this.j=t}D(R,Cc);R.prototype.__defineGetter__("classname",v("f"));R.prototype.__defineGetter__("id",v("wa"));C("X.base",R);function Ec(a,b){this.Ra=new ya(a);this.ta=new ya(b)}Ec.prototype={l:function(){return new Ec(this.Ra.l(),this.ta.l())},oc:function(){this.ta=Ea(this.ta)}};function Fc(a,b){this.ta=a;this.Qd=b}Fc.prototype={l:function(){return new Fc(this.ta.l(),this.Qd)},oc:function(){this.ta=Ea(this.ta);this.Qd=-this.Qd}};function Gc(a,b){this.Jb=a;this.He=b;var c=a[0].Ra,e=a[2].Ra,e=Da(Ca(a[1].Ra,c).mc(Ca(e,c)));this.Qa=new Fc(e,e.ac(c))}Gc.prototype={l:function(){var a=this.Jb.map(function(a){return a.l()});return new Gc(a,this.He)},oc:function(){this.Jb.reverse().map(function(a){a.oc()});this.Qa.oc()}};
function Hc(a,b,c,e,d,f){for(var g=0,h=[],m=0;m<a.Jb.length;m++){var j=b.ta.ac(a.Jb[m].Ra)-b.Qd,j=-1E-5>j?2:1E-5<j?1:0,g=g|j;h.push(j)}switch(g){case 0:(0<b.ta.ac(a.Qa.ta)?c:e).push(a);break;case 1:d.push(a);break;case 2:f.push(a);break;case 3:c=[];e=[];for(m=0;m<a.Jb.length;m++){var k=(m+1)%a.Jb.length,j=h[m],n=h[k],g=a.Jb[m],k=a.Jb[k];2!=j&&c.push(g);1!=j&&e.push(2!=j?g.l():g);3==(j|n)&&(j=(b.Qd-b.ta.ac(g.Ra))/b.ta.ac(Ca(k.Ra,g.Ra)),j=new Ec(g.Ra.ye(k.Ra,j),g.ta.ye(k.ta,j)),c.push(j),e.push(j.l()))}3<=
c.length&&d.push(new Gc(c,a.He));3<=e.length&&f.push(new Gc(e,a.He))}};function Ic(a){this.xa=this.ya=this.Qa=s;this.Y=[];a&&Jc(this,a)}Ic.prototype={l:function(){var a=new Ic,b=this.Qa&&this.Qa.l();a.Qa=b;b=this.ya&&this.ya.l();a.ya=b;b=this.xa&&this.xa.l();a.xa=b;a.Ge(this.Y.map(function(a){return a.l()}));return a},X:function(){for(var a=0;a<this.Y.length;a++)this.Y[a].oc();this.Qa.oc();this.ya&&this.ya.X();this.xa&&this.xa.X();a=this.ya;this.ya=this.xa;this.xa=a},Ge:ba("Y")};
function Jc(a,b){if(b.length){a.Qa||(a.Qa=b[0].Qa.l());for(var c=[],e=[],d=0;d<b.length;d++)Hc(b[d],a.Qa,a.Y,a.Y,c,e);c.length&&(a.ya||(a.ya=new Ic),Jc(a.ya,c));e.length&&(a.xa||(a.xa=new Ic),Jc(a.xa,e))}}function Kc(a){var b=a.Y.slice();a.ya&&(b=b.concat(Kc(a.ya)));a.xa&&(b=b.concat(Kc(a.xa)));return b}function Lc(a,b){a.Y=Mc(b,a.Y);a.ya&&Lc(a.ya,b);a.xa&&Lc(a.xa,b)}
function Mc(a,b){if(!a.Qa)return b.slice();for(var c=[],e=[],d=0;d<b.length;d++)Hc(b[d],a.Qa,c,e,c,e);a.ya&&(c=Mc(a.ya,c));e=a.xa?Mc(a.xa,e):[];return c.concat(e)};function Nc(){this.Y=[]}function Oc(a){var b=new Nc;b.Ge(a);return b}
Nc.prototype={l:function(){var a=new Nc;a.Ge(this.Y.map(function(a){return a.l()}));return a},bg:function(a){var b=new Ic(this.l().Y);a=new Ic(a.l().Y);Lc(b,a);Lc(a,b);a.X();Lc(a,b);a.X();Jc(b,Kc(a));return Oc(Kc(b))},ua:function(a){var b=new Ic(this.l().Y);a=new Ic(a.l().Y);b.X();Lc(b,a);Lc(a,b);a.X();Lc(a,b);a.X();Jc(b,Kc(a));b.X();return Oc(Kc(b))},zf:function(a){var b=new Ic(this.l().Y);a=new Ic(a.l().Y);b.X();Lc(a,b);a.X();Lc(b,a);Lc(a,b);Jc(b,Kc(a));b.X();return Oc(Kc(b))},inverse:function(){var a=
this.l();a.Y.map(function(a){a.oc()});return a},Ge:ba("Y")};function Pc(){R.call(this);this.f="indexer";this.hf=[];this.cm=[];this.Ga={}}D(Pc,R);Pc.prototype.add=function(a){a==s&&l(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.Ga||(this.Ga[b]=this.hf.length,this.hf.push(a));return this.Ga[b]};Pc.prototype.unique=v("hf");function Qc(a){R.call(this);this.f="file";this.ce=a;this.j=q}D(Qc,R);function Rc(){this.pb=this.r=s}Rc.prototype.__defineSetter__("file",function(a){if(a==s||ka(a)&&0==a.length)this.r=s;else{if(ka(a)){if(1==a.length){this.r=new Qc(a[0]);return}this.r=yb(a,function(a){var c=new S;c.r=new Qc(a);return c})}else this.r=new Qc(a);this.pb=s}});Rc.prototype.__defineGetter__("file",function(){return!this.r?"":ka(this.r)?this.r.map(function(a){return a.r.ce}):this.r.ce});
Rc.prototype.__defineGetter__("filedata",function(){return ka(this.r)?this.r.map(function(a){return a.pb}):this.pb});Rc.prototype.__defineSetter__("filedata",function(a){if(a==s||ka(a)&&0==a.length)this.pb=s;if(ka(a))if(1==a.length)this.pb=a[0];else{var b=this.r.length,c;for(c=0;c<b;c++)this.r[c].pb=a[c]}else this.pb=a});x("goog.functions.CACHE_RETURN_VALUE",q);function Sc(a,b){this.ha={};this.P=[];this.eg=this.lc=0;var c=arguments.length;if(1<c){c%2&&l(Error("Uneven number of arguments"));for(var e=0;e<c;e+=2)this.set(arguments[e],arguments[e+1])}else a&&this.kf(a)}w=Sc.prototype;w.qe=v("lc");w.Cd=function(){Tc(this);for(var a=[],b=0;b<this.P.length;b++)a.push(this.ha[this.P[b]]);return a};function Uc(a){Tc(a);return a.P.concat()}function Vc(a){for(var b=0;b<a.P.length;b++){var c=a.P[b];if(Wc(a.ha,c)&&a.ha[c]==t)return q}return t}
w.clear=function(){this.ha={};this.eg=this.lc=this.P.length=0};w.remove=function(a){return Wc(this.ha,a)?(delete this.ha[a],this.lc--,this.eg++,this.P.length>2*this.lc&&Tc(this),q):t};function Tc(a){if(a.lc!=a.P.length){for(var b=0,c=0;b<a.P.length;){var e=a.P[b];Wc(a.ha,e)&&(a.P[c++]=e);b++}a.P.length=c}if(a.lc!=a.P.length){for(var d={},c=b=0;b<a.P.length;)e=a.P[b],Wc(d,e)||(a.P[c++]=e,d[e]=1),b++;a.P.length=c}}w.get=function(a,b){return Wc(this.ha,a)?this.ha[a]:b};
w.set=function(a,b){Wc(this.ha,a)||(this.lc++,this.P.push(a),this.eg++);this.ha[a]=b};w.kf=function(a){var b;if(a instanceof Sc)b=Uc(a),a=a.Cd();else{b=[];var c=0,e;for(e in a)b[c++]=e;a=lb(a)}for(c=0;c<b.length;c++)this.set(b[c],a[c])};w.forEach=function(a,b){for(var c=Uc(this),e=0;e<c.length;e++){var d=c[e],f=this.get(d);a.call(b,f,d,this)}};w.l=function(){return new Sc(this)};w.ag=function(){for(var a=new Sc,b=0;b<this.P.length;b++){var c=this.P[b];a.set(this.ha[c],c)}return a};
function Wc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Xc(){R.call(this);this.f="colortable";this.Ga=new Sc;Ga(this,new Rc)}D(Xc,R);Xc.prototype.add=function(a,b,c,e,d,f){(!A(a)||!A(c)||!A(e)||!A(d)||!A(f))&&l(Error("Invalid color table entry."));this.Ga.set(a,[b,c,e,d,f]);this.j=q};Xc.prototype.get=function(a){return this.Ga.get(a)};C("X.colortable.prototype.get",Xc.prototype.get);function Yc(a,b,c){this.x=ha(a)?a:0;this.y=ha(b)?b:0;this.d=ha(c)?c:0}Yc.prototype.l=function(){return new Yc(this.x,this.y,this.d)};function U(a,b,c){this.x=a;this.y=b;this.d=c}D(U,Yc);w=U.prototype;w.l=function(){return new U(this.x,this.y,this.d)};w.Gb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.d*this.d)};w.scale=function(a){this.x*=a;this.y*=a;this.d*=a;return this};w.X=function(){this.x=-this.x;this.y=-this.y;this.d=-this.d;return this};w.normalize=function(){return this.scale(1/this.Gb())};w.add=function(a){this.x+=a.x;this.y+=a.y;this.d+=a.d;return this};
w.ua=function(a){this.x-=a.x;this.y-=a.y;this.d-=a.d;return this};function Zc(a,b){var c=a.x-b.x,e=a.y-b.y,d=a.d-b.d;return Math.sqrt(c*c+e*e+d*d)}function $c(a,b){var c=a.x-b.x,e=a.y-b.y,d=a.d-b.d;return c*c+e*e+d*d}function bd(a,b){return new U(a.x+b.x,a.y+b.y,a.d+b.d)}function cd(a,b){return new U(a.y*b.d-a.d*b.y,a.d*b.x-a.x*b.d,a.x*b.y-a.y*b.x)};I.m=U;w=I.m.prototype;w.l=U.prototype.l;w.Gb=U.prototype.Gb;w.scale=U.prototype.scale;w.X=U.prototype.X;w.add=U.prototype.add;w.ua=U.prototype.ua;w.normalize=function(){var a=this.Gb();return 0==a?this.scale(0):this.scale(1/a)};I.m.ac=function(a,b){return a.x*b.x+a.y*b.y+a.d*b.d};I.m.mc=cd;I.m.xf=Zc;I.m.ye=function(a,b,c){return new U(a.x+c*(b.x-a.x),a.y+c*(b.y-a.y),a.d+c*(b.d-a.d))};I.m.prototype.__defineGetter__("xx",v("x"));I.m.prototype.__defineGetter__("yy",v("y"));
I.m.prototype.__defineGetter__("zz",v("d"));C("X.vector",I.m);C("X.vector.prototype.clone",I.m.prototype.l);C("X.vector.prototype.magnitude",I.m.prototype.Gb);C("X.vector.prototype.scale",I.m.prototype.scale);C("X.vector.prototype.invert",I.m.prototype.X);C("X.vector.prototype.normalize",I.m.prototype.normalize);C("X.vector.prototype.add",I.m.prototype.add);C("X.vector.prototype.subtract",I.m.prototype.ua);C("X.vector.dot",I.m.ac);C("X.vector.cross",I.m.mc);C("X.vector.distance",I.m.xf);
C("X.vector.lerp",I.m.ye);function dd(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}dd.prototype.BYTES_PER_ELEMENT=8;dd.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};dd.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{dd.BYTES_PER_ELEMENT=8}catch(ed){}dd.prototype.BYTES_PER_ELEMENT=dd.prototype.BYTES_PER_ELEMENT;dd.prototype.set=dd.prototype.set;dd.prototype.toString=dd.prototype.toString;C("Float64Array",dd)};function fd(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}fd.prototype.BYTES_PER_ELEMENT=4;fd.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};fd.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(fd.BYTES_PER_ELEMENT=4,fd.prototype.BYTES_PER_ELEMENT=fd.prototype.BYTES_PER_ELEMENT,fd.prototype.set=fd.prototype.set,fd.prototype.toString=fd.prototype.toString,C("Float32Array",fd));function gd(){return new Float32Array(3)}function hd(a,b,c){var e=gd();e[0]=a;e[1]=b;e[2]=c;return e}function id(a,b){var c=a[0],e=a[1],d=a[2],c=1/Math.sqrt(c*c+e*e+d*d);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c};function jd(){return new Float32Array(4)}function kd(a,b,c,e){var d=jd();d[0]=a;d[1]=b;d[2]=c;d[3]=e;return d};function ld(){return new Float32Array(16)}function md(){var a=ld();a[0]=a[5]=a[10]=a[15]=1;return a}function nd(a,b,c,e,d,f,g,h,m,j,k,n,u,r,y,z,F){a[0]=b;a[1]=c;a[2]=e;a[3]=d;a[4]=f;a[5]=g;a[6]=h;a[7]=m;a[8]=j;a[9]=k;a[10]=n;a[11]=u;a[12]=r;a[13]=y;a[14]=z;a[15]=F;return a}function od(a,b,c){b*=4;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3]}function pd(a,b,c){b*=4;c[0]=a[b];c[1]=a[b+1];c[2]=a[b+2];c[3]=a[b+3]}function V(a,b,c,e,d,f){a[b]=c;a[b+4]=e;a[b+8]=d;a[b+12]=f}
function qd(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3]}function rd(a,b,c){c[0]=a[b];c[1]=a[b+4];c[2]=a[b+8];c[3]=a[b+12]}
function sd(a,b,c){var e=a[0],d=a[1],f=a[2],g=a[3],h=a[4],m=a[5],j=a[6],k=a[7],n=a[8],u=a[9],r=a[10],y=a[11],z=a[12],F=a[13],H=a[14];a=a[15];var K=b[0],B=b[1],E=b[2],J=b[3],N=b[4],Q=b[5],O=b[6],T=b[7],da=b[8],ea=b[9],L=b[10],oa=b[11],G=b[12],Ma=b[13],Fa=b[14];b=b[15];c[0]=e*K+h*B+n*E+z*J;c[1]=d*K+m*B+u*E+F*J;c[2]=f*K+j*B+r*E+H*J;c[3]=g*K+k*B+y*E+a*J;c[4]=e*N+h*Q+n*O+z*T;c[5]=d*N+m*Q+u*O+F*T;c[6]=f*N+j*Q+r*O+H*T;c[7]=g*N+k*Q+y*O+a*T;c[8]=e*da+h*ea+n*L+z*oa;c[9]=d*da+m*ea+u*L+F*oa;c[10]=f*da+j*ea+r*
L+H*oa;c[11]=g*da+k*ea+y*L+a*oa;c[12]=e*G+h*Ma+n*Fa+z*b;c[13]=d*G+m*Ma+u*Fa+F*b;c[14]=f*G+j*Ma+r*Fa+H*b;c[15]=g*G+k*Ma+y*Fa+a*b;return c}
function td(a,b){var c=a[0],e=a[1],d=a[2],f=a[3],g=a[4],h=a[5],m=a[6],j=a[7],k=a[8],n=a[9],u=a[10],r=a[11],y=a[12],z=a[13],F=a[14],H=a[15],K=c*h-e*g,B=c*m-d*g,E=c*j-f*g,J=e*m-d*h,N=e*j-f*h,Q=d*j-f*m,O=k*z-n*y,T=k*F-u*y,da=k*H-r*y,ea=n*F-u*z,L=n*H-r*z,oa=u*H-r*F,G=K*oa-B*L+E*ea+J*da-N*T+Q*O;if(0==G)return t;G=1/G;b[0]=(h*oa-m*L+j*ea)*G;b[1]=(-e*oa+d*L-f*ea)*G;b[2]=(z*Q-F*N+H*J)*G;b[3]=(-n*Q+u*N-r*J)*G;b[4]=(-g*oa+m*da-j*T)*G;b[5]=(c*oa-d*da+f*T)*G;b[6]=(-y*Q+F*E-H*B)*G;b[7]=(k*Q-u*E+r*B)*G;b[8]=(g*
L-h*da+j*O)*G;b[9]=(-c*L+e*da-f*O)*G;b[10]=(y*N-z*E+H*K)*G;b[11]=(-k*N+n*E-r*K)*G;b[12]=(-g*ea+h*T-m*O)*G;b[13]=(c*ea-e*T+d*O)*G;b[14]=(-y*J+z*B-F*K)*G;b[15]=(k*J-n*B+u*K)*G;return q}function ud(a,b,c){var e=b[0],d=b[1];b=b[2];c[0]=e*a[0]+d*a[4]+b*a[8]+a[12];c[1]=e*a[1]+d*a[5]+b*a[9]+a[13];c[2]=e*a[2]+d*a[6]+b*a[10]+a[14]}
function vd(a,b,c){var e=b[0],d=b[1],f=b[2];b=b[3];c[0]=e*a[0]+d*a[4]+f*a[8]+b*a[12];c[1]=e*a[1]+d*a[5]+f*a[9]+b*a[13];c[2]=e*a[2]+d*a[6]+f*a[10]+b*a[14];c[3]=e*a[3]+d*a[7]+f*a[11]+b*a[15];return c}function wd(a,b,c,e){var d=a[1]*b+a[5]*c+a[9]*e+a[13],f=a[2]*b+a[6]*c+a[10]*e+a[14],g=a[3]*b+a[7]*c+a[11]*e+a[15];a[12]=a[0]*b+a[4]*c+a[8]*e+a[12];a[13]=d;a[14]=f;a[15]=g;return a}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);I.g={};I.g.gh=function(a,b,c,e){c=c.ua(b);c.normalize();e=I.m.mc(c,e);e.normalize();var d=I.m.mc(e,c);d.normalize();c.X();V(a,0,e.x,e.y,e.d,0);V(a,1,d.x,d.y,d.d,0);V(a,2,c.x,c.y,c.d,0);wd(a,-b.x,-b.y,-b.d);return a};I.g.$=function(a,b,c,e){var d=1/(b*a[3]+c*a[7]+e*a[11]+a[15]);return new I.m((b*a[0]+c*a[4]+e*a[8]+a[12])*d,(b*a[1]+c*a[5]+e*a[9]+a[13])*d,(b*a[2]+c*a[6]+e*a[10]+a[14])*d)};I.g.Qk=function(a,b,c){var e=new Float32Array(4),d=new Float32Array(4);rd(a,b,e);rd(a,c,d);qd(a,b,d);qd(a,c,e);return a};
I.g.Pk=function(a,b,c){var e=new Float32Array(4),d=new Float32Array(4);pd(a,b,e);pd(a,c,d);od(a,b,d);od(a,c,e);return a};I.g.Dd=md;I.g.l=function(a){var b=ld();b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};
I.g.ag=function(a,b){if(b==a){var c=a[1],e=a[2],d=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=e;b[9]=f;b[11]=a[14];b[12]=d;b[13]=g;b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};
I.g.Ti=function(a){var b=a[0],c=a[1],e=a[2],d=a[3],f=a[4],g=a[5],h=a[6],m=a[7],j=a[8],k=a[9],n=a[10],u=a[11],r=a[12],y=a[13],z=a[14];a=a[15];return(b*g-c*f)*(n*a-u*z)-(b*h-e*f)*(k*a-u*y)+(b*m-d*f)*(k*z-n*y)+(c*h-e*g)*(j*a-u*r)-(c*m-d*g)*(j*z-n*r)+(e*m-d*h)*(j*y-k*r)};I.g.X=td;I.g.Cf=function(a,b,c,e,d){var f=b/2;b=d-e;var g=Math.sin(f);if(0==b||0==g||0==c)return a;f=Math.cos(f)/g;return nd(a,f/c,0,0,0,0,f,0,0,0,0,-(d+e)/b,-1,0,0,-(2*e*d)/b,0)};
I.g.Gj=function(a,b,c,e,d,f,g){return nd(a,2*f/(c-b),0,0,0,0,2*f/(d-e),0,0,(c+b)/(c-b),(d+e)/(d-e),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)};I.g.Hj=function(a,b,c,e,d,f,g){return nd(a,2/(c-b),0,0,0,0,2/(d-e),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(d+e)/(d-e),-(g+f)/(g-f),1)};I.g.multiply=sd;I.g.kh=vd;I.g.translate=wd;I.g.scale=function(a,b,c,e){return nd(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*e,a[9]*e,a[10]*e,a[11]*e,a[12],a[13],a[14],a[15])};
I.g.rotate=function(a,b,c,e,d){var f=a[0],g=a[1],h=a[2],m=a[3],j=a[4],k=a[5],n=a[6],u=a[7],r=a[8],y=a[9],z=a[10],F=a[11],H=Math.cos(b),K=Math.sin(b),B=1-H;b=c*c*B+H;var E=c*e*B+d*K,J=c*d*B-e*K,N=c*e*B-d*K,Q=e*e*B+H,O=e*d*B+c*K,T=c*d*B+e*K;c=e*d*B-c*K;d=d*d*B+H;return nd(a,f*b+j*E+r*J,g*b+k*E+y*J,h*b+n*E+z*J,m*b+u*E+F*J,f*N+j*Q+r*O,g*N+k*Q+y*O,h*N+n*Q+z*O,m*N+u*Q+F*O,f*T+j*c+r*d,g*T+k*c+y*d,h*T+n*c+z*d,m*T+u*c+F*d,a[12],a[13],a[14],a[15])};
I.g.Ce=function(a,b){var c=a[4],e=a[5],d=a[6],f=a[7],g=a[8],h=a[9],m=a[10],j=a[11],k=Math.cos(b),n=Math.sin(b);a[4]=c*k+g*n;a[5]=e*k+h*n;a[6]=d*k+m*n;a[7]=f*k+j*n;a[8]=c*-n+g*k;a[9]=e*-n+h*k;a[10]=d*-n+m*k;a[11]=f*-n+j*k;return a};I.g.De=function(a,b){var c=a[0],e=a[1],d=a[2],f=a[3],g=a[8],h=a[9],m=a[10],j=a[11],k=Math.cos(b),n=Math.sin(b);a[0]=c*k+g*-n;a[1]=e*k+h*-n;a[2]=d*k+m*-n;a[3]=f*k+j*-n;a[8]=c*n+g*k;a[9]=e*n+h*k;a[10]=d*n+m*k;a[11]=f*n+j*k;return a};
I.g.Ee=function(a,b){var c=a[0],e=a[1],d=a[2],f=a[3],g=a[4],h=a[5],m=a[6],j=a[7],k=Math.cos(b),n=Math.sin(b);a[0]=c*k+g*n;a[1]=e*k+h*n;a[2]=d*k+m*n;a[3]=f*k+j*n;a[4]=c*-n+g*k;a[5]=e*-n+h*k;a[6]=d*-n+m*k;a[7]=f*-n+j*k;return a};C("X.matrix.identity",I.g.Dd);C("X.matrix.clone",I.g.l);C("X.matrix.transpose",I.g.ag);C("X.matrix.determinant",I.g.Ti);C("X.matrix.invert",I.g.X);C("X.matrix.multiply",I.g.multiply);C("X.matrix.multiplyByVector",I.g.$);C("X.matrix.multiplyByVec4",I.g.kh);
C("X.matrix.makePerspective",I.g.Cf);C("X.matrix.makeFrustum",I.g.Gj);C("X.matrix.makeOrtho",I.g.Hj);C("X.matrix.makeLookAt",I.g.gh);C("X.matrix.translate",I.g.translate);C("X.matrix.scale",I.g.scale);C("X.matrix.rotate",I.g.rotate);C("X.matrix.rotateX",I.g.Ce);C("X.matrix.rotateY",I.g.De);C("X.matrix.rotateZ",I.g.Ee);C("X.matrix.swapRows",I.g.Qk);C("X.matrix.swapCols",I.g.Pk);function xd(){R.call(this);this.f="transform";this.R=I.g.Dd()}D(xd,R);xd.prototype.__defineGetter__("matrix",v("R"));xd.prototype.__defineSetter__("matrix",function(a){(a==s||!(a instanceof Float32Array))&&l(Error("Invalid matrix."));this.R=a;this.q()});w=xd.prototype;w.Ce=function(a){(!A(a)||-360>a||360<a)&&l(Error("Invalid angle."));I.g.Ce(this.R,a*Math.PI/180);this.q()};w.De=function(a){(!A(a)||-360>a||360<a)&&l(Error("Invalid angle."));I.g.De(this.R,a*Math.PI/180);this.q()};
w.Ee=function(a){(!A(a)||-360>a||360<a)&&l(Error("Invalid angle."));I.g.Ee(this.R,a*Math.PI/180);this.q()};w.Lh=function(a){A(a)||l(Error("Invalid distance."));I.g.translate(this.R,a,0,0);this.q()};w.Mh=function(a){A(a)||l(Error("Invalid distance."));I.g.translate(this.R,0,a,0);this.q()};w.Nh=function(a){A(a)||l(Error("Invalid distance."));I.g.translate(this.R,0,0,a);this.q()};function yd(a,b,c){a.R[b+4*c]*=-1;a.q()}w.aj=function(){yd(this,0,0)};w.bj=function(){yd(this,1,1)};
w.cj=function(){yd(this,2,2)};w.q=function(){this.j=q};C("X.transform",xd);C("X.transform.prototype.rotateX",xd.prototype.Ce);C("X.transform.prototype.rotateY",xd.prototype.De);C("X.transform.prototype.rotateZ",xd.prototype.Ee);C("X.transform.prototype.translateX",xd.prototype.Lh);C("X.transform.prototype.translateY",xd.prototype.Mh);C("X.transform.prototype.translateZ",xd.prototype.Nh);C("X.transform.prototype.flipX",xd.prototype.aj);C("X.transform.prototype.flipY",xd.prototype.bj);
C("X.transform.prototype.flipZ",xd.prototype.cj);C("X.transform.prototype.modified",xd.prototype.q);function zd(){R.call(this);this.f="texture";this.Vb=this.qb=this.r=s;this.bf=this.cf=0;this.pg=t;Ga(this,new Rc)}D(zd,R);zd.prototype.__defineSetter__("rawData",function(a){this.Vb=a;this.j=q});zd.prototype.__defineSetter__("rawDataHeight",function(a){this.bf=a;this.j=q});zd.prototype.__defineSetter__("rawDataWidth",function(a){this.cf=a;this.j=q});zd.prototype.__defineSetter__("grayscale",function(a){this.pg=a;this.j=q});C("X.texture",zd);function W(a,b){R.call(this);this.f="triplets";this.fb=Infinity;this.bb=-Infinity;this.gb=Infinity;this.cb=-Infinity;this.hb=Infinity;this.eb=-Infinity;this.Sd=[0,0,0];this.og=q;this.C=0;this.ca=new Float32Array(a);b!=s&&(this.ca=b.ca.subarray(0,b.ca.length),this.C=this.ca.length,this.fb=b.fb,this.bb=b.bb,this.gb=b.gb,this.cb=b.cb,this.hb=b.hb,this.eb=b.eb,this.Sd=b.Sd.slice(),this.og=t)}D(W,R);w=W.prototype;
w.add=function(a,b,c){this.fb=Math.min(this.fb,a);this.bb=Math.max(this.bb,a);this.gb=Math.min(this.gb,b);this.cb=Math.max(this.cb,b);this.hb=Math.min(this.hb,c);this.eb=Math.max(this.eb,c);this.Sd=[(this.fb+this.bb)/2,(this.gb+this.cb)/2,(this.hb+this.eb)/2];this.og=t;this.j=q;this.ca[this.C++]=a;this.ca[this.C++]=b;this.ca[this.C++]=c;return this.C/3};w.Hb=function(){if(this.C!=this.ca.length){var a=new Float32Array(this.C);a.set(this.ca.subarray(0,this.C));this.ca=a}};
w.get=function(a){a*=3;return[this.ca[a],this.ca[a+1],this.ca[a+2]]};w.remove=function(){l(Error("Not implemented."))};w.clear=function(){this.ca=new Float32Array(this.ca.length);this.j=q};W.prototype.__defineGetter__("count",function(){this.Hb();return this.ca.length/3});W.prototype.__defineGetter__("length",function(){this.Hb();return this.ca.length});C("X.triplets",W);C("X.triplets.prototype.add",W.prototype.add);C("X.triplets.prototype.resize",W.prototype.Hb);C("X.triplets.prototype.get",W.prototype.get);
C("X.triplets.prototype.remove",W.prototype.remove);C("X.triplets.prototype.clear",W.prototype.clear);function Ad(){this.Ea=Bd;this.ka=new xd;this.v=[1,1,1];this.Qc=this.F=this.na=this.n=this.h=s;this.Jc=[];this.O=q;this.Ic=this.nd=1;this.zc=s;this.dd=t;this.sa=1;this.va=0;this.md=q}var Bd="TRIANGLES";Ad.prototype.__defineSetter__("type",function(a){return this.Ea=a});Ad.prototype.__defineGetter__("type",v("Ea"));Ad.prototype.__defineGetter__("texture",function(){this.F||(this.F=new zd);return this.F});Ad.prototype.__defineGetter__("transform",v("ka"));Ad.prototype.__defineGetter__("points",v("h"));
Ad.prototype.__defineSetter__("points",ba("h"));Ad.prototype.__defineGetter__("normals",v("n"));Ad.prototype.__defineSetter__("normals",ba("n"));Ad.prototype.__defineGetter__("colors",v("na"));Ad.prototype.__defineSetter__("colors",ba("na"));Ad.prototype.__defineGetter__("color",v("v"));Ad.prototype.__defineSetter__("color",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid color."));for(var b=this.c,c=b.length,e=0,e=0;e<c;e++)b[e].color=a;this.v=a;this.j=q});
Ad.prototype.__defineGetter__("opacity",v("sa"));Ad.prototype.__defineSetter__("opacity",function(a){(!A(a)||1<a||0>a)&&l(Error("Invalid opacity."));for(var b=this.c,c=b.length,e=0,e=0;e<c;e++)b[e]!=s&&(b[e].opacity=a);this.sa=a;this.j=q});Ad.prototype.__defineGetter__("caption",v("zc"));Ad.prototype.__defineSetter__("caption",function(a){this.zc=a;this.j=q});Ad.prototype.__defineGetter__("visible",v("O"));
Ad.prototype.__defineSetter__("visible",function(a){for(var b=this.c,c=b.length,e=0,e=0;e<c;e++)b[e]!=s&&(b[e].visible=a);this.O=a;this.j=q});Ad.prototype.__defineGetter__("pointsize",v("nd"));Ad.prototype.__defineSetter__("pointsize",function(a){A(a)||l(Error("Invalid point size."));this.nd=a;this.j=q});Ad.prototype.__defineGetter__("magicmode",v("dd"));Ad.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&l(Error("Invalid magic mode setting."));this.dd=a;this.j=q});
Ad.prototype.__defineGetter__("linewidth",v("Ic"));Ad.prototype.__defineSetter__("linewidth",function(a){A(a)||l(Error("Invalid line width."));this.Ic=a;this.j=q});Ad.prototype.__defineGetter__("pickable",v("md"));Ad.prototype.__defineSetter__("pickable",function(a){"boolean"!=typeof a&&l(Error("Invalid pickable setting."));this.md=a;this.j=q});Ad.prototype.__defineGetter__("textureCoordinateMap",v("Qc"));Ad.prototype.__defineSetter__("textureCoordinateMap",ba("fm"));function Cd(){this.Ha=Infinity;this.U=this.ba=-Infinity;this.V=Infinity;this.Qb=[0,0,0];this.Ob=[1,1,1]}Cd.prototype.__defineGetter__("lowerThreshold",v("U"));Cd.prototype.__defineSetter__("lowerThreshold",ba("U"));Cd.prototype.__defineGetter__("upperThreshold",v("V"));Cd.prototype.__defineSetter__("upperThreshold",ba("V"));Cd.prototype.__defineGetter__("min",v("Ha"));Cd.prototype.__defineGetter__("max",v("ba"));Cd.prototype.__defineGetter__("minColor",v("Qb"));
Cd.prototype.__defineSetter__("minColor",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid min. color."));this.Qb=a});Cd.prototype.__defineGetter__("maxColor",v("Ob"));Cd.prototype.__defineSetter__("maxColor",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid max. color."));this.Ob=a});function Dd(){R.call(this);this.f="scalars";this.ad=this.H=s;this.Cg=q;this.Re=0;Ga(this,new Rc);Ga(this,new Cd);this.Qb=[0,1,0];this.Ob=[1,0,0]}D(Dd,R);Dd.prototype.__defineGetter__("array",v("H"));Dd.prototype.__defineSetter__("array",function(a){this.ad=this.H=a;this.j=q});Dd.prototype.__defineGetter__("interpolation",v("Re"));Dd.prototype.__defineSetter__("interpolation",ba("Re"));C("X.scalars",Dd);function Y(a){R.call(this);this.f="object";this.c=[];this.I=this.Ba=s;Ga(this,new Ad);a!=s&&this.kc(a)}D(Y,R);
Y.prototype.kc=function(a){this.Ea=a.Ea;this.ka=new xd;this.ka.R=new Float32Array(a.ka.R);this.v=a.v.slice();a.h&&(this.h=new W(a.h.length,a.h));a.n&&(this.n=new W(a.n.length,a.n));a.na&&(this.na=new W(a.na.length,a.na));this.F=a.F;this.Qc=a.Qc;a.r&&(this.r=new Qc((new String(a.r.ce)).toString()));this.sa=a.sa;this.c.length=0;var b=a.c;if(b)for(var c=b.length,e=0,e=0;e<c;e++)this.c.push(new I[b[e].f](b[e]));this.O=a.O;this.nd=a.nd;this.Ic=a.Ic;a.zc&&(this.zc=(new String(a.zc)).toString());this.dd=
a.dd;this.md=a.md;this.Jc=a.Jc.slice();this.j=q};Y.prototype.__defineGetter__("colortable",function(){this.Ba||(this.Ba=new Xc);return this.Ba});Y.prototype.__defineGetter__("scalars",function(){this.I||(this.I=new Dd);return this.I});Y.prototype.__defineGetter__("children",v("c"));Y.prototype.q=function(){var a=new Ed;a.D=this;this.dispatchEvent(a)};Y.prototype.remove=function(){var a=new Fd;a.D=this;this.dispatchEvent(a)};
function Gd(a,b){(a==s||b==s||!(a instanceof Y)||!(b instanceof Y))&&l(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.sa?-1:1==b.sa?1:a.va!=s&&b.va!=s&&a.va>b.va?-1:1}C("X.object",Y);C("X.object.prototype.modified",Y.prototype.q);C("X.object.prototype.remove",Y.prototype.remove);function Hd(){}function Id(a){for(var b=a.h.count,c=[],e=0,e=0;e<b;e+=3){var d=a.h.get(e),f=a.h.get(e+1),g=a.h.get(e+2),h=a.n.get(e),m=a.n.get(e+1),j=a.n.get(e+2),k=a.v;a.na&&0<a.na.length&&(k=a.na.get(e));var n=[];n.push(new Ec(d,h));n.push(new Ec(f,m));n.push(new Ec(g,j));c.push(new Gc(n,k))}return Oc(c)}
function Jd(a,b){(b==s||!(b instanceof Nc))&&l(Error("Invalid CSG object."));var c=new Pc,e=[];yb(b.Y,function(a){var b=[],g=a.He,b=yb(a.Jb,function(a){a.color=g;return c.add(a)});for(a=a=2;a<b.length;a++)e.push([b[0],b[a-1],b[a]])}.bind(a));a.qi=yb(c.unique(),function(a){return[a.Ra.x(),a.Ra.y(),a.Ra.d()]});a.pi=yb(c.unique(),function(a){return[a.ta.x(),a.ta.y(),a.ta.d()]});a.oi=yb(c.unique(),function(a){return!a.color?s:[a.color[0],a.color[1],a.color[2]]});a.h=new W(9*e.length);a.n=new W(9*e.length);
a.na=new W(9*e.length);yb(e,function(a){var b=a[0],c=a[1];a=a[2];var e=this.qi,m=this.pi,j=this.oi;this.h.add(e[b][0],e[b][1],e[b][2]);this.h.add(e[c][0],e[c][1],e[c][2]);this.h.add(e[a][0],e[a][1],e[a][2]);this.n.add(m[b][0],m[b][1],m[b][2]);this.n.add(m[c][0],m[c][1],m[c][2]);this.n.add(m[a][0],m[a][1],m[a][2]);j[b]&&this.na.add(j[b][0],j[b][1],j[b][2]);j[c]&&this.na.add(j[c][0],j[c][1],j[c][2]);j[a]&&this.na.add(j[a][0],j[a][1],j[a][2])}.bind(a));0==a.na.C&&(a.na=s);a.Ea=Bd}
Hd.prototype.bg=function(a){(a==s||!(a instanceof Nc)&&!(a instanceof Y))&&l(Error("Invalid object."));var b=a;a instanceof Y&&(b=Id(b));a=new Y;Ga(a,new Hd);Jd(a,Id(this).bg(b));return a};Hd.prototype.ua=function(a){(a==s||!(a instanceof Nc)&&!(a instanceof Y))&&l(Error("Invalid object."));var b=a;a instanceof Y&&(b=Id(b));a=new Y;Ga(a,new Hd);Jd(a,Id(this).ua(b));return a};
Hd.prototype.zf=function(a){(a==s||!(a instanceof Nc)&&!(a instanceof Y))&&l(Error("Invalid object."));var b=a;a instanceof Y&&(b=Id(b));a=new Y;Ga(a,new Hd);Jd(a,Id(this).zf(b));return a};Hd.prototype.inverse=function(){var a=new Y;Ga(a,new Hd);Jd(a,Id(this).inverse());return a};C("X.constructable",Hd);C("X.constructable.prototype.intersect",Hd.prototype.zf);C("X.constructable.prototype.inverse",Hd.prototype.inverse);C("X.constructable.prototype.subtract",Hd.prototype.ua);
C("X.constructable.prototype.union",Hd.prototype.bg);function Kd(a){lc.call(this,a);this.f="event"}D(Kd,lc);function Ld(){Kd.call(this,"g");this.We=this.jf=0}D(Ld,Kd);function Md(){Kd.call(this,"a");this.va=new I.m(0,0,0)}D(Md,Kd);function Nd(){Kd.call(this,"b");this.va=new I.m(0,0,0)}D(Nd,Kd);function Od(){Kd.call(this,"c");this.ab=this.rb=t}D(Od,Kd);function Pd(){Kd.call(this,"d");this.da=t}D(Pd,Kd);function Qd(){Kd.call(this,"k");this.ie=this.he=0}D(Qd,Kd);function Rd(){Kd.call(this,"l")}D(Rd,Kd);function Sd(){Kd.call(this,"f")}D(Sd,Kd);
function Ed(){Kd.call(this,"h");this.u=this.D=s}D(Ed,Kd);function Fd(){Kd.call(this,"i");this.u=this.D=s}D(Fd,Kd);function Td(){Kd.call(this,"j");this.xd=0}D(Td,Kd);function Ud(){Kd.call(this,"m");this.D=s}D(Ud,Kd);function Vd(){Kd.call(this,"o");this.xd=0}D(Vd,Kd);function Wd(){Kd.call(this,"n");this.D=s}D(Wd,Kd);C("X.event.events.PAN","a");C("X.event.events.ROTATE","b");C("X.event.events.ZOOM","c");C("X.event.events.SCROLL","d");function Xd(a,b,c){a==s&&l(Error("Invalid GL Buffer."));b==s&&l(Error("Invalid number of items."));c==s&&l(Error("Invalid item size."));R.call(this);this.f="buffer";this.Q=a;this.Mb=b;this.Nb=c}D(Xd,R);function Yd(a,b){this.x=ha(a)?a:0;this.y=ha(b)?b:0}w=Yd.prototype;w.l=function(){return new Yd(this.x,this.y)};function Zd(a,b){return new Yd(a.x-b.x,a.y-b.y)}w.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};w.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};w.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};
w.translate=function(a,b){a instanceof Yd?(this.x+=a.x,this.y+=a.y):(this.x+=a,A(b)&&(this.y+=b));return this};w.scale=function(a,b){var c=A(b)?b:a;this.x*=a;this.y*=c;return this};function $d(a,b,c,e){this.top=a;this.right=b;this.bottom=c;this.left=e}w=$d.prototype;w.l=function(){return new $d(this.top,this.right,this.bottom,this.left)};w.contains=function(a){return!this||!a?t:a instanceof $d?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};
w.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};w.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};w.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};
w.translate=function(a,b){a instanceof Yd?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(this.left+=a,this.right+=a,A(b)&&(this.top+=b,this.bottom+=b));return this};w.scale=function(a,b){var c=A(b)?b:a;this.left*=a;this.right*=a;this.top*=c;this.bottom*=c;return this};function ae(a,b){this.width=a;this.height=b}w=ae.prototype;w.l=function(){return new ae(this.width,this.height)};w.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};w.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};w.scale=function(a,b){var c=A(b)?b:a;this.width*=a;this.height*=c;return this};function be(a,b,c,e){this.left=a;this.top=b;this.width=c;this.height=e}w=be.prototype;w.l=function(){return new be(this.left,this.top,this.width,this.height)};w.bh=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var e=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(e<=a)return this.left=b,this.top=e,this.width=c-b,this.height=a-e,q}return t};
w.contains=function(a){return a instanceof be?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};function ce(a,b){var c=b.x<a.left?a.left-b.x:Math.max(b.x-(a.left+a.width),0),e=b.y<a.top?a.top-b.y:Math.max(b.y-(a.top+a.height),0);return c*c+e*e}w.xf=function(a){return Math.sqrt(ce(this,a))};
w.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};w.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
w.translate=function(a,b){a instanceof Yd?(this.left+=a.x,this.top+=a.y):(this.left+=a,A(b)&&(this.top+=b));return this};w.scale=function(a,b){var c=A(b)?b:a;this.left*=a;this.width*=a;this.top*=c;this.height*=c;return this};function de(a,b){var c;c=a.className;c=na(c)&&c.match(/\S+/g)||[];for(var e=Cb(arguments,1),d=c.length+e.length,f=c,g=0;g<e.length;g++)0<=wb(f,e[g])||f.push(e[g]);a.className=c.join(" ");return c.length==d};var ee=!M||M&&9<=gc;!Tb&&!M||M&&M&&9<=gc||Tb&&ec("1.9.1");M&&ec("9");x("goog.dom.ASSUME_QUIRKS_MODE",t);x("goog.dom.ASSUME_STANDARDS_MODE",t);var fe=La.fl||La.$h;function ge(a){return a?new he(ie(a)):Na||(Na=new he)}function je(a,b){return na(b)?a.getElementById(b):b}var ke={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function le(a,b,c){return me(document,arguments)}
function me(a,b){var c=b[0],e=b[1];if(!ee&&e&&(e.name||e.type)){c=["<",c];e.name&&c.push(' name="',Sa(e.name),'"');if(e.type){c.push(' type="',Sa(e.type),'"');var d={};ob(d,e);delete d.type;e=d}c.push(">");c=c.join("")}var f=a.createElement(c);e&&(na(e)?f.className=e:ka(e)?de.apply(s,[f].concat(e)):kb(e,function(a,b){"style"==b?f.style.cssText=a:"class"==b?f.className=a:"for"==b?f.htmlFor=a:b in ke?f.setAttribute(ke[b],a):0==b.lastIndexOf("aria-",0)||0==b.lastIndexOf("data-",0)?f.setAttribute(b,a):
f[b]=a}));if(2<b.length){e=function(b){b&&f.appendChild(na(b)?a.createTextNode(b):b)};for(c=2;c<b.length;c++)if(d=b[c],ma(d)&&!(qa(d)&&0<d.nodeType)){var g=xb,h;a:{if((h=d)&&"number"==typeof h.length){if(qa(h)){h="function"==typeof h.item||"string"==typeof h.item;break a}if(pa(h)){h="function"==typeof h.item;break a}}h=t}g(h?Bb(d):d,e)}else e(d)}return f}function ne(a){return fe?La.$h:"CSS1Compat"==a.compatMode}function oe(a){a&&a.parentNode&&a.parentNode.removeChild(a)}
function pe(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}function qe(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function ie(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function he(a){this.ga=a||ga.document||document}w=he.prototype;w.re=ge;w.s=function(a){return je(this.ga,a)};w.Th=he.prototype.s;
w.Tc=function(a,b,c){return me(this.ga,arguments)};w.createElement=function(a){return this.ga.createElement(a)};w.createTextNode=function(a){return this.ga.createTextNode(String(a))};function re(a){return ne(a.ga)}function se(a){var b=a.ga;a=!Ub&&ne(b)?b.documentElement:b.body||b.documentElement;b=b.parentWindow||b.defaultView;return M&&ec("10")&&b.pageYOffset!=a.scrollTop?new Yd(a.scrollLeft,a.scrollTop):new Yd(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}w.appendChild=function(a,b){a.appendChild(b)};
w.contains=qe;var te={};x("goog.style.GET_BOUNDING_CLIENT_RECT_ALWAYS_EXISTS",t);function ue(a,b){var c=ie(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,s))?c[b]||c.getPropertyValue(b)||"":""}function ve(a,b){return ue(a,b)||(a.currentStyle?a.currentStyle[b]:s)||a.style&&a.style[b]}function we(a){a=a?ie(a):document;return M&&!(M&&9<=gc)&&!re(ge(a))?a.body:a.documentElement}
function xe(a){var b;try{b=a.getBoundingClientRect()}catch(c){return{left:0,top:0,right:0,bottom:0}}M&&a.ownerDocument.body&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function ye(a){if(M&&!(M&&8<=gc))return a.offsetParent;var b=ie(a),c=ve(a,"position"),e="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=ve(a,"position"),e=e&&"static"==c&&a!=b.documentElement&&a!=b.body,!e&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return s}
function ze(a){for(var b=new $d(0,Infinity,Infinity,0),c=ge(a),e=c.ga.body,d=c.ga.documentElement,f=!Ub&&ne(c.ga)?c.ga.documentElement:c.ga.body||c.ga.documentElement;a=ye(a);)if((!M||0!=a.clientWidth)&&(!Ub||0!=a.clientHeight||a!=e)&&a!=e&&a!=d&&"visible"!=ve(a,"overflow")){var g=Ae(a),h;h=a;if(Tb&&!ec("1.9")){var m=parseFloat(ue(h,"borderLeftWidth"));if(Be(h))var j=h.offsetWidth-h.clientWidth-m-parseFloat(ue(h,"borderRightWidth")),m=m+j;h=new Yd(m,parseFloat(ue(h,"borderTopWidth")))}else h=new Yd(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}e=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,e);b.top=Math.max(b.top,f);c=(c.ga.parentWindow||c.ga.defaultView||window).document;c=ne(c)?c.documentElement:c.body;c=new ae(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,e+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&
b.right>b.left?b:s}
function Ae(a){var b,c=ie(a),e=ve(a,"position"),d=!te.ig&&Tb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==e&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Yd(0,0),g=we(c);if(a==g)return f;if(te.ig||a.getBoundingClientRect)b=xe(a),a=se(ge(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!d)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=
b.clientTop||0);if(Ub&&"fixed"==ve(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Sb||Ub&&"absolute"==e)f.y-=c.body.offsetTop;for(b=a;(b=ye(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Sb||"TR"!=b.tagName)f.y-=b.scrollTop}return f}
function Ce(a){var b;if(te.ig||a.getBoundingClientRect)b=xe(a),b=new Yd(b.left,b.top);else{b=se(ge(a));var c=Ae(a);b=new Yd(c.x-b.x,c.y-b.y)}if(Tb&&!ec(12)){b:{var e="transform".replace(/\-([a-z])/g,function(a,b){return b.toUpperCase()});if(a.style[e]===p){var c=Ub?"Webkit":Tb?"Moz":M?"ms":Sb?"O":s,d=na(p)?"undefined".replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"):"\\s",e=e.replace(RegExp("(^"+(d?"|["+d+"]+":"")+")([a-z])","g"),function(a,b,c){return b+c.toUpperCase()});
if(a.style[c+e]!==p){c=(Ub?"-webkit":Tb?"-moz":M?"-ms":Sb?"-o":s)+"-transform";break b}}c="transform"}(a=ve(a,c)||ve(a,"transform"))?(a=a.match(De),a=!a?new Yd(0,0):new Yd(parseFloat(a[1]),parseFloat(a[2]))):a=new Yd(0,0);a=new Yd(b.x+a.x,b.y+a.y)}else a=b;return a}function Ee(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function Fe(a){var b=Ge;if("none"!=ve(a,"display"))return b(a);var c=a.style,e=c.display,d=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=b(a);c.display=e;c.position=f;c.visibility=d;return a}function Ge(a){var b=a.offsetWidth,c=a.offsetHeight,e=Ub&&!b&&!c;return(!ha(b)||e)&&a.getBoundingClientRect?(a=xe(a),new ae(a.right-a.left,a.bottom-a.top)):new ae(b,c)}function He(a,b){a.style.display=b?"":"none"}function Be(a){return"rtl"==ve(a,"direction")}
function Ie(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,e=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var d=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=e;return d}function Je(a,b){var c=a.currentStyle?a.currentStyle[b]:s;return c?Ie(a,c):0}var Ke={thin:2,medium:4,thick:6};function Le(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:s))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:s;return c in Ke?Ke[c]:Ie(a,c)}
var De=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function Me(a,b){Cc.call(this);this.G=a;var c=qa(this.G)&&1==this.G.nodeType?this.G:this.G?this.G.body:s;this.Dj=!!c&&Be(c);this.sm=P(this.G,Tb?"DOMMouseScroll":"mousewheel",this,b)}D(Me,Cc);
Me.prototype.handleEvent=function(a){var b=0,c=0,e=0;a=a.lb;if("mousewheel"==a.type){c=1;if(M||Ub&&(Zb||ec("532.0")))c=40;e=Ne(-a.wheelDelta,c);ha(a.wheelDeltaX)?(b=Ne(-a.wheelDeltaX,c),c=Ne(-a.wheelDeltaY,c)):c=e}else e=a.detail,100<e?e=3:-100>e&&(e=-3),ha(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=e:c=e;A(this.hh)&&(b=Math.min(Math.max(b,-this.hh),this.hh));A(this.ih)&&(c=Math.min(Math.max(c,-this.ih),this.ih));this.Dj&&(b=-b);b=new Oe(e,a,b,c);this.dispatchEvent(b)};
function Ne(a,b){return Ub&&(Yb||$b)&&0!=a%b?a:a/b}function Oe(a,b,c,e){nc.call(this,b);this.type="mousewheel";this.detail=a;this.jm=c;this.Uc=e}D(Oe,nc);M||Ub&&ec("525");function Pe(a){R.call(this);this.f="interactor";this.Ka=a;this.Xe=this.wg=this.vg=this.xg=this.ug=this.yg=s;this.ae=q;this.Wb=this.Pb=this.sb=t;this.ra=[0,0];this.Se=new I.m(0,0,0);this.bd=new I.m(0,0,0);this.dh=0;this.Fg=this.Xd=s;this.Eg=t;this.S={MOUSEWHEEL_ENABLED:q,MOUSECLICKS_ENABLED:q,KEYBOARD_ENABLED:q,HOVERING_ENABLED:q,CONTEXTMENU_ENABLED:t,TOUCH_ENABLED:q,TOUCH_BOUNCING_ENABLED:t}}D(Pe,R);Pe.prototype.__defineGetter__("config",v("S"));Pe.prototype.__defineGetter__("leftButtonDown",v("sb"));
Pe.prototype.__defineGetter__("middleButtonDown",v("Pb"));Pe.prototype.__defineGetter__("rightButtonDown",v("Wb"));
Pe.prototype.Xa=function(){this.S.MOUSEWHEEL_ENABLED?(this.Xe=new Me(this.Ka),this.yg=P(this.Xe,"mousewheel",this.Jd.bind(this))):(xc(this.yg),this.Xe=s);this.S.MOUSECLICKS_ENABLED?(this.ug=P(this.Ka,"mousedown",this.Yj.bind(this)),this.xg=P(this.Ka,"mouseup",this.ck.bind(this))):(xc(this.ug),xc(this.xg));this.Ka.oncontextmenu=this.S.CONTEXTMENU_ENABLED?s:function(){return t};window.onkeydown=this.S.KEYBOARD_ENABLED?this.qh.bind(this):s;this.S.TOUCH_ENABLED?(this.S.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},t),this.yi=P(this.Ka,"touchstart",this.rk.bind(this)),this.xi=P(this.Ka,"touchmove",this.pk.bind(this)),this.wi=P(this.Ka,"touchend",this.lk.bind(this))):(xc(this.yi),xc(this.xi),xc(this.wi));xc(this.vg);xc(this.wg);this.vg=P(this.Ka,"mousemove",this.$j.bind(this));this.wg=P(this.Ka,"mouseout",this.ak.bind(this))};
Pe.prototype.Yj=function(a){0==a.button?this.sb=q:1==a.button?this.Pb=q:2==a.button&&(this.Wb=q);eval("this.onMouseDown("+this.sb+","+this.Pb+","+this.Wb+")");Qe(this);a.preventDefault()};Pe.prototype.Xj=aa();Pe.prototype.ck=function(a){0==a.button?this.sb=t:1==a.button?this.Pb=t:2==a.button&&(this.Wb=t);eval("this.onMouseUp("+this.sb+","+this.Pb+","+this.Wb+")");Qe(this);a.preventDefault()};Pe.prototype.__defineGetter__("mousePosition",v("ra"));w=Pe.prototype;w.bk=aa();
w.ak=function(a){this.ae=t;this.S.KEYBOARD_ENABLED&&(window.onkeydown=s);this.Wb=this.Pb=this.sb=t;Qe(this);this.Se=new I.m(0,0,0);a.preventDefault()};w.Zj=aa();w.rk=function(a){a.preventDefault();a.Xa(a.lb.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.bd=new I.m(a.clientX,a.clientY,0);this.Fg=setTimeout(this.nk.bind(this,a),500)};w.qk=aa();
w.nk=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new Od;a.rb=q;a.ab=this instanceof Re;this.dispatchEvent(a);this.ee=q};w.mk=aa();function Se(a){clearTimeout(a.Fg);if(a.ee){var b=new Od;b.rb=t;b.ab=a instanceof Re;a.dispatchEvent(b)}a.ee=t}w.lk=function(a){a.preventDefault();eval("this.onTouchEnd()");Se(this)};w.kk=aa();
w.pk=function(a){a.preventDefault();this.ee||Se(this);this.touchmoveEvent=a=a.lb;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new I.m(c[0],c[1],0);var b=c[0]>3*this.Ka.clientWidth/4,e=c[0]<this.Ka.clientWidth/4,d=c[1]<this.Ka.clientHeight/4,c=c[1]>3*this.Ka.clientHeight/4,c=!b&&!e&&!d&&!c,d=this.bd.ua(a);this.bd=a.l();if(this.ee)a=new Md,5<d.x?d.x=1:-5>d.x&&(d.x=-1),5<d.y?d.y=1:-5>d.y&&(d.y=-1),a.va=d,this.dispatchEvent(a);
else if(this instanceof Te&&(b||e))a=new Pd,a.da=0>d.y,this.dispatchEvent(a);else if(this instanceof Re||c)d.scale(3),a=new Nd,a.va=d,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new I.m(a[0],a[1],0),b=new I.m(b[0],b[1],0),d=$c(a,b),b=d-this.dh,this.dh=d,this.bd.ua(a),this.bd=a.l(),10<Math.abs(b)&&(a=new Od,a.rb=0<b,a.ab=this instanceof Re,this.dispatchEvent(a)))};w.ok=aa();
w.$j=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.ae=q;this.S.KEYBOARD_ENABLED&&window.onkeydown==s&&(window.onkeydown=this.qh.bind(this));a.preventDefault();var b=a.shiftKey;this.Eg=b;this.ra=[a.offsetX,a.offsetY];var c=new I.m(this.ra[0],this.ra[1],0);a=this.Se.ua(c);this.Se=c.l();this.S.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.Pb||this.sb||this.Wb)&&Qe(this),this.Xd=setTimeout(function(){Qe(this);var a=new Qd;a.he=c.x;a.ie=c.y;this.dispatchEvent(a);
this.Xd=s}.bind(this),300));0!=a.Gb()&&(this.sb&&!b?(b=new Nd,a.scale(3),b.va=a,this.dispatchEvent(b)):this.Pb||this.sb&&b?(b=new Md,b.va=a,this.dispatchEvent(b)):this.Wb&&(b=new Od,b.rb=0<a.y,b.ab=t,this.dispatchEvent(b)))};function Qe(a){a.Xd&&clearTimeout(a.Xd);a.dispatchEvent(new Rd)}w.dk=aa();w.Jd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");Qe(this);a.preventDefault()};w.Vj=aa();
w.qh=function(a){if(this.ae){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");Qe(this);var b=a.altKey,c=a.ctrlKey,e=a.metaKey,d=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!e&&!d?(a.preventDefault(),a=new Sd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),d?a=new Md:b?a=new Od:(a=new Nd,this instanceof Te&&(a=new Pd)),a&&(c=new I.m(0,0,0),37==f?(c.x=5,a.da=t,b&&(a.da=q,a.rb=q,a.ab=t)):39==f?(c.x=-5,a.da=q,b&&(a.rb=t,a.ab=t)):38==f?(c.y=5,a.da=q,b&&(a.rb=q,a.ab=q)):40==f&&(c.y=-5,a.da=t,b&&
(a.rb=t,a.ab=q)),a.va=c,this.dispatchEvent(a)))}};C("X.interactor",Pe);C("X.interactor.prototype.init",Pe.prototype.Xa);C("X.interactor.prototype.onMouseDown",Pe.prototype.Xj);C("X.interactor.prototype.onMouseUp",Pe.prototype.bk);C("X.interactor.prototype.onMouseMove",Pe.prototype.Zj);C("X.interactor.prototype.onMouseWheel",Pe.prototype.dk);C("X.interactor.prototype.onKey",Pe.prototype.Vj);C("X.interactor.prototype.onTouchStart",Pe.prototype.qk);C("X.interactor.prototype.onTouchMove",Pe.prototype.ok);
C("X.interactor.prototype.onTouchEnd",Pe.prototype.kk);C("X.interactor.prototype.onTouchHover",Pe.prototype.mk);function Te(a){Pe.call(this,a);this.f="interactor2D"}D(Te,Pe);Te.prototype.Jd=function(a){Te.A.Jd.call(this,a);var b=new Pd;a.Uc==s&&(a.Uc=0);b.da=0>a.Uc;this.dispatchEvent(b)};function Ue(a,b){(!A(a)||!A(b))&&l(Error("A camera needs valid width and height values."));R.call(this);this.f="camera";this.fc=new I.m(0,100,0);this.Bc=new I.m(0,0,0);this.da=new I.m(0,0,1);this.J=a;this.w=b;this.o=this.ze(this.fc,this.Bc)}D(Ue,R);Ue.prototype.observe=function(a){(a==s||!(a instanceof Pe))&&l(Error("Could not observe the interactor."));P(a,"b",this.hk.bind(this));P(a,"a",this.ek.bind(this));P(a,"c",this.uk.bind(this))};
Ue.prototype.hk=function(a){a instanceof Nd||l(Error("Received no valid rotate event."));this.rotate(a.va)};Ue.prototype.uk=function(a){a instanceof Od||l(Error("Received no valid zoom event."));a.rb?this.fg(a.ab):this.gg(a.ab)};Ue.prototype.ek=function(a){a instanceof Md||l(Error("Received no valid pan event."));this.Pf(a.va)};Ue.prototype.__defineGetter__("view",v("o"));
Ue.prototype.__defineSetter__("view",function(a){(a==s||!(a instanceof Float32Array))&&l(Error("Invalid view matrix."));this.o=a});Ue.prototype.__defineGetter__("position",function(){return[this.fc.x,this.fc.y,this.fc.d]});Ue.prototype.__defineSetter__("position",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid position."));this.fc=new I.m(a[0],a[1],a[2]);this.reset()});Ue.prototype.__defineGetter__("focus",function(){return[this.Bc.x,this.Bc.y,this.Bc.d]});
Ue.prototype.__defineSetter__("focus",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid focus"));this.Bc=new I.m(a[0],a[1],a[2]);this.reset()});Ue.prototype.__defineGetter__("up",function(){return[this.da.x,this.da.y,this.da.d]});Ue.prototype.__defineSetter__("up",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid up vector."));this.da=new I.m(a[0],a[1],a[2]);this.reset()});w=Ue.prototype;w.reset=function(){this.o=this.ze(this.fc,this.Bc)};
w.rotate=function(a){ka(a)&&2==a.length?a=new I.m(a[0],a[1],0):a instanceof I.m||l(Error("Invalid distance vector for rotate operation."));return a};w.Pf=function(a){ka(a)&&2==a.length?a=new I.m(a[0],a[1],0):a instanceof I.m||l(Error("Invalid distance vector for pan operation."));this.o[12]-=a.x;this.o[13]+=a.y};w.fg=function(a){var b=20;a!=s&&!a&&(b=1);this.o[14]+=b};w.gg=function(a){var b=20;a!=s&&!a&&(b=1);this.o[14]-=b};
w.ze=function(a,b){(!(a instanceof I.m)||!(b instanceof I.m))&&l(Error("3D vectors required for calculating the view."));return I.g.Dd()};C("X.camera",Ue);C("X.camera.prototype.pan",Ue.prototype.Pf);C("X.camera.prototype.rotate",Ue.prototype.rotate);C("X.camera.prototype.zoomIn",Ue.prototype.fg);C("X.camera.prototype.zoomOut",Ue.prototype.gg);function Ve(a,b){Ue.call(this,a,b);this.f="camera3D";this.mg=45;this.af=I.g.Cf(I.g.Dd(),this.mg,a/b,1,1E4)}D(Ve,Ue);Ve.prototype.rotate=function(a){a=Ve.A.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=new I.m(this.o[1],this.o[5],this.o[9]),e=new I.m(this.o[0],this.o[4],this.o[8]);c.normalize();e.normalize();I.g.rotate(this.o,b,c.x,c.y,c.d);I.g.rotate(this.o,a,e.x,e.y,e.d)};Ve.prototype.ze=function(a,b){var c=Ve.A.ze.call(this,a,b);I.g.gh(c,a,b,this.da);return c};
function We(a,b,c,e){var d=new Float32Array(4),f=new Float32Array(4),g=new Float32Array(16),h=new Float32Array(16);new Float32Array(16);I.g.multiply(a.af,a.o,h);I.g.X(h,g);d[0]=b;d[1]=c;d[2]=2*e-1;d[3]=1;I.g.kh(g,d,f);f[3]=1/f[3];f[0]*=f[3];f[1]*=f[3];f[2]*=f[3];return f}C("X.camera3D",Ve);function Xe(){R.call(this);this.f="parser";this.N=s;this.C=0;this.ui=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.Zd=q;this.em=-Infinity;this.dm=Infinity}D(Xe,R);Xe.prototype.parse=function(){l(Error("The function parse() should be overloaded."))};function Ye(a){for(var b=Infinity,c=-Infinity,e=a.length,d=0,d=0;d<e;d++)if(!isNaN(a[d]))var f=a[d],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function Ze(a,b,c){b===p&&(b=0);c===p&&(c=a.length);for(var e="",d=0,d=b;d<c;++d)e+=String.fromCharCode(a[d]);return e}
function Z(a,b,c){c!=s||(c=1);var e=1,d=Uint8Array;switch(b){case "schar":d=Int8Array;break;case "ushort":d=Uint16Array;e=2;break;case "sshort":d=Int16Array;e=2;break;case "uint":d=Uint32Array;e=4;break;case "sint":d=Int32Array;e=4;break;case "float":d=Float32Array;e=4;break;case "complex":d=Float64Array;e=8;break;case "double":d=Float64Array,e=8}b=new d(a.N.slice(a.C,a.C+=c*e));if(a.ui!=a.Zd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(d=0;d<a.byteLength;d+=e)for(var f=d+e-1,g=d;f>
g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function $e(a,b){var c=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],e=kd(0,0,0,1),d=jd();vd(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=kd(0,0,b[2]-1,1);vd(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=kd(0,b[1]-
1,0,1);vd(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=kd(b[0]-1,0,0,1);vd(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=kd(b[0]-1,b[1]-1,0,1);vd(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];
c[5]=d[2]>c[5]?d[2]:c[5];e=kd(b[0]-1,0,b[2]-1,1);vd(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=kd(0,b[1]-1,b[2]-1,1);vd(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=kd(b[0]-1,b[1]-1,b[2]-1,1);vd(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:
c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];return c}
function af(a,b){var c=md();if(!(a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2])){var e=Math.acos(a[2]),d=gd(),f=a[0],g=a[1],h=a[2],m=b[0],j=b[1],k=b[2];d[0]=g*k-h*j;d[1]=h*m-f*k;d[2]=f*j-g*m;id(d,d);f=Math.cos(e/2);g=Math.sin(e/2)*d[0];h=Math.sin(e/2)*d[1];e=Math.sin(e/2)*d[2];V(c,0,f*f+g*g-h*h-e*e,2*(g*h-f*e),2*(g*e+f*h),0);V(c,1,2*(g*h+f*e),f*f+h*h-g*g-e*e,2*(h*e-f*g),0);V(c,2,2*(g*e-f*h),2*(h*e+f*g),f*f+e*e-h*h-g*g,0)}e=ld();td(c,e);return[c,e]}
function bf(a,b,c,e,d,f,g,h,m){var j=new ef;id(c,c);for(var k=[],n=[],u=0;6>u;u++)for(var r=Math.floor(u/2),y=(r+1)%3,z=(r+2)%3,F=(4+2*r)%6,H=0;2>H;H++){var K=(2+H+2*r)%6,B=-(c[r]*(d[u]-a[r])+c[y]*(d[K]-a[y]))/c[z]+a[z];if(B>=d[F]&&B<=d[F+1]||B<=d[F]&&B>=d[F+1]){var E=[];E[r]=d[u];E[y]=d[K];E[z]=B;k.push(E)}else E=[],E[r]=d[u],E[y]=d[K],E[z]=B,n.push(E)}a=hd(0,0,1);a=af(c,a);d=a[0];a=a[1];r=[];for(n=0;n<k.length;++n)u=kd(k[n][0],k[n][1],k[n][2],1),y=jd(),vd(d,u,y),r.push([y[0],y[1],y[2]]);d=hd(1,
0,0);k=gd();ud(a,d,k);n=hd(0,1,0);d=gd();ud(a,n,d);u=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];for(n=n=0;n<r.length;++n)r[n][0]<u[0]&&(u[0]=r[n][0]),r[n][0]>u[1]&&(u[1]=r[n][0]),r[n][1]<u[2]&&(u[2]=r[n][1]),r[n][1]>u[3]&&(u[3]=r[n][1]),r[n][2]<u[4]&&(u[4]=r[n][2]),r[n][2]>u[5]&&(u[5]=r[n][2]);n=kd(u[0]+(u[1]-u[0])/2,u[2]+(u[3]-u[2])/2,u[4]+(u[5]-u[4])/2,0);r=jd();sd(a,n,r);y=Math.floor(u[0]);z=Math.ceil(u[1]);y==z&&z++;F=z-y;H=Math.floor(u[2]);
K=Math.ceil(u[3]);B=K-H;E=b[0];b=b[1];var n=Math.ceil(F/E),J=Math.ceil(B/b),N=new Uint8Array(4*n*J),Q=new zd;Q.cf=n;Q.bf=J;var J=jd(),O=kd(0,0,u[4],1),T=ld();sd(g.li,a,T);for(var da=K-1E-7,ea=z-1E-7,L=0,oa=0,G=0,Ma=H,Ma=H;Ma<=da;Ma+=b){G++;oa=0;O[1]=Ma;for(n=y;n<=ea;n+=E){oa++;O[0]=n;vd(T,O,J);var Fa=4*L,tb=Math.floor(J[2]),ub=Math.floor(J[1]),vb=Math.floor(J[0]);if(0<=vb&&vb<g.aa[0]&&0<=ub&&ub<g.aa[1]&&0<=tb&&tb<g.aa[2]){var nb=f[tb][ub][vb],ad=vb=ub=tb=0;m?((nb=m.get(nb))||(nb=[0,0.61,0,0,1]),tb=
255*nb[1],ub=255*nb[2],vb=255*nb[3],ad=255*nb[4]):(tb=ub=vb=255*(nb/g.ba),ad=255);N[Fa]=tb;N[++Fa]=ub;N[++Fa]=vb;N[++Fa]=ad}else N[Fa]=0,N[++Fa]=0,N[++Fa]=0,N[++Fa]=0;L++}}Q.Vb=N;j.F=Q;j.Ai=u;j.ni=a;j.mi=T;j.ti=H;j.bm=K;j.zi=y;j.gm=z;j.rg=oa;j.qg=G;j.Sc=E;j.J=F;j.Dc=b;j.w=B;j.B=[r[0],r[1],r[2]];j.Cc=[c[0],c[1],c[2]];j.de=[k[0],k[1],k[2]];j.da=[d[0],d[1],d[2]];j.O=t;j.Eb=g;j.zb=g.Eb!=s&&!h?t:q;j.yc=e;j.Fb();j.O=t;return j}
function ff(a,b,c,e){var d;d=e.ma;for(var f=[],g=[],h=0;6>h;h++){var m=Math.floor(h/2),j=(m+1)%3,k=(m+2)%3,n=(2+2*m)%6,u=(4+2*m)%6,r=(d[h]-b[m])*(1/c[m]);if(Infinity!=r&&-Infinity!=r){var y=b[j]+c[j]*r,r=b[k]+c[k]*r;y>=d[n]&&y<=d[n+1]&&r>=d[u]&&r<=d[u+1]?(n=[],n[m]=d[h],n[j]=y,n[k]=r,f.push(n)):(n=[],n[m]=d[h],n[j]=y,n[k]=r,g.push(n))}}d=[f,g];b=d[0];e.b[a].k=d;d=Zc(new U(b[0][0],b[0][1],b[0][2]),new U(b[1][0],b[1][1],b[1][2]));e.b[a].am=d;f=hd(0,0,1);g=af(c,f)[0];h=kd(e.Oe[0],e.Oe[1],e.Oe[2],0);
f=jd();vd(g,h,f);g=jd();h=f[2];g[0]=c[0]*h;g[1]=c[1]*h;g[2]=c[2]*h;g[3]=c[3]*h;0.5>Math.abs(f[0])&&(f[0]=0.5);0.5>Math.abs(f[1])&&(f[1]=0.5);e.b[a].Da=[Math.abs(f[0]),Math.abs(f[1])];e.b[a].Nc=f[2];e.b[a].z=g;d=Math.floor(Math.abs(d/f[2]));e.pd[a]=d+1;e.b[a].p=d+1;e.b[a].k[0][0][0]>e.b[a].k[0][1][0]?0<g[0]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][0]<e.b[a].k[0][1][0]?0>g[0]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][1]>
e.b[a].k[0][1][1]?0<g[1]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][1]<e.b[a].k[0][1][1]?0>g[1]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][2]>e.b[a].k[0][1][2]?0<g[2]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][2]<e.b[a].k[0][1][2]&&0>g[2]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d);e.b[a].Ze=-(c[0]*b[0][0]+c[1]*b[0][1]+c[2]*b[0][2])}
function gf(a,b){var c;c=b.N;for(var e=b.aa,d=b.ba,f=Array(e[2]),g=Array(e[2]),h=e[1]*e[0],m=0,j=0,k=0,n=0,u=0,n=0;n<e[2];n++){var r=c.subarray(n*h,(n+1)*h),u=0;g[n]=Array(e[1]);f[n]=Array(e[1]);for(k=0;k<e[1];k++){g[n][k]=new c.constructor(e[0]);f[n][k]=new c.constructor(e[0]);for(j=0;j<e[0];j++)m=r[u],g[n][k][j]=255*(m/d),f[n][k][j]=m,u++}}c=[f,g];b.ja=c[0];b.Zl=c[1];I.Fa(a.f+".reslice");b.K=b.e!=s;b.Ba&&(b.$c=b.Ba.Ga);b.Cm=[0,0,0];b.t=[b.Aa[0]+(b.yb[0]-1)/2,b.Aa[1]+(b.yb[1]-1)/2,b.Aa[2]+(b.yb[2]-
1)/2];b.ma=[Math.min(b.Aa[0],b.Aa[0]+b.yb[0]-1),Math.max(b.Aa[0],b.Aa[0]+b.yb[0]-1),Math.min(b.Aa[1],b.Aa[1]+b.yb[1]-1),Math.max(b.Aa[1],b.Aa[1]+b.yb[1]-1),Math.min(b.Aa[2],b.Aa[2]+b.yb[2]-1),Math.max(b.Aa[2],b.Aa[2]+b.yb[2]-1)];b.b=[{},{},{}];c=hd(b.t[0],b.t[1],b.t[2]);b.b[0].qd=c;e=hd(1,0,0);id(e,e);b.b[0].i=e;d=[1,0,0];b.b[0].v=d;ff(0,c,e,b);b.c[0].c=Array(b.b[0].p);c[0]=b.b[0].k[0][0][0]+b.b[0].z[0]*Math.floor(b.b[0].p/2);c[1]=b.b[0].k[0][0][1]+b.b[0].z[1]*Math.floor(b.b[0].p/2);c[2]=b.b[0].k[0][0][2]+
b.b[0].z[2]*Math.floor(b.b[0].p/2);c=bf(c,b.b[0].Da,b.b[0].i,b.b[0].v,b.ma,b.ja,b,b.K,b.$c);b.K&&(c.e=b.e.c[0].c[Math.floor(b.b[0].p/2)].F);b.c[0].c[Math.floor(b.b[0].p/2)]=c;b.Ab=Math.floor(b.b[0].p/2);b.Ec=Math.floor(b.b[0].p/2);c=hd(b.t[0],b.t[1],b.t[2]);b.b[1].qd=c;e=hd(0,1,0);id(e,e);b.b[1].i=e;d=[0,1,0];b.b[1].v=d;ff(1,c,e,b);b.c[1].c=Array(b.b[1].p);c[0]=b.b[1].k[0][0][0]+b.b[1].z[0]*Math.floor(b.b[1].p/2);c[1]=b.b[1].k[0][0][1]+b.b[1].z[1]*Math.floor(b.b[1].p/2);c[2]=b.b[1].k[0][0][2]+b.b[1].z[2]*
Math.floor(b.b[1].p/2);c=bf(c,b.b[1].Da,b.b[1].i,b.b[1].v,b.ma,b.ja,b,b.K,b.$c);b.K&&(c.e=b.e.c[1].c[Math.floor(b.b[1].p/2)].F);b.c[1].c[Math.floor(b.b[1].p/2)]=c;b.Bb=Math.floor(b.b[1].p/2);b.Fc=Math.floor(b.b[1].p/2);c=hd(b.t[0],b.t[1],b.t[2]);b.b[2].qd=c;e=hd(0,0,1);id(e,e);b.b[2].i=e;d=[0,0.392,0.804];b.b[2].v=d;ff(2,c,e,b);b.c[2].c=Array(b.b[2].p);c[0]=b.b[2].k[0][0][0]+b.b[2].z[0]*Math.floor(b.b[2].p/2);c[1]=b.b[2].k[0][0][1]+b.b[2].z[1]*Math.floor(b.b[2].p/2);c[2]=b.b[2].k[0][0][2]+b.b[2].z[2]*
Math.floor(b.b[2].p/2);c=bf(c,b.b[2].Da,b.b[2].i,b.b[2].v,b.ma,b.ja,b,b.K,b.$c);b.K&&(c.e=b.e.c[2].c[Math.floor(b.b[2].p/2)].F);b.c[2].c[Math.floor(b.b[2].p/2)]=c;b.Cb=Math.floor(b.b[2].p/2);b.Gc=Math.floor(b.b[2].p/2);I.za(a.f+".reslice");return b.ja};function hf(){Xe.call(this);this.f="parserIMAGE"}D(hf,Xe);hf.prototype.parse=function(a,b,c,e){c instanceof ArrayBuffer||l(Error());for(var d=new Uint8Array(c),f=d.length,g=Array(f);f--;)g[f]=String.fromCharCode(d[f]);d=window.btoa(g.join(""));f=new Image;vc(f,"load",this.wk.bind(this,f,a,b,c,e));f.src="data:image/"+e+";base64,"+d};hf.prototype.wk=function(a,b,c){b.qb=a;b.Vb=s;a=new Ed;a.D=c;a.u=b;this.dispatchEvent(a)};C("X.parserIMAGE",hf);C("X.parserIMAGE.prototype.parse",hf.prototype.parse);function jf(a,b){Ue.call(this,a,b);this.f="camera2D"}D(jf,Ue);jf.prototype.rotate=function(a){a=jf.A.rotate.call(this,a);var b=new Ld;0<a.x?b.jf--:0>a.x&&b.jf++;0<a.y?b.We++:0>a.y&&b.We--;this.dispatchEvent(b)};jf.prototype.fg=function(a){var b=20;a!=s&&!a&&(b=0.02);this.o[14]+=b};jf.prototype.gg=function(a){var b=20;a!=s&&!a&&(b=0.02);this.o[14]-=b};
jf.prototype.Pf=function(a){ka(a)&&2==a.length?a=new I.m(a[0],a[1],0):a instanceof I.m||l(Error("Invalid distance vector for pan operation."));this.o[12]-=a.x/this.o[14];this.o[13]+=a.y/this.o[14]};function kf(){R.call(this);this.f="shaders";this.yd="";var a;a="precision mediump float;\n\n";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute vec2 vertexTexturePos;\n";a+="attribute float vertexScalar;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform vec3 center;\n";a+="uniform mat4 objectTransform;\n";a+="uniform bool useObjectColor;\n";a+="uniform bool useScalars;\n";a+="uniform bool scalarsReplaceMode;\n";
a+="uniform float scalarsMin;\n";a+="uniform float scalarsMax;\n";a+="uniform vec3 scalarsMinColor;\n";a+="uniform vec3 scalarsMaxColor;\n";a+="uniform float scalarsMinThreshold;\n";a+="uniform float scalarsMaxThreshold;\n";a+="uniform int scalarsInterpolation;\n";a+="uniform vec3 objectColor;\n";a+="uniform float pointSize;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";
a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ";a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ";a+="vertexNormal;\n";a+="  fVertexNormal = vertexNormal;\n";a+="  fDiscardNow = 0.0;\n";a+="  vec3 vertexPosition2 = vertexPosition - center;\n";a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n";a+="  fragmentTexturePos = vertexTexturePos;\n";
a+="  if (useScalars) {\n";a+="    float scalarValue = vertexScalar;\n";a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n";a+="      if (scalarsReplaceMode) {\n";a+="        fragmentColor = objectColor;\n";a+="      } else {\n";a+="        fDiscardNow = 1.0;\n";a+="      }\n";a+="    } else {\n";a+="      if (scalarsReplaceMode) {\n";a+="        if (scalarsInterpolation == 1) {\n";a+="            vec3 zeroMaxColor;\n";a+="            vec3 zeroMinColor;\n";a+=
"            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n";a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n";a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n";a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n";a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n";a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n";a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n";
a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n";a+="        } else {\n";a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n";a+="          }\n";a+="      } else {\n";a+="        fragmentColor = vertexColor;\n";a+="      }\n";a+="    }\n";a+="  } else if (useObjectColor) {\n";a+="    fragmentColor = objectColor;\n";a+="  } else {\n";a+="    fragmentColor = vertexColor;\n";
a+="  }\n";a+="  gl_PointSize = pointSize;\n";a+="  gl_Position = perspective * fVertexPosition;\n";this.yd=a+="}\n";this.Vd="";a="precision mediump float;\n\n";a+="uniform bool usePicking;\n";a+="uniform bool useTexture;\n";a+="uniform bool volumeTexture;\n";a+="uniform bool useLabelMapTexture;\n";a+="uniform sampler2D textureSampler;\n";a+="uniform sampler2D textureSampler2;\n";a+="uniform float objectOpacity;\n";a+="uniform float labelmapOpacity;\n";a+="uniform vec4 labelmapColor;\n";a+="uniform float volumeLowerThreshold;\n";
a+="uniform float volumeUpperThreshold;\n";a+="uniform float volumeScalarMin;\n";a+="uniform float volumeScalarMax;\n";a+="uniform vec3 volumeScalarMinColor;\n";a+="uniform vec3 volumeScalarMaxColor;\n";a+="uniform float volumeWindowLow;\n";a+="uniform float volumeWindowHigh;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";a+="varying vec3 fTransformedVertexNormal;\n";
a+="\n";a+="void main(void) {\n";a+=" if (fDiscardNow > 0.0) {\n";a+="   discard;\n";a+=" }\n";a+=" if (usePicking) {\n";a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n";a+=" } else if (useTexture) {\n";a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n";a+="   vec4 textureSum = texture1;\n";a+="   if (volumeTexture) {\n";a+="     float _windowLow = (volumeWindowLow / volumeScalarMax);\n";a+="     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n";a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n";
a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n";a+="     vec3 fac = _maxrange - _minrange;\n";a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n";a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n";a+="   }\n";a+="   if (useLabelMapTexture) {\n";a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n";a+="     if (texture2.a > 0.0) {\n";a+="         if (labelmapColor.a != -255.0) {\n";
a+="           if (all(equal(floor(texture2 * vec4(255)), labelmapColor))) {\n";a+="             if (labelmapOpacity < 1.0) {\n";a+="               textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="             } else {\n";a+="               textureSum = texture2;\n";a+="             }\n";a+="           }\n";a+="         } else {\n";a+="           if (labelmapOpacity < 1.0) {\n";a+="             textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="           } else {\n";
a+="             textureSum = texture2;\n";a+="           }\n";a+="         }\n";a+="     }\n";a+="   }\n";a+="   if (volumeTexture) {\n";a+="     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n";a+="     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n";a+="     if (texture1.r < _volumeLowerThreshold ||\n";a+="         texture1.r > _volumeUpperThreshold ||\n";a+="         texture1.a == 0.0 ) {\n";a+="       discard;\n";a+="     };\n";a+="   };\n";
a+="   gl_FragColor = textureSum;\n";a+="   gl_FragColor.a = objectOpacity;\n";a+=" } else {\n";a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n";a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n";a+="     gl_FragColor = vec4(fragmentColor,1.0);\n";a+="     return;\n";a+="   }\n";a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n";a+="   vec3 lightDirection = vec3(-10,0,-10);\n";a+="   lightDirection = normalize(lightDirection);\n";a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n";
a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n";a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n";a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n";a+="   float ambient = 0.2;\n";a+="   gl_FragColor = vec4(fragmentColor * ambient +\n";a+="                       fragmentColor * diffuse +\n";a+="                       vec3(0.0, 0.0, 0.0) * specular,\n";a+="                       objectOpacity);\n";a+=" }\n";this.Vd=a+="}\n"}
D(kf,R);
var lf={Ml:"vertexPosition",Ll:"vertexNormal",Kl:"vertexColor",Ol:"vertexTexturePos",Nl:"vertexScalar"},mf={Pl:"view",tl:"perspective",gl:"center",sl:"objectTransform",Gl:"useObjectColor",ql:"objectColor",Il:"useScalars",Cl:"scalarsReplaceMode",zl:"scalarsMin",wl:"scalarsMax",Al:"scalarsMinColor",xl:"scalarsMaxColor",Bl:"scalarsMinThreshold",yl:"scalarsMaxThreshold",vl:"scalarsInterpolation",ul:"pointSize",rl:"objectOpacity",pl:"normal",Hl:"usePicking",Jl:"useTexture",Fl:"useLabelMapTexture",ml:"labelmapOpacity",
ll:"labelmapColor",Dl:"textureSampler",El:"textureSampler2",Ql:"volumeLowerThreshold",Wl:"volumeUpperThreshold",Tl:"volumeScalarMin",Rl:"volumeScalarMax",Ul:"volumeScalarMinColor",Sl:"volumeScalarMaxColor",Yl:"volumeWindowLow",Xl:"volumeWindowHigh",Vl:"volumeTexture"};kf.prototype.__defineSetter__("vertex",ba("yd"));C("X.shaders",kf);function ef(a){Y.call(this);this.f="slice";this.B=[0,0,0];this.Cc=[0,0,1];this.da=[0,1,0];this.de=[1,0,0];this.w=this.J=10;this.Qc=[0,1,0,0,1,1,1,1,1,0,0,0];this.e=this.Eb=s;this.zb=q;this.yc=[1,1,1];a!=s&&this.kc(a)}D(ef,Y);ef.prototype.kc=function(a){this.B=a.B.slice();this.Cc=a.Cc.slice();this.da=a.da.slice();this.J=a.J;this.w=a.w;this.Eb=a.Eb;this.e=a.e;this.zb=a.zb;this.yc=a.yc;this.si=a.si;ef.A.kc.call(this,a)};ef.prototype.__defineSetter__("height",ba("w"));
ef.prototype.__defineSetter__("width",ba("J"));ef.prototype.create=function(){this.Fb()};
ef.prototype.Fb=function(){var a=(new U(this.Cc[0],this.Cc[1],this.Cc[2])).normalize(),b=new U(this.da[0],this.da[1],this.da[2]),c=new U(this.de[0],this.de[1],this.de[2]),e=new U(this.B[0],this.B[1],this.B[2]),d=bd(c.l().X().scale(this.J/2),b.l().X().scale(this.w/2)),f=new U(d.x+e.x,d.y+e.y,d.d+e.d),d=bd(c.l().X().scale(this.J/2),b.l().scale(this.w/2)),g=new U(d.x+e.x,d.y+e.y,d.d+e.d),d=bd(c.l().scale(this.J/2),b.l().X().scale(this.w/2)),h=new U(d.x+e.x,d.y+e.y,d.d+e.d),d=bd(c.l().scale(this.J/2),
b.l().scale(this.w/2)),b=new U(d.x+e.x,d.y+e.y,d.d+e.d);this.h=new W(18);this.n=new W(18);this.h.add(f.x,f.y,f.d);this.h.add(g.x,g.y,g.d);this.h.add(h.x,h.y,h.d);this.h.add(h.x,h.y,h.d);this.h.add(b.x,b.y,b.d);this.h.add(g.x,g.y,g.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.n.add(a.x,a.y,a.d);this.zb&&(a=new Y,a.h=new W(24),a.n=new W(24),a.h.add(f.x,f.y,f.d),a.h.add(g.x,g.y,g.d),a.h.add(g.x,g.y,g.d),a.h.add(b.x,b.y,
b.d),a.h.add(b.x,b.y,b.d),a.h.add(h.x,h.y,h.d),a.h.add(h.x,h.y,h.d),a.h.add(f.x,f.y,f.d),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.n.add(0,0,0),a.v=[this.yc[0],this.yc[1],this.yc[2]],a.Ea="LINES",a.Ic=2,this.c.push(a))};C("X.slice",ef);C("X.slice.prototype.create",ef.prototype.create);function S(a){Y.call(this);this.f="volume";this.B=[0,0,0];this.aa=[10,10,10];this.ma=[1,1,1];this.pd=[10,10,10];this.Xb=[1,1,1];this.qb=[];this.Gc=this.Cb=this.Fc=this.Bb=this.Ec=this.Ab=0;this.rd=new Y;this.sd=new Y;this.td=new Y;this.ge=this.Na=t;this.W=-1;this.fe=[];this.e=s;this.zb=q;this.fa=Infinity;this.ea=-Infinity;this.Dg=q;this.ba=0;this.N=s;Ga(this,new Rc);Ga(this,new Cd);a!=s&&this.kc(a)}D(S,Y);
S.prototype.kc=function(a){this.B=a.B.slice();this.aa=a.aa.slice();this.Xb=a.Xb.slice();this.Ab=a.Ab;this.Ec=a.Ec;this.Bb=a.Bb;this.Fc=a.Fc;this.Cb=a.Cb;this.Gc=a.Gc;this.lg=a.lg.slice();this.rd=new Y(a.rd);this.sd=new Y(a.sd);this.td=new Y(a.td);this.ba=a.ba;this.N=a.N;this.Na=a.Na;this.ge=a.ge;this.W=a.W;this.e=a.e;this.zb=a.zb;S.A.kc.call(this,a)};
S.prototype.Fb=function(a){this.c.length=0;this.rd.c.length=0;this.sd.c.length=0;this.td.c.length=0;this.c.push(this.rd);this.c.push(this.sd);this.c.push(this.td);this.Aa=a.vc;this.Oe=a.wc;this.yb=a.uc;this.xc=a.Ya;this.li=a.$a;this.ba=a.max;this.N=a.data;this.j=q};
S.prototype.q=function(a){a="undefined"!==typeof a?a:q;if(0<this.c.length){this.Na!=this.ge&&(!this.Na&&-1!=this.W&&(this.c[this.W].visible=t),this.j=q,this.ge=this.Na);if(!this.O)return;for(var b=0,b=0;3>b;b++){var c=this.c[b],e=0,d=0;0==b?(e=this.Ab,d=this.Ec,this.Ec=this.Ab):1==b?(e=this.Bb,d=this.Fc,this.Fc=this.Bb):2==b&&(e=this.Cb,d=this.Gc,this.Gc=this.Cb);if(this.c[b].c[parseInt(e,10)]==s){var f=gd();f[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*parseInt(e,10);f[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*
parseInt(e,10);f[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*parseInt(e,10);if(this.K){var g=bf(f,this.b[b].Da,this.b[b].i,this.b[b].v,this.ma,this.e.ja,this.e,this.e.K,this.e.Ba.Ga);this.e.c[b].c[parseInt(e,10)]=g;this.e.c[b].q(q)}f=bf(f,this.b[b].Da,this.b[b].i,this.b[b].v,this.ma,this.ja,this,q,s);this.K&&(f.e=f.F,f.e=this.e.c[b].c[parseInt(e,10)].F);c.c[parseInt(e,10)]=f;this.c[b].q(q)}d=c.c[parseInt(d,10)];this.Na||(d.visible=t);c=c.c[parseInt(e,10)];c.visible=q;c.sa=1;this.Na&&(c.c[0].O=t,b!=this.W&&
(c.visible=t,c.sa=0))}this.Na&&-1!=this.W&&nf(this,this.W)}a&&S.A.q.call(this)};S.prototype.__defineGetter__("dimensions",v("aa"));S.prototype.__defineSetter__("dimensions",ba("aa"));S.prototype.__defineGetter__("spacing",v("Xb"));S.prototype.__defineSetter__("spacing",ba("Xb"));S.prototype.__defineGetter__("bbox",v("ma"));S.prototype.__defineGetter__("range",v("pd"));S.prototype.__defineGetter__("dimensionsRAS",v("lg"));S.prototype.__defineGetter__("volumeRendering",v("Na"));
S.prototype.__defineSetter__("volumeRendering",function(a){this.Na=a;this.q(t)});S.prototype.__defineGetter__("visible",v("O"));S.prototype.__defineSetter__("visible",function(a){if(a)this.O=a,this.q(t);else{for(var b=this.c,c=b.length,e=0,e=0;e<c;e++)b[e].visible=a;this.O=a;this.j=q}});S.prototype.__defineGetter__("center",v("B"));S.prototype.__defineSetter__("center",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid center."));this.B=a});
S.prototype.__defineGetter__("volumeRenderingCache",v("fe"));S.prototype.__defineSetter__("volumeRenderingCache",function(a){(a==s||!ka(a)||!(3>=a.length))&&l(Error("Invalid volumeRederingCache."));this.fe=a});S.prototype.__defineGetter__("image",v("qb"));S.prototype.__defineGetter__("labelmap",function(){this.e||(this.e=new of(this));return this.e});S.prototype.__defineGetter__("indexX",v("Ab"));S.prototype.__defineSetter__("indexX",function(a){A(a)&&(0<=a&&a<this.rd.c.length)&&(this.Ab=a,this.q(t))});
S.prototype.__defineGetter__("indexY",v("Bb"));S.prototype.__defineSetter__("indexY",function(a){A(a)&&(0<=a&&a<this.sd.c.length)&&(this.Bb=a,this.q(t))});S.prototype.__defineGetter__("indexZ",v("Cb"));S.prototype.__defineSetter__("indexZ",function(a){A(a)&&(0<=a&&a<this.td.c.length)&&(this.Cb=a,this.q(t))});S.prototype.__defineGetter__("windowLow",v("fa"));S.prototype.__defineSetter__("windowLow",ba("fa"));S.prototype.__defineGetter__("windowHigh",v("ea"));
S.prototype.__defineSetter__("windowHigh",ba("ea"));S.prototype.__defineGetter__("borders",v("zb"));S.prototype.__defineSetter__("borders",ba("zb"));S.prototype.__defineGetter__("reslicing",v("Dg"));S.prototype.__defineSetter__("reslicing",ba("Dg"));S.prototype.__defineSetter__("xNormX",function(a){this.b[0].i[0]=a});S.prototype.__defineGetter__("xNormX",function(){return this.b[0].i[0]});S.prototype.__defineSetter__("xNormY",function(a){this.b[0].i[1]=a});S.prototype.__defineGetter__("xNormY",function(){return this.b[0].i[1]});
S.prototype.__defineSetter__("xNormZ",function(a){this.b[0].i[2]=a});S.prototype.__defineGetter__("xNormZ",function(){return this.b[0].i[2]});S.prototype.__defineSetter__("xColor",function(a){this.b[0].v=a});S.prototype.__defineGetter__("xColor",function(){return this.b[0].v});S.prototype.__defineSetter__("yNormX",function(a){this.b[1].i[0]=a});S.prototype.__defineGetter__("yNormX",function(){return this.b[1].i[0]});S.prototype.__defineSetter__("yNormY",function(a){this.b[1].i[1]=a});
S.prototype.__defineGetter__("yNormY",function(){return this.b[1].i[1]});S.prototype.__defineSetter__("yNormZ",function(a){this.b[1].i[2]=a});S.prototype.__defineGetter__("yNormZ",function(){return this.b[1].i[2]});S.prototype.__defineSetter__("yColor",function(a){this.b[1].v=a});S.prototype.__defineGetter__("yColor",function(){return this.b[1].v});S.prototype.__defineSetter__("zNormX",function(a){this.b[2].i[0]=a});S.prototype.__defineGetter__("zNormX",function(){return this.b[2].i[0]});
S.prototype.__defineSetter__("zNormY",function(a){this.b[2].i[1]=a});S.prototype.__defineGetter__("zNormY",function(){return this.b[2].i[1]});S.prototype.__defineSetter__("zNormZ",function(a){this.b[2].i[2]=a});S.prototype.__defineGetter__("zNormZ",function(){return this.b[2].i[2]});S.prototype.__defineSetter__("zColor",function(a){this.b[2].v=a});S.prototype.__defineGetter__("zColor",function(){return this.b[2].v});
S.prototype.Jk=function(a){this.c[a].visible=t;for(var b=0;b<this.c[a].c.length;b++)"undefined"!=typeof this.c[a].c[b]&&(this.K&&(this.e.c[a].c[b].remove(),this.e.c[a].c[b]=s),this.c[a].c[b].remove(),this.c[a].c[b]=s);id(this.b[a].i,this.b[a].i);ff(a,this.b[a].qd,this.b[a].i,this);this.c[a].c=[];this.c[a].c=Array(this.b[a].p);this.K&&(b=bf(this.b[a].qd,this.b[a].Da,this.b[a].i,this.b[a].v,this.ma,this.e.ja,this.e,this.e.K,this.e.Ba.Ga),this.e.c[a].c=[],this.e.c[a].c=Array(this.b[a].p),this.e.c[a].c[Math.floor(this.b[a].p/
2)]=b,this.e.c[a].q());b=bf(this.b[a].qd,this.b[a].Da,this.b[a].i,this.b[a].v,this.ma,this.ja,this,q,s);this.K&&(b.e=b.F,b.e=this.e.c[a].c[Math.floor(this.b[a].p/2)].F);this.c[a].c[Math.floor(this.b[a].p/2)]=b;0==a?(this.Ab=Math.floor(this.b[a].p/2),this.Ec=Math.floor(this.b[a].p/2)):1==a?(this.Bb=Math.floor(this.b[a].p/2),this.Fc=Math.floor(this.b[a].p/2)):(this.Cb=Math.floor(this.b[a].p/2),this.Gc=Math.floor(this.b[a].p/2));this.c[a].q();this.c[a].c[Math.floor(this.b[a].p/2)].O=q};
function nf(a,b){if(!a.Td)if(!a.Na||!a.j&&b==a.W)a.W=b;else if(-1==a.fe.indexOf(b)){a.fe.push(b);a.Td=q;var c=new Ud;c.D=a;a.dispatchEvent(c);a.onComputing(b);setTimeout(function(){var a=s;0<=this.W&&(a=this.c[this.W],a.visible=t);var a=this.c[b],c=a.c.length,d=Math.floor(c/4),e;for(e=0;e<1*d;e++){if(a.c[e]==s){var j=gd();j[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*e;j[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*e;j[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*e;if(this.K){var k=bf(j,this.b[b].Da,this.b[b].i,this.b[b].v,
this.ma,this.e.ja,this.e,this.e.K,this.e.Ba.Ga);this.e.c[b].c[e]=k;this.e.c[b].q(q)}j=bf(j,this.b[b].Da,this.b[b].i,this.b[b].v,this.ma,this.ja,this,q,s);j.c[0].O=t;this.K&&(j.e=j.F,j.e=this.e.c[b].c[e].F);a.c[e]=j}a.c[e].O=q}pf(this,0.25);setTimeout(function(){for(;e<2*d;e++){if(a.c[e]==s){var j=gd();j[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*e;j[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*e;j[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*e;if(this.K){var k=bf(j,this.b[b].Da,this.b[b].i,this.b[b].v,this.ma,this.e.ja,
this.e,this.e.K,this.e.Ba.Ga);this.e.c[b].c[e]=k;this.e.c[b].q(q)}j=bf(j,this.b[b].Da,this.b[b].i,this.b[b].v,this.ma,this.ja,this,q,s);j.c[0].O=t;this.K&&(j.e=j.F,j.e=this.e.c[b].c[e].F);a.c[e]=j}a.c[e].O=q}pf(this,0.5);setTimeout(function(){for(;e<3*d;e++){if(a.c[e]==s){var j=gd();j[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*e;j[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*e;j[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*e;if(this.K){var k=bf(j,this.b[b].Da,this.b[b].i,this.b[b].v,this.ma,this.e.ja,this.e,this.e.K,
this.e.Ba.Ga);this.e.c[b].c[e]=k;this.e.c[b].q(q)}j=bf(j,this.b[b].Da,this.b[b].i,this.b[b].v,this.ma,this.ja,this,q,s);j.c[0].O=t;this.K&&(j.e=j.F,j.e=this.e.c[b].c[e].F);a.c[e]=j}a.c[e].O=q}pf(this,0.75);setTimeout(function(){for(e=3*d;e<c;e++){if(a.c[e]==s){var j=gd();j[0]=this.b[b].k[0][0][0]+this.b[b].z[0]*e;j[1]=this.b[b].k[0][0][1]+this.b[b].z[1]*e;j[2]=this.b[b].k[0][0][2]+this.b[b].z[2]*e;if(this.K){var k=bf(j,this.b[b].Da,this.b[b].i,this.b[b].v,this.ma,this.e.ja,this.e,this.e.K,this.e.Ba.Ga);
this.e.c[b].c[e]=k;this.e.c[b].q(q)}j=bf(j,this.b[b].Da,this.b[b].i,this.b[b].v,this.ma,this.ja,this,q,s);j.c[0].O=t;this.K&&(j.e=j.F,j.e=this.e.c[b].c[e].F);a.c[e]=j}a.c[e].O=q}pf(this,1);setTimeout(function(){this.Td&&this.c[b].q(q);this.W=b;this.j=t;if(this.Td){var a=new Wd;a.D=this;this.dispatchEvent(a);this.onComputingEnd(b)}this.Td=t}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(a),10)}else{c=a.c[a.W];c.visible=t;var c=a.c[b],e=c.c.length,d;for(d=0;d<e;d++)c.c[d].O=q;
a.W=b;a.j=t}}function pf(a,b){var c=new Vd;c.xd=b;a.dispatchEvent(c);a.onComputingProgress(100*b)}S.prototype.If=aa();S.prototype.Kf=aa();S.prototype.Jf=aa();C("X.volume",S);C("X.volume.prototype.modified",S.prototype.q);C("X.volume.prototype.sliceInfoChanged",S.prototype.Jk);C("X.volume.prototype.onComputing",S.prototype.If);C("X.volume.prototype.onComputingProgress",S.prototype.Kf);C("X.volume.prototype.onComputingEnd",S.prototype.Jf);function qf(){Xe.call(this);this.f="parserOFF"}D(qf,Xe);
qf.prototype.parse=function(a,b,c){function e(){m===d&&l(Error("End of file reached unexpectedly."));for(var a=m;a<d;++a)if(10===f[a]){var b=Ze(f,m,a);m=a+1;return b}m=d;return Ze(f,m,d-1)}I.Fa(this.f+".parse");this.N=c;var d=c.byteLength,f=Z(this,"uchar",d);c=[];b.h=new W(d);b.n=new W(d);for(var g=b.h,h=b.n,m=0,j=e(),j=("OFF"===j?e():j).split(" "),k=j[0],j=j[1];k--;){var n=e(),n=n.split(" ");c.push([parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2])])}for(;j--;){var n=e(),n=n.split(" "),u=c[parseInt(n[1],
10)],k=c[parseInt(n[2],10)],n=c[parseInt(n[3],10)];g.add(u[0],u[1],u[2]);g.add(k[0],k[1],k[2]);g.add(n[0],n[1],n[2]);u=new U(u[0],u[1],u[2]);n=new U(n[0],n[1],n[2]);k=cd((new U(k[0],k[1],k[2])).ua(u),n.ua(u));k.normalize();h.add(k.x,k.y,k.d);h.add(k.x,k.y,k.d);h.add(k.x,k.y,k.d)}I.za(this.f+".parse");c=new Ed;c.D=b;c.u=a;this.dispatchEvent(c)};C("X.parserOFF",qf);C("X.parserOFF.prototype.parse",qf.prototype.parse);function rf(){Xe.call(this);this.f="parserDCM"}D(rf,Xe);
rf.prototype.parse=function(a,b,c){b.tc={};b.tc.Bf=0;this.rc(c,b);if(b.r.length==s||b.pa.length==b.r.length){b.tc.Bf=b.r.length;var e={};c={};for(var d=0;d<b.pa.length;d++)e.hasOwnProperty(b.pa[d].series_instance_uid)||(e[b.pa[d].series_instance_uid]=[],c[b.pa[d].series_instance_uid]={}),c[b.pa[d].series_instance_uid].hasOwnProperty(b.pa[d].sop_instance_uid)||(c[b.pa[d].series_instance_uid][b.pa[d].sop_instance_uid]=q,e[b.pa[d].series_instance_uid].push(b.pa[d]));var f=Object.keys(e)[0],d=e[f],g=
d.length;c={};var h="image_position_patient";1==g?(h="image_position_patient",e[f][0].dist=0):d[0].image_position_patient[0]!=d[1].image_position_patient[0]||d[0].image_position_patient[1]!=d[1].image_position_patient[1]||d[0].image_position_patient[2]!=d[1].image_position_patient[2]?(h="image_position_patient",e=new U(d[0].image_orientation_patient[0],d[0].image_orientation_patient[1],d[0].image_orientation_patient[2]),f=new U(d[0].image_orientation_patient[3],d[0].image_orientation_patient[4],d[0].image_orientation_patient[5]),
e=cd(e,f),d.map(function(a,b){b.dist=b.image_position_patient[0]*a.x+b.image_position_patient[1]*a.y+b.image_position_patient[2]*a.d;return b}.bind(s,e)),d.sort(function(a,b){return a.dist-b.dist})):d[0].instance_number!=d[1].instance_number?(h="instance_number",d.sort(function(a,b){return a.instance_number-b.instance_number})):window.console.log("Could not resolve the ordering mode");isNaN(d[0].pixel_spacing[0])&&(d[0].pixel_spacing[0]=1);isNaN(d[0].pixel_spacing[1])&&(d[0].pixel_spacing[1]=1);if(1<
g)switch(h){case "image_position_patient":var m=d[0].image_position_patient,e=d[1].image_position_patient,f=e[0]-m[0],j=e[1]-m[1],k=e[2]-m[2];d[0].pixel_spacing[2]=Math.sqrt(f*f+j*j+k*k);break;case "instance_number":d[0].pixel_spacing[2]=1;break;default:window.console.log("Unkown ordering mode - returning: "+h)}else d[0].pixel_spacing[2]=1;e=1;switch(h){case "image_position_patient":var m=d[0].image_position_patient,n=d[g-1].image_position_patient,f=n[0]-m[0],j=n[1]-m[1],k=n[2]-m[2],f=Math.sqrt(f*
f+j*j+k*k),e=e+Math.round(f/d[0].pixel_spacing[2]);break;case "instance_number":e+=Math.abs(d[g-1].instance_number-d[0].instance_number);break;default:window.console.log("Unkown ordering mode - returning: "+h)}m=d[0].columns*d[0].rows;f=m*e;n=s;switch(d[0].mf){case 8:n=new Uint8Array(f);break;case 16:n=new Uint16Array(f);break;case 32:n=new Uint32Array(f);default:window.console.log("Unknown number of bits allocated - using default: 32 bits")}b.Xb=d[0].pixel_spacing;for(var u=0;u<g;u++){var r=d[u].data,
f=0;switch(h){case "image_position_patient":f=d[u].image_position_patient[0]-d[0].image_position_patient[0];j=d[u].image_position_patient[1]-d[0].image_position_patient[1];k=d[u].image_position_patient[2]-d[0].image_position_patient[2];f=Math.sqrt(f*f+j*j+k*k)/d[0].pixel_spacing[2];break;case "instance_number":f=d[u].instance_number-d[0].instance_number;break;default:window.console.log("Unkown ordering mode - returning: "+h)}n.set(r,f*m)}c.data=n;b.N=n;b.aa=[d[0].columns,d[0].rows,e];c.km=b.aa;e=
Ye(n);g=e[0];e=e[1];c.min=b.Ha=b.fa=g;c.max=b.ba=b.ea=e;-Infinity==b.U&&(b.U=g);Infinity==b.V&&(b.V=e);j=d[0].image_position_patient;g=ld();switch(h){case "image_position_patient":e=new U(d[0].image_orientation_patient[0],d[0].image_orientation_patient[1],d[0].image_orientation_patient[2]);f=new U(d[0].image_orientation_patient[3],d[0].image_orientation_patient[4],d[0].image_orientation_patient[5]);e=cd(e,f);V(g,0,-d[0].image_orientation_patient[0]*d[0].pixel_spacing[0],-d[0].image_orientation_patient[3]*
d[0].pixel_spacing[1],-e.x*d[0].pixel_spacing[2],-j[0]);V(g,1,-d[0].image_orientation_patient[1]*d[0].pixel_spacing[0],-d[0].image_orientation_patient[4]*d[0].pixel_spacing[1],-e.y*d[0].pixel_spacing[2],-j[1]);V(g,2,d[0].image_orientation_patient[2]*d[0].pixel_spacing[0],d[0].image_orientation_patient[5]*d[0].pixel_spacing[1],e.d*d[0].pixel_spacing[2],j[2]);V(g,3,0,0,0,1);break;case "instance_number":V(g,0,-1,0,0,-j[0]);V(g,1,-0,-1,-0,-j[1]);V(g,2,0,0,1,j[2]);V(g,3,0,0,0,1);break;default:window.console.log("Unkown ordering mode - returning: "+
h)}c.Ya=g;c.$a=ld();td(c.Ya,c.$a);h=kd(0,0,0,1);d=jd();vd(g,h,d);h=kd(1,1,1,1);e=jd();vd(g,h,e);c.wc=[e[0]-d[0],e[1]-d[1],e[2]-d[2]];d=$e(g,[b.aa[0],b.aa[1],b.aa[2]]);c.uc=[d[1]-d[0]+1,d[3]-d[2]+1,d[5]-d[4]+1];c.vc=[d[0],d[2],d[4]];b.Fb(c);b.qb=gf(this,b)}c=new Ed;c.D=b;c.u=a;this.dispatchEvent(c)};
function sf(a,b,c,e){switch(c){case 16975:case 20819:case 20053:case 22351:c=function(a){for(var b="",c=128;1<=c;c/=2)b+=a&c?"1":"0";return b};e=a[b++];a=a[b++];e=parseInt(c((a&65280)>>8)+c(a&255)+(c((e&65280)>>8)+c(e&255)),2);4294967295==e&&(e=0);b+=e/2;break;default:b+=e/2}return b}
rf.prototype.rc=function(a,b){this.N=a;if("undefined"==typeof b.pa||b.pa==s)b.pa=[];for(var c={pixel_spacing:[0.1,0.1,Infinity],image_orientation_patient:[1,0,0,0,1,0],image_position_patient:[0,0,0],transfer_syntax_uid:"no_transfer_syntax_uid"},e=Z(this,"ushort",this.N.byteLength),d=66,f=s,g=s,h=s,m=s;d<e.length;)switch(f=e[d++],g=e[d++],h=e[d++],m=e[d++],"1.2.840.10008.1.2"==c.transfer_syntax_uid&&0==m&&(m=h),f){case 2:switch(g){case 16:for(var j="",f=f=0;f<m/2;f++)h=e[d++],g=h&255,h=(h&65280)>>
8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);c.transfer_syntax_uid=j.replace(/\0/g,"");break;default:d=sf(e,d,h,m)}break;case 40:switch(g){case 16:c.rows=e[d];d+=m/2;break;case 17:c.columns=e[d];d+=m/2;break;case 256:c.mf=e[d];d+=m/2;break;case 257:c.bits_stored=e[d];d+=m/2;break;case 2:c.number_of_images=e[d];d+=m/2;break;case 48:j="";for(f=0;f<m/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);j=j.split("\\");c.pixel_spacing=[parseFloat(j[0]),parseFloat(j[1]),
Infinity];break;default:d=sf(e,d,h,m)}break;case 32:switch(g){case 14:c.series_instance_uid="";for(f=0;f<m/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,c.series_instance_uid+=String.fromCharCode(g),c.series_instance_uid+=String.fromCharCode(h);break;case 19:j="";for(f=0;f<m/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);c.instance_number=parseInt(j,10);break;case 50:j="";for(f=0;f<m/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);
j=j.split("\\");c.image_position_patient=[parseFloat(j[0]),parseFloat(j[1]),parseFloat(j[2])];break;case 55:j="";for(f=0;f<m/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);j=j.split("\\");c.image_orientation_patient=[parseFloat(j[0]),parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3]),parseFloat(j[4]),parseFloat(j[5])];break;default:d=sf(e,d,h,m)}break;case 65534:switch(g){default:m=0,d+=m/2}break;case 8:switch(g){case 24:c.sop_instance_uid="";for(f=0;f<m/
2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,c.sop_instance_uid+=String.fromCharCode(g),c.sop_instance_uid+=String.fromCharCode(h);break;default:d=sf(e,d,h,m)}break;case 16:switch(g){case 8720:for(f=0;f<m/2;f++)d++;break;default:d=sf(e,d,h,m)}break;default:d=sf(e,d,h,m)}switch(c.mf){case 8:c.data=new Uint8Array(c.columns*c.rows);break;case 16:c.data=new Uint16Array(c.columns*c.rows);break;case 32:c.data=new Uint32Array(c.columns*c.rows)}this.C=this.N.byteLength-2*c.columns*c.rows;e=s;switch(c.mf){case 8:e=
Z(this,"uchar",c.columns*c.rows);break;case 16:e=Z(this,"ushort",c.columns*c.rows);break;case 32:e=Z(this,"uint",c.columns*c.rows)}c.data=e;b.pa.push(c);return b};C("X.parserDCM",rf);C("X.parserDCM.prototype.parse",rf.prototype.parse);function tf(){Xe.call(this);this.f="parserVTK"}D(tf,Xe);
tf.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");var e=b.h,d=b.n,f=new Uint8Array(c),g="";b.h=e=new W(c.byteLength);b.n=d=new W(c.byteLength);c=0;for(var h=f.length;c<h;c+=32768)g+=Ze(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.vd=this.wd=s;this.ec=[];this.La=Bd;this.Ye=this.Sb=this.Lb=this.Tb=t;c=0;for(h=g%8;h--;)uf(this,f[c]),c++;for(h=0.125*g^0;h--;)uf(this,f[c]),c++,uf(this,f[c]),c++,uf(this,f[c]),c++,uf(this,f[c]),c++,uf(this,f[c]),c++,uf(this,f[c]),c++,uf(this,f[c]),c++,
uf(this,f[c]),c++;c=this.wd;var f=this.vd,g=f.length,m=h=this.ec.length;do{var j=this.ec[h-m],k=j.length,n;for(n=0;n<k&&!("LINES"==this.La&&n+1>=k);n++){var u=parseInt(j[n],10),r=c.get(u);e.add(r[0],r[1],r[2]);var y=u,z=r;"LINES"==this.La?(y=parseInt(j[n+1],10),z=c.get(y),e.add(z[0],z[1],z[2])):"TRIANGLE_STRIPS"==this.La&&(0==n||n==k-1)&&e.add(r[0],r[1],r[2]);u<g?(z=f.get(u),d.add(z[0],z[1],z[2]),"LINES"==this.La?(y=f.get(y),d.add(y[0],y[1],y[2])):"TRIANGLE_STRIPS"==this.La&&(0==n||n==k-1)&&d.add(z[0],
z[1],z[2])):(y=new U(r[0],r[1],r[2]),y.normalize(),d.add(y.x,y.y,y.d),"LINES"==this.La?(y=new U(z[0],z[1],z[2]),y.normalize(),d.add(y.x,y.y,y.d)):"TRIANGLE_STRIPS"==this.La&&(0==n||n==k-1)&&d.add(y.x,y.y,y.d))}m--}while(0<m);b.Ea=this.La;I.za(this.f+".parse");e=new Ed;e.D=b;e.u=a;this.dispatchEvent(e)};
function uf(a,b){b=b.replace(/^\s+|\s+$/g,"");var c=b.split(" "),e=c.length,d=c[0];switch(d){case "POINTS":a.Tb=q;a.Lb=t;a.Sb=t;c=parseInt(c[1],10);a.wd=new W(3*c);a.vd=new W(3*c);return;case "VERTICES":a.Lb=q;a.Tb=t;a.Sb=t;c=parseInt(c[1],10);3<=c?a.La=Bd:1==c?a.La="POINTS":l(Error("This VTK file is not supported!"));a.ec=[];return;case "TRIANGLE_STRIPS":a.Lb=q;a.Tb=t;a.Sb=t;a.La="TRIANGLE_STRIPS";a.ec=[];return;case "LINES":a.Lb=q;a.Tb=t;a.Sb=t;a.La="LINES";a.ec=[];return;case "POLYGONS":a.Lb=q;
a.Tb=t;a.Sb=t;a.La="POLYGONS";a.ec=[];return;case "POINT_DATA":a.Sb=q;a.Tb=t;a.Lb=t;return}if(a.Tb)if(1==e||isNaN(parseFloat(d)))a.Tb=t;else{if(3<=e){var d=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.wd.add(d,f,g)}6<=e&&(d=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.wd.add(d,f,g));9<=e&&(e=parseFloat(c[6]),d=parseFloat(c[7]),c=parseFloat(c[8]),a.wd.add(e,d,c))}else a.Lb?1==e||isNaN(parseFloat(d))?a.Lb=t:(c=c.slice(1),a.ec.push(c)):a.Sb&&("NORMALS"==d?a.Ye=q:1==e||isNaN(parseFloat(d))?
(a.Sb=t,a.Ye=t):a.Ye&&(3<=e&&(d=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.vd.add(d,f,g)),6<=e&&(d=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.vd.add(d,f,g)),9<=e&&(e=parseFloat(c[6]),d=parseFloat(c[7]),c=parseFloat(c[8]),a.vd.add(e,d,c))))}C("X.parserVTK",tf);C("X.parserVTK.prototype.parse",tf.prototype.parse);function vf(){Xe.call(this);this.f="parserFSM";this.Zd=t}D(vf,Xe);
vf.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");this.N=c;var e=b.h,d=b.n;b.Jc=[];var f=b.Jc;c=0;var g;do g=Z(this,"uchar"),c++;while(200>c&&10!=g);Z(this,"uchar");d=Z(this,"uint");c=Z(this,"uint");var h=Z(this,"float",3*d);g=Z(this,"uint",3*c);var m=new Uint32Array(d),j=new Float32Array(9*c);b.h=e=new W(9*c);b.n=d=new W(9*c);var k;for(k=0;k<c;k++){var n=3*k,u=g[n],r=g[n+1],y=g[n+2];f.push(u);f.push(r);f.push(y);m[u]+=1;m[r]+=1;m[y]+=1;var n=3*u,z=3*r,F=3*y,H=h[n],K=h[n+1],B=h[n+2],r=h[z],
y=h[z+1],u=h[z+2],E=h[F],J=h[F+1],N=h[F+2];e.add(H,K,B);e.add(r,y,u);e.add(E,J,N);H=new U(H,K,B);E=new U(E,J,N);r=(new U(r,y,u)).l().ua(H);y=E.l().ua(H);r=cd(r,y).normalize();j[n]+=r.x;j[n+1]+=r.y;j[n+2]+=r.d;j[z]+=r.x;j[z+1]+=r.y;j[z+2]+=r.d;j[F]+=r.x;j[F+1]+=r.y;j[F+2]+=r.d}for(k=0;k<c;k++)n=3*k,u=g[n],r=g[n+1],y=g[n+2],n=3*u,z=3*r,F=3*y,f=new U(j[z],j[z+1],j[z+2]),h=new U(j[F],j[F+1],j[F+2]),n=(new U(j[n],j[n+1],j[n+2])).scale(1/m[u]).normalize(),f=f.scale(1/m[r]).normalize(),h=h.scale(1/m[y]).normalize(),
d.add(n.x,n.y,n.d),d.add(f.x,f.y,f.d),d.add(h.x,h.y,h.d);c=Z(this,"uchar",this.N.byteLength-this.C);g=s;for(n=0;n<c.length;n++)if(99==c[n]&&114==c[n+1]&&97==c[n+2]&&115==c[n+3]){for(d=g=n+9;10!=c[n]&&n<c.length;)d++,n++;g=Ze(c.subarray(g,d)).split(" ");break}g&&(b.ka.Lh(parseFloat(g[0])),b.ka.Mh(parseFloat(g[1])),b.ka.Nh(parseFloat(g[2])));b.Ea=Bd;I.za(this.f+".parse");c=new Ed;c.D=b;c.u=a;this.dispatchEvent(c)};C("X.parserFSM",vf);C("X.parserFSM.prototype.parse",vf.prototype.parse);var wf={qf:function(a,b,c){return wf.update(a,0,b,c)},update:function(a,b,c,e){var d=wf.hi,f="number"===typeof c?c:c=0;e="number"===typeof e?e:a.length;b^=4294967295;for(f=e&7;f--;++c)b=b>>>8^d[(b^a[c])&255];for(f=e>>3;f--;c+=8)b=b>>>8^d[(b^a[c])&255],b=b>>>8^d[(b^a[c+1])&255],b=b>>>8^d[(b^a[c+2])&255],b=b>>>8^d[(b^a[c+3])&255],b=b>>>8^d[(b^a[c+4])&255],b=b>>>8^d[(b^a[c+5])&255],b=b>>>8^d[(b^a[c+6])&255],b=b>>>8^d[(b^a[c+7])&255];return(b^4294967295)>>>0}};
wf.hi=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,
3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,
366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,
3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,
1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,
1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function xf(a){var b=a.length,c=0,e=Number.POSITIVE_INFINITY,d,f,g,h,m,j,k,n,u;for(n=0;n<b;++n)a[n]>c&&(c=a[n]),a[n]<e&&(e=a[n]);d=1<<c;f=new Uint32Array(d);g=1;h=0;for(m=2;g<=c;){for(n=0;n<b;++n)if(a[n]===g){j=0;k=h;for(u=0;u<g;++u)j=j<<1|k&1,k>>=1;for(u=j;u<d;u+=m)f[u]=g<<16|n;++h}++g;h<<=1;m<<=1}return[f,c,e]};function yf(a,b){this.nf=[];this.of=32768;this.kb=this.zd=this.L=this.$f=0;this.input=new Uint8Array(a);this.Jg=t;this.pf=zf;this.Hb=t;if(b||!(b={}))b.index&&(this.L=b.index),b.bufferSize&&(this.of=b.bufferSize),b.bufferType&&(this.pf=b.bufferType),b.resize&&(this.Hb=b.resize);switch(this.pf){case Af:this.la=32768;this.Pa=new Uint8Array(32768+this.of+258);break;case zf:this.la=0;this.Pa=new Uint8Array(this.of);this.nc=this.Xi;this.Mg=this.Li;this.wf=this.Ri;break;default:l(Error("invalid inflate mode"))}}
var Af=0,zf=1;
yf.prototype.Yb=function(){for(;!this.Jg;){var a=Bf(this,3);a&1&&(this.Jg=q);a>>>=1;switch(a){case 0:var a=this.input,b=this.L,c=this.Pa,e=this.la,d=p,f=p,g=p,h=c.length,d=p;this.kb=this.zd=0;d=a[b++];d===p&&l(Error("invalid uncompressed block header: LEN (first byte)"));f=d;d=a[b++];d===p&&l(Error("invalid uncompressed block header: LEN (second byte)"));f|=d<<8;d=a[b++];d===p&&l(Error("invalid uncompressed block header: NLEN (first byte)"));g=d;d=a[b++];d===p&&l(Error("invalid uncompressed block header: NLEN (second byte)"));g|=
d<<8;f===~g&&l(Error("invalid uncompressed block header: length verify"));b+f>a.length&&l(Error("input buffer is broken"));switch(this.pf){case Af:for(;e+f>c.length;)d=h-e,f-=d,c.set(a.subarray(b,b+d),e),e+=d,b+=d,this.la=e,c=this.nc(),e=this.la;break;case zf:for(;e+f>c.length;)c=this.nc({Tg:2});break;default:l(Error("invalid inflate mode"))}c.set(a.subarray(b,b+f),e);e+=f;this.L=b+=f;this.la=e;this.Pa=c;break;case 1:this.wf(Cf,Df);break;case 2:Ef(this);break;default:l(Error("unknown BTYPE: "+a))}}return this.Mg()};
var Ff=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),Hf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),If=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),Jf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Kf=new Uint8Array(288),
Lf,Mf;Lf=0;for(Mf=Kf.length;Lf<Mf;++Lf)Kf[Lf]=143>=Lf?8:255>=Lf?9:279>=Lf?7:8;var Cf=xf(Kf),Nf=new Uint8Array(30),Of,Pf;Of=0;for(Pf=Nf.length;Of<Pf;++Of)Nf[Of]=5;var Df=xf(Nf);function Bf(a,b){for(var c=a.zd,e=a.kb,d=a.input,f=a.L,g;e<b;)g=d[f++],g===p&&l(Error("input buffer is broken")),c|=g<<e,e+=8;g=c&(1<<b)-1;a.zd=c>>>b;a.kb=e-b;a.L=f;return g}
function Qf(a,b){for(var c=a.zd,e=a.kb,d=a.input,f=a.L,g=b[0],h=b[1],m;e<h;)m=d[f++],m===p&&l(Error("input buffer is broken")),c|=m<<e,e+=8;d=g[c&(1<<h)-1];g=d>>>16;a.zd=c>>g;a.kb=e-g;a.L=f;return d&65535}
function Ef(a){function b(a,b,c){var d,e,f;for(f=0;f<a;)switch(d=Qf(this,b),d){case 16:for(d=3+Bf(this,2);d--;)c[f++]=e;break;case 17:for(d=3+Bf(this,3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+Bf(this,7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var c=Bf(a,5)+257,e=Bf(a,5)+1,d=Bf(a,4)+4,f=new Uint8Array(Ff.length),g;for(g=0;g<d;++g)f[Ff[g]]=Bf(a,3);d=xf(f);f=new Uint8Array(c);g=new Uint8Array(e);a.wf(xf(b.call(a,c,d,f)),xf(b.call(a,e,d,g)))}w=yf.prototype;
w.wf=function(a,b){var c=this.Pa,e=this.la;this.Pg=a;for(var d=c.length-258,f,g,h;256!==(f=Qf(this,a));)if(256>f)e>=d&&(this.la=e,c=this.nc(),e=this.la),c[e++]=f;else{f-=257;h=Gf[f];0<Hf[f]&&(h+=Bf(this,Hf[f]));f=Qf(this,b);g=If[f];0<Jf[f]&&(g+=Bf(this,Jf[f]));e>=d&&(this.la=e,c=this.nc(),e=this.la);for(;h--;)c[e]=c[e++-g]}for(;8<=this.kb;)this.kb-=8,this.L--;this.la=e};
w.Ri=function(a,b){var c=this.Pa,e=this.la;this.Pg=a;for(var d=c.length,f,g,h;256!==(f=Qf(this,a));)if(256>f)e>=d&&(c=this.nc(),d=c.length),c[e++]=f;else{f-=257;h=Gf[f];0<Hf[f]&&(h+=Bf(this,Hf[f]));f=Qf(this,b);g=If[f];0<Jf[f]&&(g+=Bf(this,Jf[f]));e+h>d&&(c=this.nc(),d=c.length);for(;h--;)c[e]=c[e++-g]}for(;8<=this.kb;)this.kb-=8,this.L--;this.la=e};
w.nc=function(){var a=new Uint8Array(this.la-32768),b=this.la-32768,c=this.Pa;a.set(c.subarray(32768,a.length));this.nf.push(a);this.$f+=a.length;c.set(c.subarray(b,b+32768));this.la=32768;return c};w.Xi=function(a){var b=this.input.length/this.L+1|0,c=this.input,e=this.Pa;a&&("number"===typeof a.Tg&&(b=a.Tg),"number"===typeof a.Ci&&(b+=a.Ci));2>b?(a=(c.length-this.L)/this.Pg[2],a=258*(a/2)|0,a=a<e.length?e.length+a:e.length<<1):a=e.length*b;a=new Uint8Array(a);a.set(e);return this.Pa=a};
w.Mg=function(){var a=0,b=this.Pa,c=this.nf,e,d=new Uint8Array(this.$f+(this.la-32768)),f,g,h,m;if(0===c.length)return this.Pa.subarray(32768,this.la);f=0;for(g=c.length;f<g;++f){e=c[f];h=0;for(m=e.length;h<m;++h)d[a++]=e[h]}f=32768;for(g=this.la;f<g;++f)d[a++]=b[f];this.nf=[];return this.buffer=d};w.Li=function(){var a,b=this.la;this.Hb?(a=new Uint8Array(b),a.set(this.Pa.subarray(0,b))):a=this.Pa.subarray(0,b);return this.buffer=a};new Uint8Array(256);var Rf;for(Rf=0;256>Rf;++Rf)for(var Sf=Rf,Tf=7,Sf=Sf>>>1;Sf;Sf>>>=1)--Tf;var Uf=[],Vf;for(Vf=0;288>Vf;Vf++)switch(q){case 143>=Vf:Uf.push([Vf+48,8]);break;case 255>=Vf:Uf.push([Vf-144+400,9]);break;case 279>=Vf:Uf.push([Vf-256+0,7]);break;case 287>=Vf:Uf.push([Vf-280+192,8]);break;default:l("invalid literal: "+Vf)}
function Wf(){var a=Xf;switch(q){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-
31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:l("invalid length: "+a)}}var Yf=[],Xf,Zf;
for(Xf=3;258>=Xf;Xf++)Zf=Wf(),Yf[Xf]=Zf[2]<<24|Zf[1]<<16|Zf[0];new Uint32Array(Yf);function $f(){};function ag(a){this.input=a;this.L=0;this.member=[]}
ag.prototype.Yb=function(){for(var a=this.input.length;this.L<a;){var b=new $f,c=p,e=p,d=p,f=c=d=p,g=p,c=c=p,h=this.input,e=this.L;b.Yg=h[e++];b.Zg=h[e++];(31!==b.Yg||139!==b.Zg)&&l(Error("invalid file signature:",b.Yg,b.Zg));b.Lg=h[e++];switch(b.Lg){case 8:break;default:l(Error("unknown compression method: "+b.Lg))}b.pe=h[e++];c=h[e++]|h[e++]<<8|h[e++]<<16|h[e++]<<24;b.wm=new Date(1E3*c);b.Hm=h[e++];b.Bm=h[e++];0<(b.pe&4)&&(b.Ke=h[e++]|h[e++]<<8,e+=b.Ke);if(0<(b.pe&8)){g=[];for(f=0;0<(c=h[e++]);)g[f++]=
String.fromCharCode(c);b.name=g.join("")}if(0<(b.pe&16)){g=[];for(f=0;0<(c=h[e++]);)g[f++]=String.fromCharCode(c);b.comment=g.join("")}0<(b.pe&2)&&(b.Mi=wf.qf(h,0,e)&65535,b.Mi!==(h[e++]|h[e++]<<8)&&l(Error("invalid header crc16")));c=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24;h.length-e-4-4<512*c&&(d=c);e=new yf(h,{index:e,bufferSize:d});b.data=d=e.Yb();e=e.L;b.im=c=(h[e++]|h[e++]<<8|h[e++]<<16|h[e++]<<24)>>>0;wf.qf(d)!==c&&l(Error("invalid CRC-32 checksum: 0x"+wf.qf(d).toString(16)+
" / 0x"+c.toString(16)));b.om=c=(h[e++]|h[e++]<<8|h[e++]<<16|h[e++]<<24)>>>0;(d.length&4294967295)!==c&&l(Error("invalid input size: "+(d.length&4294967295)+" / "+c));this.member.push(b);this.L=e}a=this.member;b=d=e=0;for(h=a.length;b<h;++b)d+=a[b].data.length;d=new Uint8Array(d);for(b=0;b<h;++b)d.set(a[b].data,e),e+=a[b].data.length;return d};function bg(){Xe.call(this);this.f="parserMGZ";this.Zd=t}D(bg,Xe);
bg.prototype.parse=function(a,b,c,e){I.Fa(this.f+".parse");e&&(c=(new ag(new Uint8Array(c))).Yb(),c=c.buffer);e=this.rc(c);var d=[e.Ef,e.Ff,e.Gf];b.aa=d;var f=e.Oh;b.Xb=f;c=e.min;var g=e.max;b.Ha=b.fa=c;b.ba=b.ea=g;-Infinity==b.U&&(b.U=c);Infinity==b.V&&(b.V=g);c=ld();V(c,0,e.Za[0][0],e.Za[1][0],e.Za[2][0],0);V(c,1,e.Za[0][1],e.Za[1][1],e.Za[2][1],0);V(c,2,e.Za[0][2],e.Za[1][2],e.Za[2][2],0);V(c,3,0,0,0,1);for(var g=d[0]/2,h=d[1]/2,m=d[2]/2,d=[0,0,0],j=0;3>j;++j)d[j]=e.Za[3][j]-(c[j+0]*f[0]*g+c[j+
4]*f[1]*h+c[j+8]*f[2]*m);f=d[1];g=d[2];c[12]=d[0];c[13]=f;c[14]=g;c[15]=1;e.Ya=c;e.$a=ld();td(e.Ya,e.$a);d=kd(0,0,0,1);f=jd();vd(c,d,f);g=kd(1,1,1,1);d=jd();vd(c,g,d);c=$e(c,b.aa);e.wc=[d[0]-f[0],d[1]-f[1],d[2]-f[2]];e.uc=[c[1]-c[0]+1,c[3]-c[2]+1,c[5]-c[4]+1];e.vc=[c[0],c[2],c[4]];b.Fb(e);I.za(this.f+".parse");b.qb=gf(this,b);e=new Ed;e.D=b;e.u=a;this.dispatchEvent(e)};
bg.prototype.rc=function(a){this.N=a;a={version:0,ki:0,ii:0,dj:0,ji:0,Ef:0,Ff:0,Gf:0,Qj:0,type:0,Vi:0,Ch:0,ol:s,Za:s,Oh:s,data:s,min:Infinity,max:-Infinity};a.version=Z(this,"uint");a.Ef=Z(this,"uint");a.Ff=Z(this,"uint");a.Gf=Z(this,"uint");a.Qj=Z(this,"uint");a.type=Z(this,"uint");a.Vi=Z(this,"uint");a.Ch=Z(this,"ushort");if(0<a.Ch){a.Oh=Z(this,"float",3);var b=[];b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",3));a.Za=b}this.C=284;b=a.Ef*a.Ff*
a.Gf;switch(a.type){case 0:a.data=Z(this,"uchar",b);break;case 1:a.data=Z(this,"uint",b);break;case 3:a.data=Z(this,"float",b);break;case 4:a.data=Z(this,"ushort",b);break;default:l(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Ye(a.data);a.min=b[0];a.max=b[1];this.C+16<this.N.byteLength&&(a.ki=Z(this,"float"),a.dj=Z(this,"float"),a.ii=Z(this,"float"),a.ji=Z(this,"float"));return a};C("X.parserMGZ",bg);C("X.parserMGZ.prototype.parse",bg.prototype.parse);function cg(){Xe.call(this);this.f="parserLBL"}D(cg,Xe);
cg.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");var e=b.Jc,d=e.length;0==d&&l(Error("No _pointIndices defined on the X.object."));this.N=c;var f=[],g=Z(this,"uchar",c.byteLength),h=g.length,m=t,j=0;for(c=1;c<h;c++)10==g[c-1]?(j=c,m=q):m&&32==g[c]&&(f.push(parseInt(Ze(g,j,c),10)),m=t);g=b.I.H?b.I.H:new Float32Array(d);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*d);for(c=h=0;c<d;c++)m=e[c],m>d&&l(Error("Could not find scalar for vertex.")),m=g[m],f[h++]=m,f[h++]=m,f[h++]=m;b.I.H=
g;b.I.ad=f;b.I.j=q;I.za(this.f+".parse");e=new Ed;e.D=b;e.u=a;this.dispatchEvent(e)};C("X.parserLBL",cg);C("X.parserLBL.prototype.parse",cg.prototype.parse);function dg(){Xe.call(this);this.f="parserCRV";this.Zd=t}D(dg,Xe);
dg.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");var e=b.Jc;0==e.length&&l(Error("No _pointIndices defined on the X.object."));this.N=c;this.C=3;var d=Z(this,"uint");Z(this,"uint");Z(this,"uint");var f=0,g=0,h=0,m=0,j=0,k=0,n=0,u=0,r=0,y=0,z=0;c=Array(2);var F=Array(2),H=Z(this,"float",d),K;for(K=0;K<d;K++){var B=H[K];0==K&&(c[0]=F[0]=B);0<=B?(f++,m+=B):(g++,h+=B);r+=B;z++;F[0]=Math.max(B,F[0]);c[0]=Math.min(B,c[0]);H[K]=B}0!=f&&(j=m/f);0!=g&&(k=h/g);0!=z&&(y=r/z);for(z=r=h=m=0;z<d;z++)B=
H[z],K=0,0<=B?(K=Math.pow(B-j,2),m+=K):(K=Math.pow(B-k,2),h+=K),K=Math.pow(B-y,2),r+=K;1<f&&(n=Math.sqrt(m/(f-1)));1<g&&(u=Math.sqrt(h/(g-1)));c[1]=k-2.5*u;F[1]=j+2.5*n;d=e.length;f=new Float32Array(3*d);for(z=0;z<d;z++)g=H[e[z]],h=3*z,f[h]=g,f[h+1]=g,f[h+2]=g;b.I.Ha=c[1];b.I.ba=F[1];-Infinity==b.I.U&&(b.I.U=c[1]);Infinity==b.I.V&&(b.I.V=F[1]);b.I.H=H;b.I.ad=f;b.I.j=q;I.za(this.f+".parse");e=new Ed;e.D=b;e.u=a;this.dispatchEvent(e)};C("X.parserCRV",dg);C("X.parserCRV.prototype.parse",dg.prototype.parse);function eg(a,b){var c,e;this.input=a;this.L=0;if(b||!(b={}))b.index&&(this.L=b.index),b.verify&&(this.Wk=b.verify);c=a[this.L++];e=a[this.L++];switch(c&15){case 8:this.method=8;break;default:l(Error("unsupported compression method"))}0!==((c<<8)+e)%31&&l(Error("invalid fcheck flag:"+((c<<8)+e)%31));e&32&&l(Error("fdict flag is not supported"));this.Dh=new yf(a,{index:this.L,bufferSize:b.bufferSize,bufferType:b.bufferType,resize:b.resize})}
eg.prototype.Yb=function(){var a=this.input,b;b=this.Dh.Yb();this.L=this.Dh.L;if(this.Wk){var a=(a[this.L++]<<24|a[this.L++]<<16|a[this.L++]<<8|a[this.L++])>>>0,c=b;if("string"===typeof c){var c=c.split(""),e,d;e=0;for(d=c.length;e<d;e++)c[e]=(c[e].charCodeAt(0)&255)>>>0}e=1;d=0;for(var f=c.length,g,h=0;0<f;){g=1024<f?1024:f;f-=g;do e+=c[h++],d+=e;while(--g);e%=65521;d%=65521}a!==(d<<16|e)>>>0&&l(Error("invalid adler-32 checksum"))}return b};function fg(){Xe.call(this);this.f="parserRAW"}D(fg,Xe);
fg.prototype.parse=function(a,b,c,e){I.Fa(this.f+".parse");e&&(c=(new eg(new Uint8Array(c))).Yb(),c=c.buffer);e={};e.data=new Uint8Array(c);var d=Ye(e.data);c=d[0];d=d[1];e.min=b.Ha=b.fa=c;e.max=b.ba=b.ea=d;-Infinity==b.U&&(b.U=c);Infinity==b.V&&(b.V=d);d=md();e.Ya=d;e.$a=md();var f=kd(0,0,0,1);c=jd();vd(d,f,c);var g=kd(1,1,1,1),f=jd();vd(d,g,f);d=$e(d,b.aa);e.wc=[f[0]-c[0],f[1]-c[1],f[2]-c[2]];e.uc=[d[1]-d[0]+1,d[3]-d[2]+1,d[5]-d[4]+1];e.vc=[d[0],d[2],d[4]];b.Fb(e);I.za(this.f+".parse");b.qb=gf(this,
b);e=new Ed;e.D=b;e.u=a;this.dispatchEvent(e)};C("X.parserRAW",fg);C("X.parserRAW.prototype.parse",fg.prototype.parse);function gg(){Xe.call(this);this.f="parserLUT"}D(gg,Xe);
gg.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");this.N=c;c=Z(this,"uchar",c.byteLength);var e=c.length,d=0,f;for(f=0;f<e;f++)if(10==c[f]){var g=Ze(c,d,f),d=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}I.za(this.f+".parse");c=new Ed;c.D=b;c.u=a;this.dispatchEvent(c)};
C("X.parserLUT",gg);C("X.parserLUT.prototype.parse",gg.prototype.parse);function hg(){Xe.call(this);this.f="parserMRC"}D(hg,Xe);
hg.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");c=this.rc(c);var e=c.min,d=c.max;b.aa=[c.Gd,c.Hd,c.Id];b.Xb=[c.Ke/c.lh,c.Rh/c.mh,c.Sh/c.nh];b.Ha=b.fa=e;b.ba=b.ea=d;-Infinity==b.U&&(b.U=e);Infinity==b.V&&(b.V=d);d=ld();V(d,3,0,0,0,1);V(d,0,-1,0,0,c.Gd);V(d,1,0,0,-1,c.Hd);V(d,2,0,-1,0,c.Id);c.Ya=d;c.$a=ld();td(c.Ya,c.$a);var f=kd(0,0,0,1),e=jd();vd(d,f,e);var g=kd(1,1,1,1),f=jd();vd(d,g,f);g=[c.Gd,c.Hd,c.Id];d=$e(d,g);c.wc=[f[0]-e[0],f[1]-e[1],f[2]-e[2]];c.uc=[d[1]+d[0]+1,d[3]-d[2]+1,d[5]-
d[4]+1];c.vc=[d[0],d[2],d[4]];b.aa=g;b.Fb(c);b.qb=gf(this,b);I.za(this.f+".parse");c=new Ed;c.D=b;c.u=a;this.dispatchEvent(c)};
hg.prototype.rc=function(a){this.N=a;a={Gd:0,Hd:0,Id:0,mode:0,ym:0,zm:0,Am:0,lh:0,mh:0,nh:0,Ke:0,Rh:0,Sh:0,alpha:0,Hi:0,ej:0,Ij:0,Jj:0,Kj:0,lf:0,je:0,jc:0,qm:0,next:0,Ni:0,Zi:s,Rj:0,Tj:0,Zi:s,tj:0,nm:0,rj:0,Ej:0,Nj:0,Oj:0,Uk:0,Vk:0,Rk:s,Xk:0,Zk:0,$k:0,hm:0,Gm:0,Dk:0,Sj:0,data:s,min:Infinity,max:-Infinity,um:0,Hh:s,Fm:s,Dm:s,orientation:s,xm:s};this.C=0;a.Gd=Z(this,"sint");a.Hd=Z(this,"sint");a.Id=Z(this,"sint");a.mode=Z(this,"sint");var b=a.Gd*a.Hd*a.Id;this.C=1024;switch(a.mode){case 0:a.data=Z(this,
"schar",b);break;case 1:a.data=Z(this,"sshort",b);break;case 2:a.data=Z(this,"float",b);break;case 3:a.data=Z(this,"uint",b);break;case 4:a.data=Z(this,"double",b);break;case 6:a.data=Z(this,"ushort",b);break;case 16:a.data=Z(this,"uchar",b);break;default:l(Error("Unsupported MRC data type: "+a.mode))}this.C=28;a.lh=Z(this,"sint");a.mh=Z(this,"sint");a.nh=Z(this,"sint");a.Ke=Z(this,"float");a.Rh=Z(this,"float");a.Sh=Z(this,"float");a.alpha=Z(this,"float");a.Hi=Z(this,"float");a.ej=Z(this,"float");
a.Ij=Z(this,"sint");a.Jj=Z(this,"sint");a.Kj=Z(this,"sint");a.lf=Z(this,"float");a.je=Z(this,"float");a.jc=Z(this,"float");a.pm=Z(this,"sint");a.next=Z(this,"sint");a.Ni=Z(this,"short");a.Rj=Z(this,"short");a.Tj=Z(this,"short");a.tj=Z(this,"sint");a.mm=Z(this,"sint");a.rj=Z(this,"short");a.Ej=Z(this,"short");a.Nj=Z(this,"short");a.Oj=Z(this,"short");a.Uk=Z(this,"short");a.Vk=Z(this,"short");a.Rk=Z(this,"float",6);this.C=196;a.Xk=Z(this,"float");a.Zk=Z(this,"float");a.$k=Z(this,"float");this.C=216;
a.Dk=Z(this,"float");a.Sj=Z(this,"sint");a.rm=Z(this,"schar",10);if(0!=a.next)switch(this.C=parseInt(a.next+1024,10),a.mode){case 0:a.data=Z(this,"schar",b);break;case 1:a.data=Z(this,"sshort",b);break;case 2:a.data=Z(this,"float",b);break;case 3:a.data=Z(this,"uint",b);break;case 4:a.data=Z(this,"double",b);break;case 6:a.data=Z(this,"ushort",b);break;case 16:a.data=Z(this,"uchar",b);break;default:l(Error("Unsupported MRC data type: "+a.mode))}0>a.jc-(a.je-a.jc)?(a.min=a.lf,a.max=a.jc+(a.jc-a.lf)):
(a.min=a.jc-(a.je-a.jc),a.max=a.je);return a};C("X.parserMRC",hg);C("X.parserMRC.prototype.parse",hg.prototype.parse);function ig(){Xe.call(this);this.f="parserNRRD"}D(ig,Xe);
ig.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");this.N=c;c=Z(this,"uchar",c.byteLength);var e=c.length,d=s,f=0,g;for(g=1;g<e;g++)if(10==c[g-1]&&10==c[g]){d=Ze(c,0,g-2);f=g+1;break}var h,m,j,k,e=d.split(/\r?\n/),d=0;for(g=e.length;d<g;d++)if(h=e[d],h.match(/NRRD\d+/))this.Cj=q;else if(!h.match(/^#/)&&(k=h.match(/(.*):(.*)/)))m=k[1].trim(),h=k[2].trim(),(j=this.$i[m])?j.call(this,h):this[m]=h;this.Cj||l(Error("Not an NRRD file"));"raw"!==this.encoding&&("gzip"!==this.encoding&&"gz"!==this.encoding)&&
l(Error("Only raw or gz/gzip encoding is allowed"));if(!this.ia&&(this.ia=[new U(1,0,0),new U(0,1,0),new U(0,0,1)],this.Yf)){e=[];for(k=0;2>=k;k++)e.push(!isNaN(this.Yf[k])?this.ia[k].scale(this.Yf[k]):p)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new ag(new Uint8Array(f))).Yb();f=f.buffer;c={data:s,min:Infinity,max:-Infinity};c.data=new this.Kb(f);k=Ye(c.data);f=c.min=k[0];k=c.max=k[1];b.Ha=b.fa=f;b.ba=b.ea=k;b.aa=[this.Wf[0],this.Wf[1],this.Wf[2]];e=(new U(this.ia[0][0],this.ia[0][1],
this.ia[0][2])).Gb();d=(new U(this.ia[1][0],this.ia[1][1],this.ia[1][2])).Gb();g=(new U(this.ia[2][0],this.ia[2][1],this.ia[2][2])).Gb();b.Xb=[e,d,g];-Infinity==b.U&&(b.U=f);Infinity==b.V&&(b.V=k);e=k=1;"left-posterior-superior"==this.Hh&&(e=k=-1);f=md();V(f,0,k*this.ia[0][0],k*this.ia[1][0],k*this.ia[2][0],k*this.Xf[0]);V(f,1,e*this.ia[0][1],e*this.ia[1][1],e*this.ia[2][1],e*this.Xf[1]);V(f,2,1*this.ia[0][2],1*this.ia[1][2],1*this.ia[2][2],1*this.Xf[2]);V(f,3,0,0,0,1);c.Ya=f;c.$a=ld();td(c.Ya,c.$a);
e=kd(0,0,0,1);k=jd();vd(f,e,k);d=kd(1,1,1,1);e=jd();vd(f,d,e);f=$e(f,b.aa);c.wc=[e[0]-k[0],e[1]-k[1],e[2]-k[2]];c.uc=[f[1]-f[0]+1,f[3]-f[2]+1,f[5]-f[4]+1];c.vc=[f[0],f[2],f[4]];b.Fb(c);I.za(this.f+".parse");b.qb=gf(this,b);c=new Ed;c.D=b;c.u=a;this.dispatchEvent(c)};
ig.prototype.$i={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Kb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Kb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Kb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Kb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Kb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Kb=Uint32Array;break;case "float":this.Kb=Float32Array;break;case "double":this.Kb=Float64Array;break;default:l(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return this.lm=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.Zb=parseInt(a,10)},sizes:function(a){var b,c,e,d;e=a.split(/\s+/);d=[];b=0;for(c=e.length;b<c;b++)a=e[b],d.push(parseInt(a,10));
return this.Wf=d},space:function(a){return this.Hh=a},"space origin":function(a){return this.Xf=a.split("(")[1].split(")")[0].split(",")},"space directions":function(a){var b,c;a=a.match(/\(.*?\)/g);var e,d,f;f=[];e=0;for(d=a.length;e<d;e++)c=a[e],f.push(function(){var a,d,e,f;e=c.slice(1,-1).split(/,/);f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(parseFloat(b));return f}());return this.ia=f},spacings:function(a){var b;b=a.split(/\s+/);var c,e,d;d=[];c=0;for(e=b.length;c<e;c++)a=b[c],d.push(parseFloat(a));
return this.Yf=d}};C("X.parserNRRD",ig);C("X.parserNRRD.prototype.parse",ig.prototype.parse);function jg(){Xe.call(this);this.f="parserSTL"}D(jg,Xe);
jg.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");this.N=c;var e=b.h,d=b.n;if("solid"==Ze(Z(this,"uchar",5))){b.h=e=new W(c.byteLength);b.n=d=new W(c.byteLength);var f=e,e=d,d=Z(this,"uchar",c.byteLength-5);c=d.length;var g=t,h=t,m=0,j;for(j=0;j<c;j++)if(10==d[j]){if(g||h){var k=Ze(d,m,j).split(" "),h=parseFloat(k[0]),n=parseFloat(k[1]),k=parseFloat(k[2]);g?(e.add(h,n,k),e.add(h,n,k),e.add(h,n,k)):f.add(h,n,k);h=g=t}}else 32==d[j-1]&&(102==d[j]?(m=j+=13,g=q):118==d[j]&&(m=j+=7,h=q))}else{this.C=
80;f=Z(this,"uint");b.h=e=new W(9*f);b.n=d=new W(9*f);for(c=c=0;c<f;c++)g=Z(this,"float",12),m=g[0],j=g[1],h=g[2],d.add(m,j,h),d.add(m,j,h),d.add(m,j,h),e.add(g[3],g[4],g[5]),e.add(g[6],g[7],g[8]),e.add(g[9],g[10],g[11]),this.C+=2}I.za(this.f+".parse");f=new Ed;f.D=b;f.u=a;this.dispatchEvent(f)};C("X.parserSTL",jg);C("X.parserSTL.prototype.parse",jg.prototype.parse);function kg(){Xe.call(this);this.f="parserNII"}D(kg,Xe);
kg.prototype.parse=function(a,b,c){var e=c,d=-1,d="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,q);348!=d&&(e=(new ag(new Uint8Array(e))).Yb(),e=e.buffer);c=this.rc(e);e=c.min;d=c.max;b.Ha=b.fa=e;b.ba=b.ea=d;-Infinity==b.U&&(b.U=e);Infinity==b.V&&(b.V=d);e=ld();V(e,3,0,0,0,1);if(0<c.Tf){var d=0,f=c.zh,g=c.Ah,h=c.Bh,m=1,j=1,k=1,n=c.wh,u=c.xh,r=c.yh,d=1-(f*f+g*g+h*h);1E-7>d?(d=1/Math.sqrt(f*f+g*g+h*h),f*=d,g*=d,h*=d,d=0):d=Math.sqrt(d);0<c.nb[1]&&(m=c.nb[1]);
0<c.nb[2]&&(j=c.nb[2]);0<c.nb[2]&&(k=c.nb[3]);0>c.nb[0]&&(k=-k);V(e,0,(d*d+f*f-g*g-h*h)*m,2*(f*g-d*h)*j,2*(f*h+d*g)*k,n);V(e,1,2*(f*g+d*h)*m,(d*d+g*g-f*f-h*h)*j,2*(g*h-d*f)*k,u);V(e,2,2*(f*h-d*g)*m,2*(g*h+d*f)*j,(d*d+h*h-g*g-f*f)*k,r)}else 0<c.Fh?(d=c.Ih,f=c.Jh,g=c.Kh,V(e,0,d[0],d[1],d[2],d[3]),V(e,1,f[0],f[1],f[2],f[3]),V(e,2,g[0],g[1],g[2],g[3])):0==c.Tf?(V(e,0,c.nb[1],0,0,0),V(e,1,0,c.nb[2],0,0),V(e,2,0,0,c.nb[3],0)):window.console.log("UNKNOWN METHOD IN PARSER NII");c.Ya=e;c.$a=ld();td(c.Ya,c.$a);
f=kd(0,0,0,1);d=jd();vd(e,f,d);g=kd(1,1,1,1);f=jd();vd(e,g,f);g=[c.Zb[1],c.Zb[2],c.Zb[3]];e=$e(e,g);c.wc=[f[0]-d[0],f[1]-d[1],f[2]-d[2]];c.uc=[e[1]-e[0]+1,e[3]-e[2]+1,e[5]-e[4]+1];c.vc=[e[0],e[2],e[4]];b.aa=g;b.Fb(c);b.qb=gf(this,b);c=new Ed;c.D=b;c.u=a;this.dispatchEvent(c)};
kg.prototype.rc=function(a){this.N=a;a={Ik:0,Pi:s,Qi:s,Yi:0,Gk:0,Ak:0,Ui:s,Zb:s,yj:0,zj:0,Aj:0,wj:0,vf:0,Ii:0,Nk:0,nb:s,Ph:0,Fk:0,Ek:0,Mk:0,Kk:s,Yk:s,Ji:0,Ki:0,Lk:0,Sk:0,hj:0,ij:0,Si:s,Fi:s,Tf:0,Fh:0,zh:0,Ah:0,Bh:0,wh:0,xh:0,yh:0,Ih:s,Jh:s,Kh:s,xj:s,Fj:s,data:s,min:Infinity,max:-Infinity};a.Ik=Z(this,"uint");a.Pi=Z(this,"uchar",10);a.Qi=Z(this,"uchar",18);a.Yi=Z(this,"uint");a.Gk=Z(this,"ushort");a.Ak=Z(this,"uchar");a.Ui=Z(this,"uchar");a.Zb=Z(this,"ushort",8);a.yj=Z(this,"float");a.zj=Z(this,"float");
a.Aj=Z(this,"float");a.wj=Z(this,"ushort");a.vf=Z(this,"ushort");a.Ii=Z(this,"ushort");a.Nk=Z(this,"ushort");a.nb=Z(this,"float",8);a.Ph=Z(this,"float");a.Fk=Z(this,"float");a.Ek=Z(this,"float");a.Mk=Z(this,"ushort");a.Kk=Z(this,"uchar");a.Yk=Z(this,"uchar");a.Ji=Z(this,"float");a.Ki=Z(this,"float");a.Lk=Z(this,"float");a.Sk=Z(this,"float");a.hj=Z(this,"uint",1);a.ij=Z(this,"uint",1);a.Si=Z(this,"uchar",80);a.Fi=Z(this,"uchar",24);a.Tf=Z(this,"ushort");a.Fh=Z(this,"ushort");a.zh=Z(this,"float");a.Ah=
Z(this,"float");a.Bh=Z(this,"float");a.wh=Z(this,"float");a.xh=Z(this,"float");a.yh=Z(this,"float");a.Ih=Z(this,"float",4);a.Jh=Z(this,"float",4);a.Kh=Z(this,"float",4);a.xj=Z(this,"uchar",16);a.Fj=Z(this,"uchar",4);this.C=parseInt(a.Ph,10);var b=a.Zb[1]*a.Zb[2]*a.Zb[3];switch(a.vf){case 2:a.data=Z(this,"uchar",b);break;case 4:a.data=Z(this,"sshort",b);break;case 8:a.data=Z(this,"sint",b);break;case 16:a.data=Z(this,"float",b);break;case 32:a.data=Z(this,"complex",b);break;case 64:a.data=Z(this,"double",
b);break;case 256:a.data=Z(this,"schar",b);break;case 512:a.data=Z(this,"ushort",b);break;case 768:a.data=Z(this,"uint",b);break;default:l(Error("Unsupported NII data type: "+a.vf))}b=Ye(a.data);a.min=b[0];a.max=b[1];return a};C("X.parserNII",kg);C("X.parserNII.prototype.parse",kg.prototype.parse);function lg(){Xe.call(this);this.f="parserTRK"}D(lg,Xe);
lg.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");var e=b.h,d=b.n,f=b.na;this.N=c;Z(this,"uchar",6);Z(this,"ushort",3);var g=Z(this,"float",3);Z(this,"float",3);var h=Z(this,"ushort");Z(this,"uchar",200);Z(this,"ushort");Z(this,"uchar",200);c=Z(this,"float",16);Z(this,"uchar",444);Z(this,"uchar",4);Z(this,"uchar",4);Z(this,"float",6);Z(this,"uchar",2);Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");var m=Z(this,"uint");Z(this,"uint");var j=Z(this,
"uint"),k=0===m?Infinity:m,n=[],u=[],m=Infinity,r=-Infinity,y=s,z=s,F=s,H=s,d=e=s,K=Z(this,"uint",(this.N.byteLength-1E3)/4);this.C=j;for(var B=Z(this,"float",(this.N.byteLength-1E3)/4),E=0,j=f=0;j<k;j++){if("undefined"===typeof K[E]){k=j;break}for(var J=K[E],N=new W(3*J),Q=0,O=0;O<J;O++){var T=B[E+3*O+O*h+1],da=B[E+3*O+O*h+2],ea=B[E+3*O+O*h+3],T=T/g[0],da=da/g[1],ea=ea/g[2];N.add(T,da,ea);if(0<O)var L=N.get(O-1),Q=Q+Math.sqrt(Math.pow(T-L[0],2)+Math.pow(da-L[1],2)+Math.pow(ea-L[2],2));O<J-1&&(f+=
6)}E+=3*J+J*h+1;O=N.fb;J=N.bb;T=N.gb;da=N.cb;ea=N.hb;L=N.eb;if(!y||O<y)y=O;if(!z||J>z)z=J;if(!F||T<F)F=T;if(!H||da>H)H=da;if(!e||ea<e)e=ea;if(!d||L>d)d=L;n.push(N);u.push(Q)}g=(y+z)/2;h=(F+H)/2;H=(e+d)/2;F=new Float32Array(f);b.h=e=new W(f);b.n=d=new W(f);b.na=f=new W(f);for(j=y=0;j<k;j++){z=n[j];K=z.count;Q=u[j];m=Math.min(m,Q);r=Math.max(r,Q);for(O=0;O<K-1;O++){E=z.get(O);B=z.get(O+1);e.add(E[0],E[1],E[2]);e.add(B[0],B[1],B[2]);var N=E[0]-g,J=E[1]-h,T=E[2]-H,da=Math.sqrt(N*N+J*J+T*T),ea=B[0]-g,
L=B[1]-h,oa=B[2]-H,G=Math.sqrt(ea*ea+L*L+oa*oa);d.add(N/da,J/da,T/da);d.add(ea/G,L/G,oa/G);B=[Math.abs(B[0]-E[0]),Math.abs(B[1]-E[1]),Math.abs(B[2]-E[2])];E=Math.sqrt(B[0]*B[0]+B[1]*B[1]+B[2]*B[2]);B[0]/=E;B[1]/=E;B[2]/=E;f.add(B[0],B[1],B[2]);f.add(B[0],B[1],B[2]);F[y++]=Q;F[y++]=Q;F[y++]=Q;F[y++]=Q;F[y++]=Q;F[y++]=Q}}b.Ea="LINES";k=new Dd;k.Ha=m;k.ba=r;k.U=m;k.V=r;k.ad=F;k.Cg=t;k.j=q;b.I=k;m=t;for(j=0;16>j;j++)if(0!=c[j]){m=q;break}m==t&&(c[0]=c[5]=c[10]=c[15]=1);I.za(this.f+".parse");I.g.ag(c,
b.ka.R);c=new Ed;c.D=b;c.u=a;this.dispatchEvent(c)};C("X.parserTRK",lg);C("X.parserTRK.prototype.parse",lg.prototype.parse);function mg(){Xe.call(this);this.f="parserOBJ"}D(mg,Xe);
mg.prototype.parse=function(a,b,c){I.Fa(this.f+".parse");this.N=c;c=c.byteLength;var e=Z(this,"uchar",c),d=[];b.h=new W(c);b.n=new W(c);var f=b.h,g=b.n,h=0,m;for(m=0;m<c;++m)if(10==e[m]){var j=Ze(e,h,m).replace(/\s{2,}/g," ").split(" ");if("v"==j[0])d.push([parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3])]);else if("f"==j[0]){var k=d[parseInt(j[1],10)-1],h=d[parseInt(j[2],10)-1],j=d[parseInt(j[3],10)-1];f.add(k[0],k[1],k[2]);f.add(h[0],h[1],h[2]);f.add(j[0],j[1],j[2]);k=new U(k[0],k[1],k[2]);j=
new U(j[0],j[1],j[2]);h=cd((new U(h[0],h[1],h[2])).ua(k),j.ua(k));h.normalize();g.add(h.x,h.y,h.d);g.add(h.x,h.y,h.d);g.add(h.x,h.y,h.d)}h=m+1}I.za(this.f+".parse");c=new Ed;c.D=b;c.u=a;this.dispatchEvent(c)};C("X.parserOBJ",mg);C("X.parserOBJ.prototype.parse",mg.prototype.parse);function ng(){R.call(this);this.f="loader";this.Hc=new Sc;this.od=0}D(ng,R);function og(a,b){a.od+=b/a.Hc.qe()/3;a.od=Math.min(1,a.od);var c=new Td;c.xd=a.od;a.dispatchEvent(c)}function pg(a){a=a.r.ce;var b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in qg||l(Error("The "+b+" file format is not supported."));return[a,b,qg[b][0],qg[b][1],qg[b][2]]}
ng.prototype.load=function(a,b){(!a||!b)&&l(Error("No container or object to load."));if(!Wc(this.Hc.ha,a.wa)||this.Hc.get(a.wa)){this.Hc.set(a.wa,t);var c=pg(a)[0];if(a.pb!=s)this.parse(s,a,b);else{var e=new XMLHttpRequest;P(e,"abort",this.Sg.bind(this,e,a,b));P(e,"error",this.Sg.bind(this,e,a,b));P(e,"load",this.parse.bind(this,e,a,b));e.open("GET",c,q);e.responseType="arraybuffer";e.send(s)}}};
ng.prototype.parse=function(a,b,c){og(this,1);setTimeout(function(){var e=pg(b),d=e[3],e=new e[2];vc(e,"h",this.complete.bind(this));var f=b.pb;f==s&&(f=a.response,b.pb=f);e.parse(b,c,f,d)}.bind(this),100)};ng.prototype.complete=function(a){og(this,1);setTimeout(function(){var b=a.u,c=a.D;b.r.j=t;b.j=q;c.q();this.Hc.set(b.wa,q)}.bind(this),100)};ng.prototype.Sg=function(a,b,c){l(Error("Loading failed: ",b,c))};
var qg={OBJ:[mg,s],OFF:[qf,s],STL:[jg,s],VTK:[tf,s],TRK:[lg,s],MRC:[hg,s],ST:[hg,s],FSM:[vf,s],INFLATED:[vf,s],SMOOTHWM:[vf,s],SPHERE:[vf,s],PIAL:[vf,s],ORIG:[vf,s],NRRD:[ig,s],NII:[kg,s],GZ:[kg,s],DCM:[rf,s],DICOM:[rf,s],"":[rf,s],CRV:[dg,s],LABEL:[cg,s],MGH:[bg,t],MGZ:[bg,q],RAW:[fg,t],RZ:[fg,q],TXT:[gg,s],LUT:[gg,s],PNG:[hf,"png"],JPG:[hf,"jpeg"],JPEG:[hf,"jpeg"],GIF:[hf,"gif"]};function rg(a){function b(a,b,e){b=2*b*Math.PI;b=za(Aa(m,Math.cos(b)),Aa(j,Math.sin(b)));a=za(za(c,Aa(d,a)),Aa(b,f));e=za(Aa(b,1-Math.abs(e)),Aa(g,e));return new Ec(a,e)}this.Y=[];a=a||{};var c=new ya(a.start||[0,-1,0]),e=new ya(a.end||[0,1,0]),d=Ca(e,c),f=a.vb||1;a=a.pa||16;for(var g=Da(d),h=0.5<Math.abs(g.y()),m=Da((new ya(h,!h,0)).mc(g)),j=Da(m.mc(g)),h=new Ec(c,Ea(g)),e=new Ec(e,Da(g)),k=[],n=0;n<a;n++){var u=n/a,r=(n+1)/a;k.push(new Gc([h,b(0,u,-1),b(0,r,-1)]));k.push(new Gc([b(0,r,0),b(0,u,
0),b(1,u,0),b(1,r,0)]));k.push(new Gc([e,b(1,r,1),b(1,u,1)]))}return Oc(k)}D(rg,Nc);function sg(){Y.call(this);this.f="cylinder";this.gf=[-10,-10,-10];this.Qe=[10,10,10];this.gc=10;this.Wa=32;Ga(this,new Hd)}D(sg,Y);sg.prototype.__defineGetter__("start",v("gf"));sg.prototype.__defineSetter__("start",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid start"));this.gf=a});sg.prototype.__defineGetter__("end",v("Qe"));sg.prototype.__defineSetter__("end",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid end"));this.Qe=a});sg.prototype.__defineGetter__("radius",v("gc"));
sg.prototype.__defineSetter__("radius",function(a){A(a)||l(Error("Invalid radius."));this.gc=a});sg.prototype.q=function(){Jd(this,new rg({start:this.gf,end:this.Qe,vb:this.gc,pa:this.Wa}));sg.A.q.call(this)};C("X.cylinder",sg);C("X.cylinder.prototype.modified",sg.prototype.q);function tg(a){function b(a,b){a*=2*Math.PI;b*=Math.PI;var d=new ya(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Ec(za(c,Aa(d,e)),d))}this.Y=[];a=a||{};var c=new ya(a.rf||[0,0,0]),e=a.vb||1,d=a.pa||16;a=a.Ok||8;for(var f=[],g=[],h=0;h<d;h++)for(var m=0;m<a;m++)g=[],b(h/d,m/a),0<m&&b((h+1)/d,m/a),m<a-1&&b((h+1)/d,(m+1)/a),b(h/d,(m+1)/a),f.push(new Gc(g));return Oc(f)}D(tg,Nc);function ug(){Y.call(this);this.f="sphere";this.B=[0,0,0];this.gc=5;this.Wa=32;this.vi=16;Ga(this,new Hd)}D(ug,Y);ug.prototype.__defineGetter__("center",v("B"));ug.prototype.__defineSetter__("center",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid center"));this.B=a});ug.prototype.__defineGetter__("radius",v("gc"));ug.prototype.__defineSetter__("radius",function(a){A(a)||l(Error("Invalid radius."));this.gc=a});
ug.prototype.q=function(){Jd(this,new tg({rf:this.B,vb:this.gc,pa:this.Wa,Ok:this.vi}));ug.A.q.call(this)};C("X.sphere",ug);C("X.sphere.prototype.modified",ug.prototype.q);function of(a){S.call(this);this.f="labelmap";this.Eb=a;this.ff=new Float32Array([-255,-255,-255,-255])}D(of,S);of.prototype.q=function(){var a=new Ed;a.D=this;this.dispatchEvent(a);this.Eb.q()};of.prototype.__defineSetter__("showOnly",function(a){var b=[-1,-1,-1,-1];a!=s&&(ka(a)&&4==a.length?b=a:(this.Ba||l(Error("No colortable assigned.")),b=this.Ba.Ga.get(a).slice(1,5)));this.ff=new Float32Array([Math.floor(255*b[0]),Math.floor(255*b[1]),Math.floor(255*b[2]),Math.floor(255*b[3])])});
C("X.labelmap",of);function vg(a){this.Y=[];a=a||{};var b=new ya(a.rf||[0,0,0]),c=!a.vb?[1,1,1]:a.vb.length?a.vb:[a.vb,a.vb,a.vb];return Oc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Gc(a[0].map(function(d){d=new ya(b.x()+c[0]*(2*!!(d&1)-1),b.y()+c[1]*(2*!!(d&2)-1),b.d()+c[2]*(2*!!(d&4)-1));return new Ec(d,new ya(a[1]))}))}))}D(vg,Nc);function wg(){Y.call(this);this.f="cube";this.B=[0,0,0];this.Ve=this.Ue=this.Te=20;this.Qc=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Ga(this,new Hd)}D(wg,Y);wg.prototype.__defineGetter__("center",v("B"));wg.prototype.__defineSetter__("center",function(a){(a==s||!ka(a)||3!=a.length)&&l(Error("Invalid center"));this.B=a});wg.prototype.__defineGetter__("lengthX",v("Te"));
wg.prototype.__defineSetter__("lengthX",function(a){A(a)||l(Error("Invalid lengthX."));this.Te=a});wg.prototype.__defineGetter__("lengthY",v("Ue"));wg.prototype.__defineSetter__("lengthY",function(a){A(a)||l(Error("Invalid lengthY."));this.Ue=a});wg.prototype.__defineGetter__("lengthZ",v("Ve"));wg.prototype.__defineSetter__("lengthZ",function(a){A(a)||l(Error("Invalid lengthZ."));this.Ve=a});wg.prototype.q=function(){Jd(this,new vg({rf:this.B,vb:[this.Te/2,this.Ue/2,this.Ve/2]}));wg.A.q.call(this)};
C("X.cube",wg);C("X.cube.prototype.modified",wg.prototype.q);function Re(a){Pe.call(this,a);this.f="interactor3D";this.$l=t}D(Re,Pe);Re.prototype.Jd=function(a){Re.A.Jd.call(this,a);var b=new Od;a.Uc==s&&(a.Uc=0);b.rb=0>a.Uc;b.ab=q;this.dispatchEvent(b)};function xg(a){R.call(this);this.f="array";this.H=[];this.jg=a}D(xg,R);function yg(a,b,c){for(var e=0;4>e;e++)if(a[e+0]!==b[e+c])return t;return q}xg.prototype.add=function(a){this.H.push(a);return q};xg.prototype.remove=function(a){a=this.H.indexOf(a);-1<a&&this.H.splice(a,1);return q};xg.prototype.clear=function(){this.H.length=0};
function zg(a,b,c){var e=c-b;if(!(2>e)){e=b+Math.floor(e/2);zg(a,b,e);for(zg(a,e,c);b<e;++b)if(0<a.jg(a.H[b],a.H[e])){var d=a.H[b];a.H[b]=a.H[e];for(var f=a,g=e,h=c;g+1<h&&0>f.jg(f.H[g+1],d);){var m=f,j=g+1,k=m.H[g];m.H[g]=m.H[j];m.H[j]=k;++g}f.H[g]=d}}}xg.prototype.sort=function(){zg(this,0,this.H.length)};function Ag(a){jc.call(this);this.mb=a;this.P={}}D(Ag,jc);var Bg=[];w=Ag.prototype;w.pc=function(a,b,c,e){ka(b)||(b&&(Bg[0]=b.toString()),b=Bg);for(var d=0;d<b.length;d++){var f=P(a,b[d],c||this.handleEvent,e||t,this.mb||this);if(!f)break;this.P[f.key]=f}return this};w.fh=function(a,b,c,e){return Cg(this,a,b,c,e)};function Cg(a,b,c,e,d,f){if(ka(c))for(var g=0;g<c.length;g++)Cg(a,b,c[g],e,d,f);else{b=vc(b,c,e||a.handleEvent,d,f||a.mb||a);if(!b)return a;a.P[b.key]=b}return a}
w.cg=function(a,b,c,e,d){if(ka(b))for(var f=0;f<b.length;f++)this.cg(a,b[f],c,e,d);else c=c||this.handleEvent,d=d||this.mb||this,c=rc(c),e=!!e,b=gb(a)?a.Bd(b,c,e,d):a?(a=tc(a))?a.Bd(b,c,e,d):s:s,b&&(xc(b),delete this.P[b.key]);return this};w.Md=function(){kb(this.P,xc);this.P={}};w.handleEvent=function(){l(Error("EventHandler.handleEvent not implemented"))};function Dg(){}Dg.gj=function(){return Dg.ah?Dg.ah:Dg.ah=new Dg};Dg.prototype.Pj=0;function Eg(a){Cc.call(this);this.$b=a||ge();this.Ck=Fg}D(Eg,Cc);x("goog.ui.Component.ALLOW_DETACHED_DECORATION",t);Eg.prototype.qj=Dg.gj();x("goog.ui.Component.DEFAULT_BIDI_DIR",0);var Fg=1==Eg.di?t:-1==Eg.di?q:s;w=Eg.prototype;w.$g=s;w.Wc=t;w.G=s;w.Ck=s;w.Kd=s;w.Ad=s;w.sf=s;w.s=v("G");w.Vf=function(a){this.Kd&&this.Kd!=a&&l(Error("Method not supported"));Eg.A.Vf.call(this,a)};w.re=v("$b");w.Tc=function(){this.G=this.$b.createElement("div")};w.bc=function(a){this.cc(a)};
w.cc=function(a,b){this.Wc&&l(Error("Component already rendered"));this.G||this.Tc();a?a.insertBefore(this.G,b||s):this.$b.ga.body.appendChild(this.G);(!this.Kd||this.Kd.Wc)&&this.ne()};w.ne=function(){function a(a){!a.Wc&&a.s()&&a.ne()}this.Wc=q;this.Ad&&xb(this.Ad,a,p)};w.oe=function(){function a(a){a.Wc&&a.oe()}this.Ad&&xb(this.Ad,a,p);this.jj&&this.jj.Md();this.Wc=t};
w.removeChild=function(a,b){if(a){var c=na(a)?a:a.$g||(a.$g=":"+(a.qj.Pj++).toString(36)),e;this.sf&&c?(e=this.sf,e=(c in e?e[c]:p)||s):e=s;a=e;c&&a&&(e=this.sf,c in e&&delete e[c],Ab(this.Ad,a),b&&(a.oe(),a.G&&oe(a.G)),c=a,c==s&&l(Error("Unable to set parent component")),c.Kd=s,Eg.A.Vf.call(c,s))}a||l(Error("Child is not in parent component"));return a};var Gg;function Ig(a,b,c){ma(c)&&(c=c.join(" "));var e="aria-"+b;""===c||c==p?(Gg||(Gg={atomic:t,autocomplete:"none",dropeffect:"none",haspopup:t,live:"off",multiline:t,multiselectable:t,orientation:"vertical",readonly:t,relevant:"additions text",required:t,sort:"none",busy:t,disabled:t,hidden:t,invalid:"false"}),c=Gg,b in c?a.setAttribute(e,c[b]):a.removeAttribute(e)):a.setAttribute(e,c)};x("goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST",t);function Jg(){Cc.call(this)}D(Jg,Cc);w=Jg.prototype;w.dg=0;w.Fd=0;w.Df=100;w.Rg=0;w.Zf=1;w.Bj=t;w.Mj=t;w.Od=function(a){a=Kg(this,a);this.dg!=a&&(this.dg=a+this.Rg>this.Df?this.Df-this.Rg:a<this.Fd?this.Fd:a,!this.Bj&&!this.Mj&&this.dispatchEvent("change"))};w.ue=function(){return Kg(this,this.dg)};w.te=function(){return Kg(this,this.Fd)};w.se=function(){return Kg(this,this.Df)};function Kg(a,b){return a.Zf==s?b:a.Fd+Math.round((b-a.Fd)/a.Zf)*a.Zf};function Lg(a){Eg.call(this,a);this.Ld=new Jg;P(this.Ld,"change",this.kj,t,this)}D(Lg,Eg);var Mg={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};w=Lg.prototype;w.Tc=function(){this.wb=this.re().Tc("div","progress-bar-thumb");var a=Mg[this.uh];this.G=this.re().Tc("div",a,this.wb);Ng(this);Ig(this.s(),"valuemin",this.te());Ig(this.s(),"valuemax",this.se())};
w.ne=function(){Lg.A.ne.call(this);M&&7>cc&&P(this.s(),"resize",this.Je,t,this);this.Je();var a=this.s();a.setAttribute("role","progressbar");Ig(a,"live","polite")};w.oe=function(){Lg.A.oe.call(this);M&&7>cc&&wc(this.s(),"resize",this.Je,t,this)};w.ue=function(){return this.Ld.ue()};w.Od=function(a){this.Ld.Od(a);this.s()&&Ng(this)};function Ng(a){Ig(a.s(),"valuenow",a.ue())}w.te=function(){return this.Ld.te()};w.se=function(){return this.Ld.se()};w.uh="horizontal";w.kj=function(){this.Je();this.dispatchEvent("change")};
w.Je=function(){if(this.wb){var a=this.te(),b=this.se(),a=(this.ue()-a)/(b-a),b=Math.round(100*a);"vertical"==this.uh?M&&7>cc?(this.wb.style.top=0,this.wb.style.height="100%",b=this.wb.offsetHeight,a=Math.round(a*b),this.wb.style.top=b-a+"px",this.wb.style.height=a+"px"):(this.wb.style.top=100-b+"%",this.wb.style.height=b+"%"):this.wb.style.width=b+"%"}};function Og(a,b){a==s&&l(Error("No valid parent element."));b==s&&l(Error("Invalid initial value."));Lg.call(this);this.f="progressbar";this.Va=a;this.$e="";this.Ud=this.Db=s;this.dc=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n";c+="  background: white;\n";c+="  padding: 1px;\n";c+="  overflow: hidden;\n";c+="  margin: 2px;\n";c+="  width: 100px;\n";c+="  height: 5px;\n";c+="}";var e;e=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n";
e+="  overflow: hidden;\n";e+="  width: 0%;\n";e+="  height: 100%;\n";e+="}";var d;d=".progress-bar-thumb-done {\n  background: #57E964;\n}";this.dc=[c,e,d];this.Od(b);this.yf()}D(Og,Lg);
Og.prototype.yf=function(){var a=ue(this.Va,"position");if("static"==a||""==a)this.$e=this.Va.style.position,this.Va.style.position="relative";var a=document.getElementsByTagName("head")[0],b=le("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.dc[0])),e=document.createTextNode(String(this.dc[1])),d=document.createTextNode(String(this.dc[2]));a.appendChild(b);b.appendChild(c);b.appendChild(e);b.appendChild(d);this.Db=b;this.bc(this.Va);a=this.s();a.style.position=
"absolute";a.style.top=(this.Va.clientHeight-5)/2+"px";a.style.left=(this.Va.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function Pg(a){var b=a.s().style.top,c=a.s().style.left;oe(a.s());var e=new Og(a.Va,100),d=e.s();d.style.position="absolute";d.style.top=b;d.style.left=c;d.classList.add("xtk-progress-bar");(d.firstElementChild!=p?d.firstElementChild:pe(d.firstChild)).classList.add("progress-bar-thumb-done");a.Ud=e}
Og.prototype.Ed=function(){this.Db&&oe(this.Db);this.s()&&oe(this.s());this.Ud&&oe(this.Ud.s());this.Ud=this.Db=s;this.$e&&(this.Va.style.position=this.$e)};function Qg(a,b,c){pa(a)?c&&(a=va(a,c)):a&&"function"==typeof a.handleEvent?a=va(a.handleEvent,a):l(Error("Invalid listener argument"));return 2147483647<b?-1:ga.setTimeout(a,b||0)};function Rg(){R.call(this);this.f="renderer";this.u=window.document.body;this.J=this.u.clientWidth;this.w=this.u.clientHeight;this.T=this.M=this.qa=s;this.tb=new xg(Gd);this.jb=[];this.Z=s;this.be=this.cd=this.$d=t;this.a=this.Ub=this.Ia=s;this.S={PROGRESSBAR_ENABLED:q,INTERMEDIATE_RENDERING:t,SLICENAVIGATORS:q};this.Ne=-1;window.console.log("XTK release 10 -- 2014-11-03 16:37:18 -- http://www.goXTK.com -- @goXTK")}D(Rg,R);w=Rg.prototype;
w.If=function(){window.cancelAnimationFrame(this.Ne);this.S.PROGRESSBAR_ENABLED&&(this.Ub=new Og(this.u,3))};w.Jf=function(){this.S.PROGRESSBAR_ENABLED&&this.Ub&&(Pg(this.Ub),this.Rd=Qg(function(){this.Rd=s;this.Ub&&(this.Ub.Ed(),this.Ub=s);this.cd=this.be=q;this.bc()}.bind(this),700))};w.Kf=function(a){this.Ub&&this.Ub.Od(100*a.xd)};w.fk=function(a){this.Ia&&this.Ia.Od(100*a.xd)};w.Wj=function(a){a!=s&&a instanceof Ed&&a.D&&this.xb(a.D)};w.gk=function(a){a!=s&&a instanceof Fd&&a.D&&this.remove(a.D)};
w.Mf=function(a){(a==s||!(a instanceof Qd))&&l(Error("Invalid hover event."))};w.Nf=function(){var a=je(document,this.u);this.J=a.clientWidth;this.w=a.clientHeight;a=je(document,this.qa);a.width=this.J;a.height=this.w;"renderer3D"==this.f&&(this.a.viewport(0,0,this.J,this.w),this.M.af=I.g.Cf(I.g.Dd(),this.M.mg,this.qa.width/this.qa.height,1,1E4))};w.Of=function(a){(a==s||!(a instanceof Pd))&&l(Error("Invalid scroll event."))};Rg.prototype.__defineGetter__("config",v("S"));
Rg.prototype.__defineGetter__("interactor",v("T"));Rg.prototype.__defineGetter__("camera",v("M"));Rg.prototype.__defineGetter__("loadingCompleted",v("cd"));Rg.prototype.__defineGetter__("container",v("u"));Rg.prototype.__defineSetter__("container",function(a){a==s&&l(Error("An ID to a valid container (<div>..) is required."));var b=a;na(b)&&(b=je(document,a));qa(b)&&1==b.nodeType||l(Error("Could not find the given container."));this.u=b});w=Rg.prototype;w.Nd=function(){this.M.reset()};
w.Xa=function(a){var b=le("canvas");this.u.appendChild(b);this.J=this.u.clientWidth;this.w=this.u.clientHeight;b.width=this.J;b.height=this.w;try{var c=b.getContext(a);c||l(Error())}catch(e){var d="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.u.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+d+"</p>";
l(Error(d))}this.Z=new ng;P(this.Z,"j",this.fk.bind(this));this.qa=b;this.a=c;b=new Re(this.qa);"2d"==a&&(b=new Te(this.qa));b.Xa();P(b,"f",this.Nd.bind(this));P(b,"k",this.Mf.bind(this));P(b,"d",this.Of.bind(this));this.T=b;b=new Ve(this.J,this.w);"2d"==a&&(b=new jf(this.J,this.w));b.observe(this.T);this.M=b;P(window,"resize",this.Nf,t,this)};w.add=function(a){(a instanceof wg||a instanceof ug||a instanceof sg)&&a.q();this.jb.push(a);this.xb(a)};
w.remove=function(a){(!this.qa||!this.a)&&l(Error("The renderer was not initialized properly."));if(a!=s&&a)if(gb(a))!a.ub||a.ub.Md(p);else if(a=tc(a)){var b=0,c;for(c in a.oa)for(var e=a.oa[c].concat(),d=0;d<e.length;++d)xc(e[d])&&++b}return t};
w.xb=function(a){(!this.qa||!this.a)&&l(Error("The renderer was not initialized properly."));a!=s&&(yc(a,"h")||P(a,"h",this.Wj.bind(this)),yc(a,"i")||P(a,"i",this.gk.bind(this)),yc(a,"m")||P(a,"m",this.If.bind(this)),yc(a,"o")||P(a,"o",this.Kf.bind(this)),yc(a,"n")||P(a,"n",this.Jf.bind(this)))};w.get=function(a){a==s&&l(Error("Invalid object id."));for(var b=this.tb.H,c=b.length,e=0,e=0;e<c;e++)if(b[e].wa==a)return b[e];return s};
w.bc=function(){(!this.qa||!this.a)&&l(Error("The renderer was not initialized properly."));if(this.Bg==s){if(Vc(this.Z.Hc)){if(this.S.PROGRESSBAR_ENABLED&&!this.Ia&&(this.Ia=new Og(this.u,3)),this.be=this.cd=t,this.Bg=Qg(function(){this.Bg=s;this.bc()}.bind(this),100),!this.S.INTERMEDIATE_RENDERING)return}else if(!this.cd&&!this.be&&(this.be=q,eval("this.onShowtime()"),this.cd=q),this.Ia){this.S.PROGRESSBAR_ENABLED&&(this.Ia&&!this.Rd)&&(Pg(this.Ia),this.Rd=Qg(function(){this.Rd=s;this.Ia&&(this.Ia.Ed(),
this.Ia=s);this.bc()}.bind(this),700));return}this.Ne=window.requestAnimationFrame(this.bc.bind(this));eval("this.onRender()");this.cc(t,q);eval("this.afterRender()")}};w.th=aa();w.rh=aa();w.Hg=aa();w.cc=aa();
w.le=function(){window.cancelAnimationFrame(this.Ne);this.Z&&(delete this.Z,this.Z=s);this.Ia&&(this.Ia.Ed(),delete this.Ia,this.Ia=s);this.tb.clear();delete this.tb;this.jb.length=0;delete this.jb;delete this.Z;this.Z=s;delete this.M;this.M=s;delete this.T;this.T=s;delete this.a;this.a=s;oe(this.qa);delete this.qa;this.qa=s};function Sg(a,b,c,e,d,f,g,h){var m,j;if(m=c.offsetParent){var k="HTML"==m.tagName||"BODY"==m.tagName;if(!k||"static"!=ve(m,"position"))j=Ae(m),k||(k=(k=Be(m))&&Tb?-m.scrollLeft:k&&(!M||!ec("8"))&&"visible"!=ve(m,"overflowX")?m.scrollWidth-m.clientWidth-m.scrollLeft:m.scrollLeft,j=Zd(j,new Yd(k,m.scrollTop)))}m=j||new Yd;j=Ae(a);k=Fe(a);j=new be(j.x,j.y,k.width,k.height);(k=ze(a))&&j.bh(new be(k.left,k.top,k.right-k.left,k.bottom-k.top));var k=ge(a),n=ge(c);if(k.ga!=n.ga){var u=k.ga.body,n=n.ga.parentWindow||
n.ga.defaultView,r=new Yd(0,0),y=ie(u)?ie(u).parentWindow||ie(u).defaultView:window,z=u;do{var F=y==n?Ae(z):Ce(z);r.x+=F.x;r.y+=F.y}while(y&&y!=n&&(z=y.frameElement)&&(y=y.parent));u=Zd(r,Ae(u));M&&!re(k)&&(u=Zd(u,se(k)));j.left+=u.x;j.top+=u.y}a=(b&4&&Be(a)?b^2:b)&-5;b=new Yd(a&2?j.left+j.width:j.left,a&1?j.top+j.height:j.top);b=Zd(b,m);d&&(b.x+=(a&2?-1:1)*d.x,b.y+=(a&1?-1:1)*d.y);var H;if(g&&(H=ze(c)))H.top-=m.y,H.right-=m.x,H.bottom-=m.y,H.left-=m.x;return Tg(b,c,e,f,H,g,h)}
function Tg(a,b,c,e,d,f,g){a=a.l();var h=0,m=(c&4&&Be(b)?c^2:c)&-5;c=Fe(b);g=g?g.l():c.l();if(e||0!=m)m&2?a.x-=g.width+(e?e.right:0):e&&(a.x+=e.left),m&1?a.y-=g.height+(e?e.bottom:0):e&&(a.y+=e.top);if(f){if(d){h=a;e=0;if(65==(f&65)&&(h.x<d.left||h.x>=d.right))f&=-2;if(132==(f&132)&&(h.y<d.top||h.y>=d.bottom))f&=-5;h.x<d.left&&f&1&&(h.x=d.left,e|=1);h.x<d.left&&(h.x+g.width>d.right&&f&16)&&(g.width=Math.max(g.width-(h.x+g.width-d.right),0),e|=4);h.x+g.width>d.right&&f&1&&(h.x=Math.max(d.right-g.width,
d.left),e|=1);f&2&&(e|=(h.x<d.left?16:0)|(h.x+g.width>d.right?32:0));h.y<d.top&&f&4&&(h.y=d.top,e|=2);h.y<=d.top&&(h.y+g.height<d.bottom&&f&32)&&(g.height=Math.max(g.height-(d.top-h.y),0),h.y=d.top,e|=8);h.y>=d.top&&(h.y+g.height>d.bottom&&f&32)&&(g.height=Math.max(g.height-(h.y+g.height-d.bottom),0),e|=8);h.y+g.height>d.bottom&&f&4&&(h.y=Math.max(d.bottom-g.height,d.top),e|=2);f&8&&(e|=(h.y<d.top?64:0)|(h.y+g.height>d.bottom?128:0));h=e}else h=256;if(h&496)return h}f=a;d=Tb&&(Yb||ac)&&ec("1.9");
f instanceof Yd?(a=f.x,f=f.y):(a=f,f=p);b.style.left=Ee(a,d);b.style.top=Ee(f,d);if(!(c==g||(!c||!g?0:c.width==g.width&&c.height==g.height)))a=re(ge(ie(b))),M&&(!a||!ec("8"))?(c=b.style,a?(M?(a=Je(b,"paddingLeft"),d=Je(b,"paddingRight"),f=Je(b,"paddingTop"),e=Je(b,"paddingBottom"),a=new $d(f,d,e,a)):(a=ue(b,"paddingLeft"),d=ue(b,"paddingRight"),f=ue(b,"paddingTop"),e=ue(b,"paddingBottom"),a=new $d(parseFloat(f),parseFloat(d),parseFloat(e),parseFloat(a))),M&&!(M&&9<=gc)?(d=Le(b,"borderLeft"),f=Le(b,
"borderRight"),e=Le(b,"borderTop"),b=Le(b,"borderBottom"),b=new $d(e,f,b,d)):(d=ue(b,"borderLeftWidth"),f=ue(b,"borderRightWidth"),e=ue(b,"borderTopWidth"),b=ue(b,"borderBottomWidth"),b=new $d(parseFloat(e),parseFloat(f),parseFloat(b),parseFloat(d))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Tb?b.MozBoxSizing="border-box":Ub?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",
b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px");return h};function Ug(){}Ug.prototype.ob=aa();function Vg(a,b){this.tf=a instanceof Yd?a:new Yd(a,b)}D(Vg,Ug);Vg.prototype.ob=function(a,b,c,e){Sg(we(a),0,a,b,this.tf,c,s,e)};function Wg(a,b,c){this.element=a;this.Og=b;this.vk=c}D(Wg,Ug);Wg.prototype.ob=function(a,b,c){Sg(this.element,this.Og,a,b,p,c,this.vk)};function Xg(a,b){Cc.call(this);this.mb=new Ag(this);this.Uf(a||s);b&&(this.Yc=b)}D(Xg,Cc);w=Xg.prototype;w.G=s;w.Ei=q;w.Di=s;w.Ig=s;w.Ja=t;w.Hk=t;w.Af=-1;w.eh=-1;w.pj=t;w.Wi=q;w.Yc="toggle_display";w.s=v("G");w.Uf=function(a){this.Ja&&l(Error("Can not change this state of the popup while showing."));this.G=a};
function Yg(a,b){a.Ie&&a.Ie.stop();a.xe&&a.xe.stop();if(b){if(!a.Ja&&a.Hf()){a.G||l(Error("Caller must call setElement before trying to show the popup"));a.ob();var c=ie(a.G);a.pj&&a.mb.pc(c,"keydown",a.Uj,q);if(a.Ei)if(a.mb.pc(c,"mousedown",a.ph,q),M){var e;try{e=c.activeElement}catch(d){}for(;e&&"IFRAME"==e.nodeName;){try{var f=e.contentDocument||e.contentWindow.document}catch(g){break}c=f;e=c.activeElement}a.mb.pc(c,"mousedown",a.ph,q);a.mb.pc(c,"deactivate",a.oh)}else a.mb.pc(c,"blur",a.oh);"toggle_display"==
a.Yc?(a.G.style.visibility="visible",He(a.G,q)):"move_offscreen"==a.Yc&&a.ob();a.Ja=q;a.Af=xa();a.eh=-1;a.Ie?(vc(a.Ie,"end",a.sh,t,a),a.Ie.play()):a.sh()}}else Zg(a)}w.ob=ia;function Zg(a,b){if(!a.Ja||!a.dispatchEvent({type:"beforehide",target:b}))return t;a.mb&&a.mb.Md();a.Ja=t;a.eh=xa();a.xe?(vc(a.xe,"end",wa(a.Ng,b),t,a),a.xe.play()):a.Ng(b);return q}w.Ng=function(a){"toggle_display"==this.Yc?this.Hk?Qg(this.Xg,0,this):this.Xg():"move_offscreen"==this.Yc&&(this.G.style.top="-10000px");this.Lf(a)};
w.Xg=function(){this.G.style.visibility="hidden";He(this.G,t)};w.Hf=function(){return this.dispatchEvent("beforeshow")};w.sh=function(){this.dispatchEvent("show")};w.Lf=function(a){this.dispatchEvent({type:"hide",target:a})};w.ph=function(a){var b=a.target;if(a=!qe(this.G,b))a=!zb(this.Di||[],function(a){return b===a||qe(a,b)})&&(this.Ig?qe(this.Ig,b):q)&&!(150>xa()-this.Af);a&&Zg(this,b)};w.Uj=function(a){27==a.keyCode&&Zg(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
w.oh=function(a){if(this.Wi){var b=ie(this.G);if("undefined"!=typeof document.activeElement){if(a=b.activeElement,!a||qe(this.G,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>xa()-this.Af||Zg(this)}};x("goog.i18n.bidi.FORCE_RTL",t);pb("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));function $g(){this.Sf="";this.fi=ah;this.Qg=s}$g.prototype.uj=q;$g.prototype.vj=q;pb("action","cite","data","formaction","href","manifest","poster","src");pb("link","script","style");var ah={};function bh(a,b){var c=new $g;c.Sf=a;c.Qg=b;return c}var ch=s;"".uj&&(ch="".Qg);bh(Sa("".vj?"".Sf:""),ch);function dh(a,b){this.zk=4;this.Ae=b||p;Xg.call(this,a)}D(dh,Xg);dh.prototype.ob=function(){if(this.Ae){var a=!this.Ja&&"move_offscreen"!=this.Yc,b=this.s();a&&(b.style.visibility="hidden",He(b,q));this.Ae.ob(b,this.zk,this.tm);a&&He(b,t)}};var eh={};x("goog.html.legacyconversions.ALLOW_LEGACY_CONVERSIONS",q);function fh(a){if("function"==typeof a.Cd)return a.Cd();if(na(a))return a.split("");if(ma(a)){for(var b=[],c=a.length,e=0;e<c;e++)b.push(a[e]);return b}return lb(a)};function gh(a){this.ha=new Sc;a&&this.kf(a)}function hh(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+(a[ra]||(a[ra]=++sa)):b.substr(0,1)+a}w=gh.prototype;w.qe=function(){return this.ha.qe()};w.add=function(a){this.ha.set(hh(a),a)};w.kf=function(a){a=fh(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};w.Md=function(a){a=fh(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};w.remove=function(a){return this.ha.remove(hh(a))};w.clear=function(){this.ha.clear()};
w.contains=function(a){a=hh(a);return Wc(this.ha.ha,a)};w.bh=function(a){var b=new gh;a=fh(a);for(var c=0;c<a.length;c++){var e=a[c];this.contains(e)&&b.add(e)}return b};w.Cd=function(){return this.ha.Cd()};w.l=function(){return new gh(this)};function ih(a,b,c){this.$b=c||(a?ge(je(document,a)):ge());dh.call(this,this.$b.Tc("div",{style:"position:absolute;display:none;"}));this.uf=new Yd(1,1);this.me=new gh;a&&jh(this,a);if(b!=s)if(a=this.s(),"textContent"in a)a.textContent=b;else if(3==a.nodeType)a.data=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(ie(a).createTextNode(String(b)))}}D(ih,dh);
var kh=[];w=ih.prototype;w.Oa=s;w.className="goog-tooltip";w.Gh=500;w.oj=0;w.re=v("$b");function jh(a,b){b=je(document,b);a.me.add(b);P(b,"mouseover",a.nj,t,a);P(b,"mouseout",a.Ug,t,a);P(b,"mousemove",a.mj,t,a);P(b,"focus",a.lj,t,a);P(b,"blur",a.Ug,t,a)}w.Uf=function(a){var b=this.s();b&&oe(b);ih.A.Uf.call(this,a);a&&(b=this.$b.ga.body,b.insertBefore(a,b.lastChild))};
w.Hf=function(){if(!Xg.prototype.Hf.call(this))return t;if(this.anchor)for(var a,b=0;a=kh[b];b++)qe(a.s(),this.anchor)||Yg(a,t);0<=wb(kh,this)||kh.push(this);a=this.s();a.className=this.className;lh(this);P(a,"mouseover",this.Wg,t,this);P(a,"mouseout",this.Vg,t,this);mh(this);return q};
w.Lf=function(){Ab(kh,this);for(var a=this.s(),b,c=0;b=kh[c];c++)b.anchor&&qe(a,b.anchor)&&Yg(b,t);this.vh&&nh(this.vh);wc(a,"mouseover",this.Wg,t,this);wc(a,"mouseout",this.Vg,t,this);this.anchor=p;if(0==(this.Ib?this.Ja?4:1:this.Vc?3:this.Ja?2:0))this.Fe=t;Xg.prototype.Lf.call(this)};w.jh=function(a,b){this.anchor==a&&this.me.contains(this.anchor)&&(this.Fe||!this.Em?(Yg(this,t),this.Ja||(this.anchor=a,this.Ae=b||oh(this,0)||p,this.Ja&&this.ob(),Yg(this,q))):this.anchor=p);this.Ib=p};
w.Lj=function(a){this.Vc=p;a==this.anchor&&(this.Oa==s||this.Oa!=this.s()&&!this.me.contains(this.Oa))&&(!this.Kg||!this.Kg.Oa)&&Yg(this,t)};function ph(a,b){var c=se(a.$b);a.uf.x=b.clientX+c.x;a.uf.y=b.clientY+c.y}w.nj=function(a){var b=qh(this,a.target);this.Oa=b;lh(this);b!=this.anchor&&(this.anchor=b,this.Ib||(this.Ib=Qg(va(this.jh,this,b,p),this.Gh)),rh(this),ph(this,a))};function qh(a,b){try{for(;b&&!a.me.contains(b);)b=b.parentNode;return b}catch(c){return s}}
w.mj=function(a){ph(this,a);this.Fe=q};w.lj=function(a){this.Oa=a=qh(this,a.target);this.Fe=q;if(this.anchor!=a){this.anchor=a;var b=oh(this,1);lh(this);this.Ib||(this.Ib=Qg(va(this.jh,this,a,b),this.Gh));rh(this)}};function oh(a,b){if(0==b){var c=a.uf.l();return new sh(c)}return new th(a.Oa)}function rh(a){if(a.anchor)for(var b,c=0;b=kh[c];c++)qe(b.s(),a.anchor)&&(b.Kg=a,a.vh=b)}
w.Ug=function(a){var b=qh(this,a.target),c=qh(this,a.relatedTarget);b!=c&&(b==this.Oa&&(this.Oa=s),mh(this),this.Fe=t,this.Ja&&(!a.relatedTarget||!qe(this.s(),a.relatedTarget))?nh(this):this.anchor=p)};w.Wg=function(){var a=this.s();this.Oa!=a&&(lh(this),this.Oa=a)};w.Vg=function(a){var b=this.s();if(this.Oa==b&&(!a.relatedTarget||!qe(b,a.relatedTarget)))this.Oa=s,nh(this)};function mh(a){a.Ib&&(ga.clearTimeout(a.Ib),a.Ib=p)}
function nh(a){if(2==(a.Ib?a.Ja?4:1:a.Vc?3:a.Ja?2:0))a.Vc=Qg(va(a.Lj,a,a.anchor),a.oj)}function lh(a){a.Vc&&(ga.clearTimeout(a.Vc),a.Vc=p)}function sh(a,b){Vg.call(this,a,b)}D(sh,Vg);sh.prototype.ob=function(a,b,c){b=we(a);b=ze(b);c=c?new $d(c.top+10,c.right,c.bottom,c.left+10):new $d(10,0,0,10);Tg(this.tf,a,4,c,b,9)&496&&Tg(this.tf,a,4,c,b,5)};function th(a){Wg.call(this,a,3)}D(th,Wg);
th.prototype.ob=function(a,b,c){var e=new Yd(10,0);Sg(this.element,this.Og,a,b,e,c,9)&496&&Sg(this.element,2,a,1,e,c,5)};function uh(a,b,c,e){a==s&&l(Error("No valid parent element."));(!A(b)||!A(c))&&l(Error("Invalid coordinates."));(e==s||!(e instanceof Pe))&&l(Error("Invalid interactor."));ih.call(this);this.f="caption";this.Va=a;this.he=b;this.ie=c;this.T=e;this.Db=s;this.dc=[];a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n";a+="  border: 1px solid infotext;\n";a+="  padding: 1px;\n";a+="  font-family: sans-serif;\n";a+="}";this.dc=[a];vc(e,"l",this.Ed.bind(this));this.yf()}D(uh,ih);
uh.prototype.yf=function(){var a=ue(this.Va,"position");if("static"==a||""==a)this.Va.style.position="relative";var a=document.getElementsByTagName("head")[0],b=le("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.dc[0]));a.appendChild(b);b.appendChild(c);this.Db=b;this.Ae=new Vg(this.he,this.ie)||p;this.Ja&&this.ob();Yg(this,q);jh(this,this.Va);this.s().classList.add("x-tooltip")};
uh.prototype.Ed=function(){Yg(this,t);this.Db&&oe(this.Db);this.s()&&oe(this.s());this.Db=s};function vh(){Rg.call(this);this.f="renderer3D";this.gd=this.kd=this.fd=this.jd=this.ed=this.hd=this.df=this.ef=s;this.B=[0,0,0];this.Zc=[0,0,0];this.zg=s;this.Pe=new Sc;this.ud=new Sc;this.ic=new Sc;this.ld=new Sc;this.Ac=new Sc;this.Kc=new Sc;this.hc=new Sc;this.Rc=new Sc;this.S={PROGRESSBAR_ENABLED:q,PICKING_ENABLED:q,ORDERING_ENABLED:q,STATISTICS_ENABLED:t,INTERMEDIATE_RENDERING:t}}D(vh,Rg);vh.prototype.__defineGetter__("config",v("S"));w=vh.prototype;
w.Bk=function(){this.gd=this.kd=this.fd=this.jd=this.ed=this.hd=s;this.B=[0,0,0]};
w.Mf=function(a){vh.A.Mf.call(this,a);var b=a.he;a=a.ie;var c=this.Rf(b,a);if(c=this.get(c))if(c=c.zc){var e;e=this.u;if(1==e.nodeType)e=Ce(e);else{var d=pa(e.fj),f=e;e.targetTouches?f=e.targetTouches[0]:d&&e.lb.targetTouches&&(f=e.lb.targetTouches[0]);e=new Yd(f.clientX,f.clientY)}b=new uh(this.u,e.x+b+10,e.y+a+10,this.T);eh.al||l(Error("Error: Legacy conversion from string to goog.html types is disabled"));a=bh(c,s);if(b=b.s())a instanceof $g&&a.constructor===$g&&a.fi===ah?a=a.Sf:(cb("expected object of type SafeHtml, got '"+
a+"'"),a="type_error:SafeHtml"),b.innerHTML=a}};
w.Xa=function(){vh.A.Xa.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.J,this.w),this.a.clearColor(this.Zc[0],this.Zc[1],this.Zc[2],0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.S.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();
this.a.bindTexture(this.a.TEXTURE_2D,c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.J,this.w,0,this.a.RGB,this.a.UNSIGNED_BYTE,s);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST);this.a.bindFramebuffer(this.a.FRAMEBUFFER,
a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.J,this.w);this.a.bindRenderbuffer(this.a.RENDERBUFFER,s);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,s);this.zg=a}}catch(e){l(Error("Exception while accessing GL Context!\n"+e))}a=new kf;
this.Gg(a)};
w.Gg=function(a){(this.qa==s||this.a==s||this.M==s)&&l(Error("Renderer was not initialized properly."));(a==s||!(a instanceof kf))&&l(Error("Could not add shaders."));var b=Object.keys(mf);Object.keys(lf).every(function(a){a=lf[a];return-1!=this.yd.search(a)||-1!=this.Vd.search(a)}.bind(a))||l(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=mf[a];return-1!=this.yd.search(a)||-1!=this.Vd.search(a)}.bind(a))||l(Error("Could not find all uniforms in the shader sources."));var b=
this.a.createShader(this.a.FRAGMENT_SHADER),c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,a.Vd);this.a.shaderSource(c,a.yd);this.a.compileShader(b);this.a.compileShader(c);this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||l(Error("Fragement Shader compilation failed!\n"+this.a.getShaderInfoLog(b)));this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||l(Error("Vertex Shader compilation failed!\n"+this.a.getShaderInfoLog(c)));var e=this.a.createProgram();this.a.attachShader(e,c);
this.a.attachShader(e,b);this.a.linkProgram(e);this.a.getProgramParameter(e,this.a.LINK_STATUS)||l(Error("Could not create shader program!\n"+this.a.getShaderInfoLog(b)+"\n"+this.a.getShaderInfoLog(c)+"\n"+this.a.getProgramInfoLog(e)));this.a.useProgram(e);this.df=e;Object.keys(lf).forEach(function(a){a=lf[a];this.Pe.set(a,this.a.getAttribLocation(this.df,a));this.a.enableVertexAttribArray(this.Pe.get(a))}.bind(this));Object.keys(mf).forEach(function(a){a=mf[a];this.ud.set(a,this.a.getUniformLocation(this.df,
a))}.bind(this));this.ef=a};
w.xb=function(a){vh.A.xb.call(this,a);var b=t;if(a!=s){this.get(a.wa)&&(b=q);var c=a.wa,e=a.h,d=a.n,f=a.na,g=a.F,h=a.r,m=a.ka,j=a.Ba,k=a.e,n=a.I;if(k!=s&&k.r!=s&&k.r.j)this.xb(k);else if(k!=s&&k.j&&this.xb(k),j!=s&&j.r!=s&&j.r.j)this.Z.load(j,a);else if(g!=s&&g.r!=s&&g.r.j)this.Z.load(g,a);else{if(h!=s&&ka(h))if(a.tc!=s){if(a.tc.Bf!=h.length||!a.j)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.Z.load(h[b],a);return}else{if(h!=s&&h.j){this.Z.load(a,a);return}if(n!=s&&n.r!=s&&n.r.j){this.Z.load(n,
a);return}}if(0<a.c.length){h=a.c;j=h.length;for(k=k=0;k<j;k++)this.xb(h[k])}if(e){for(h=0;this.$d;)h++,window.console.log("Possible thread lock avoided: "+h);this.$d=q;j=a instanceof ef&&a.Eb instanceof of;b&&(g!=s&&g.j)&&(h=this.hc.get(c),h!=s&&this.a.isBuffer(h.Q)&&this.a.deleteBuffer(h.Q));h=s;g!=s&&(!b||g.j?(h=a.Qc,h==s&&l(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),k=t,g.Vb&&(k=q),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,k),
k=this.a.createTexture(),k.sj=g.qb,this.Rc.set(g.wa,k),this.a.bindTexture(this.a.TEXTURE_2D,k),g.Vb?(k=this.a.RGBA,g.pg&&(k=this.a.LUMINANCE,this.a.pixelStorei(this.a.UNPACK_ALIGNMENT,1)),this.a.texImage2D(this.a.TEXTURE_2D,0,k,g.cf,g.bf,0,k,this.a.UNSIGNED_BYTE,g.Vb)):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,k.sj),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,
this.a.CLAMP_TO_EDGE),j?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,s),k=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),
this.a.STATIC_DRAW),h=new Xd(k,h.length,2),this.hc.set(c,h),g.j=t):h=this.hc.get(c));og(this.Z,0.1);if(j)this.$d=t,I.za(this.f+".update"),og(this.Z,0.9);else{if(!b||e.j||m.j){j=m.R;g=I.g.$(j,e.fb,e.gb,e.hb);j=I.g.$(j,e.bb,e.cb,e.eb);if(this.hd===s||g.x<this.hd)this.hd=g.x;if(this.ed===s||j.x>this.ed)this.ed=j.x;if(this.jd===s||g.y<this.jd)this.jd=g.y;if(this.fd===s||j.y>this.fd)this.fd=j.y;if(this.kd===s||g.d<this.kd)this.kd=g.d;if(this.gd===s||j.d>this.gd)this.gd=j.d;this.B=[(this.hd+this.ed)/2,
(this.jd+this.fd)/2,(this.kd+this.gd)/2];m.j=t}b&&e.j&&(m=this.ic.get(c),m!=s&&this.a.isBuffer(m.Q)&&this.a.deleteBuffer(m.Q));m=s;!b||e.j?(m=this.a.createBuffer(),e.Hb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,m),this.a.bufferData(this.a.ARRAY_BUFFER,e.ca,this.a.STATIC_DRAW),m=new Xd(m,e.count,3),e.j=t):m=this.ic.get(c);og(this.Z,0.3);b&&d.j&&(g=this.ic.get(c),g!=s&&this.a.isBuffer(g.Q)&&this.a.deleteBuffer(g.Q));g=s;!b||d.j?(g=this.a.createBuffer(),d.Hb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),
this.a.bufferData(this.a.ARRAY_BUFFER,d.ca,this.a.STATIC_DRAW),g=new Xd(g,d.count,3),d.j=t):g=this.ld.get(c);og(this.Z,0.3);b&&(f&&f.j)&&(d=this.Ac.get(c),d!=s&&this.a.isBuffer(d.Q)&&this.a.deleteBuffer(d.Q));d=s;f&&(!b||f.j?(f.length!=e.length&&l(Error("Mismatch between points and point colors.")),d=this.a.createBuffer(),f.Hb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f.ca,this.a.STATIC_DRAW),d=new Xd(d,f.count,3),f.j=t):d=this.Ac.get(c));og(this.Z,0.2);b&&(n&&
n.j)&&(f=this.Kc.get(c),f!=s&&this.a.isBuffer(f.Q)&&this.a.deleteBuffer(f.Q));f=s;if(n)if(f=n.ad,!b||n.j){f.length!=e.length&&l(Error("Mismatch between points and scalars."));e=this.a.createBuffer();if(Infinity===n.min&&-Infinity===n.max){for(var j=Infinity,k=-Infinity,u=0,r=0;r<f.length;++r)u=f[r],isNaN(u)||(j=Math.min(j,u),k=Math.max(k,u));n.Ha=j;n.ba=k}this.a.bindBuffer(this.a.ARRAY_BUFFER,e);this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW);f=new Xd(e,f.length,3);n.j=t}else f=this.Kc.get(c);
og(this.Z,0.1);b||this.tb.add(a);this.ic.set(c,m);this.ld.set(c,g);this.Ac.set(c,d);this.hc.set(c,h);this.Kc.set(c,f);this.$d=a.j=t}}else a.j=t}}};w.Rf=function(a,b){if(this.S.PICKING_ENABLED){this.cc(q,t);var c=new Uint8Array(4);this.a.readPixels(a,this.w-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
w.cc=function(a,b){vh.A.cc.call(this,a,b);this.a.viewport(0,0,this.J,this.w);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var c=this.tb.H,e=c.length;if(0!=e){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.zg):this.a.bindFramebuffer(this.a.FRAMEBUFFER,s);var d=this.M.af,f=this.M.o;this.a.uniformMatrix4fv(this.ud.get("perspective"),t,d);this.a.uniformMatrix4fv(this.ud.get("view"),t,f);d=this.B;this.a.uniform3f(this.ud.get("center"),parseFloat(d[0]),parseFloat(d[1]),parseFloat(d[2]));
f=this.jb.length;for(d=0;d<f;++d){var g=this.jb[d];if(g instanceof S){var h=I.g.$(this.M.o,g.t[0]+g.b[0].i[0],g.t[1]+g.b[0].i[1],g.t[2]+g.b[0].i[2]),m=I.g.$(this.M.o,g.t[0]-g.b[0].i[0],g.t[1]-g.b[0].i[1],g.t[2]-g.b[0].i[2]),j=Math.abs(h.d-m.d),h=I.g.$(this.M.o,g.t[0]+g.b[1].i[0],g.t[1]+g.b[1].i[1],g.t[2]+g.b[1].i[2]),m=I.g.$(this.M.o,g.t[0]-g.b[1].i[0],g.t[1]-g.b[1].i[1],g.t[2]+-g.b[1].i[2]),k=Math.abs(h.d-m.d),h=I.g.$(this.M.o,g.t[0]+g.b[2].i[0],g.t[1]+g.b[2].i[1],g.t[2]+g.b[2].i[2]),m=I.g.$(this.M.o,
g.t[0]-g.b[2].i[0],g.t[1]-g.b[2].i[1],g.t[2]-g.b[2].i[2]),h=Math.max(j,k,Math.abs(h.d-m.d));h==j?nf(g,0):h==k?nf(g,1):nf(g,2)}}if(this.S.ORDERING_ENABLED){j=t;f=this.jb;g=f.length-1;do if(d=f[g],d instanceof S&&d.Na&&-1!=d.W){var j=d.c[d.W].c,k=d.W,h=I.g.$(this.M.o,d.t[0]+d.b[k].z[0],d.t[1]+d.b[k].z[1],d.t[2]+d.b[k].z[2]),m=I.g.$(this.M.o,d.t[0]-d.b[k].z[0],d.t[1]-d.b[k].z[1],d.t[2]-d.b[k].z[2]),h=h.d-m.d,m=Math.max(d.xc[d.W],Math.max(d.xc[d.W+4],d.xc[d.W+8])),n=Math.min(d.xc[d.W],Math.min(d.xc[d.W+
4],d.xc[d.W+8]));if(0>h*(m+n))for(h=h=0;h<d.pd[k]-1;h++)j[h]&&(j[h].sa=d.sa,j[h].va=d.b[k].Nc*h);else for(h=d.pd[k]-1;0<=h;h--)j[h]&&(j[h].sa=d.sa,j[h].va=(d.pd[k]-1)*d.b[k].Nc-d.b[k].Nc*h);j=q}while(g--);f=this.tb.H;g=f.length-1;do if(d=f[g],d.O&&!(1==d.sa||d instanceof ef))j=d,k=d.h.Sd,d=I.g.$(d.ka.R,k[0],k[1],k[2]),d=I.g.$(this.M.o,d.x,d.y,d.d),d=I.m.xf(this.M.fc,d),d=Math.round(1E3*d)/1E3,j.va=d,j=q;while(g--);j&&this.tb.sort()}if(f=!a&&b!=s&&b&&this.S.STATISTICS_ENABLED)var u=0,r=0,y=0,z=0;var d=
this.Pe,g=d.get("vertexPosition"),j=d.get("vertexNormal"),k=d.get("vertexColor"),h=d.get("vertexTexturePos"),m=d.get("vertexScalar"),d=this.ud,n=d.get("usePicking"),F=d.get("useObjectColor"),H=d.get("objectColor"),K=d.get("useScalars"),B=d.get("scalarsReplaceMode"),E=d.get("scalarsMin"),J=d.get("scalarsMax"),N=d.get("scalarsMinColor"),Q=d.get("scalarsMaxColor"),O=d.get("scalarsInterpolation"),T=d.get("scalarsMinThreshold"),da=d.get("scalarsMaxThreshold"),ea=d.get("objectOpacity"),L=d.get("labelmapOpacity"),
oa=d.get("labelmapColor"),G=d.get("useTexture"),Ma=d.get("useLabelMapTexture"),Fa=d.get("textureSampler"),tb=d.get("textureSampler2"),ub=d.get("volumeLowerThreshold"),vb=d.get("volumeUpperThreshold"),nb=d.get("volumeScalarMin"),ad=d.get("volumeScalarMax"),zh=d.get("volumeWindowLow"),Ah=d.get("volumeWindowHigh"),Bh=d.get("volumeScalarMinColor"),Ch=d.get("volumeScalarMaxColor"),Hg=d.get("volumeTexture"),Dh=d.get("objectTransform"),Eh=d.get("pointSize"),d=e;do{var fa=c[e-d];if(fa){var la=s;fa instanceof
ef&&fa.Eb&&(la=fa.Eb);if(fa.O&&(!la||la.O)&&(!a||fa.md)){var Ba=fa.wa,eb=fa.dd,Pa=this.ic.get(Ba),qb=this.ld.get(Ba),cf=this.Ac.get(Ba),Jb=this.Kc.get(Ba),df=this.hc.get(Ba);this.a.bindBuffer(this.a.ARRAY_BUFFER,Pa.Q);this.a.vertexAttribPointer(g,Pa.Nb,this.a.FLOAT,t,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,qb.Q);this.a.vertexAttribPointer(j,qb.Nb,this.a.FLOAT,t,0,0);a?this.a.uniform1i(n,q):this.a.uniform1i(n,t);cf&&!a&&!eb?(this.a.uniform1i(F,t),this.a.bindBuffer(this.a.ARRAY_BUFFER,cf.Q),this.a.vertexAttribPointer(k,
cf.Nb,this.a.FLOAT,t,0,0)):(qb=1,eb&&!a&&(qb=0),this.a.uniform1i(F,qb),qb=fa.v,a&&(qb=[Math.floor(Ba%65025%255)/255,Math.floor(Ba%65025/255)/255,Math.floor(Ba/65025)/255]),this.a.uniform3f(H,parseFloat(qb[0]),parseFloat(qb[1]),parseFloat(qb[2])),this.a.vertexAttribPointer(k,Pa.Nb,this.a.FLOAT,t,0,0));Jb&&!a&&!eb?(this.a.uniform1i(K,q),this.a.uniform1i(B,fa.I.Cg),Ba=fa.I.Qb,eb=fa.I.Ob,this.a.uniform3f(N,parseFloat(Ba[0]),parseFloat(Ba[1]),parseFloat(Ba[2])),this.a.uniform3f(Q,parseFloat(eb[0]),parseFloat(eb[1]),
parseFloat(eb[2])),this.a.uniform1f(T,parseFloat(fa.I.U)),this.a.uniform1f(da,parseFloat(fa.I.V)),this.a.uniform1f(E,parseFloat(fa.I.Ha)),this.a.uniform1f(J,parseFloat(fa.I.ba)),this.a.uniform1i(O,parseInt(fa.I.Re,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Jb.Q),this.a.vertexAttribPointer(m,Jb.Nb,this.a.FLOAT,t,0,0)):(this.a.uniform1i(K,t),this.a.vertexAttribPointer(m,Pa.Nb,this.a.FLOAT,t,0,0));this.a.uniform1f(ea,parseFloat(fa.sa));fa.F&&df&&!a?(this.a.uniform1i(G,q),this.a.activeTexture(this.a.TEXTURE0),
this.a.bindTexture(this.a.TEXTURE_2D,this.Rc.get(fa.F.wa)),this.a.uniform1i(Fa,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,df.Q),this.a.vertexAttribPointer(h,df.Nb,this.a.FLOAT,t,0,0),this.a.uniform1i(Hg,t)):(this.a.uniform1i(G,t),this.a.vertexAttribPointer(h,Pa.Nb,this.a.FLOAT,t,0,0));la&&(this.a.uniform1i(Hg,q),this.a.uniform1f(ub,la.U),this.a.uniform1f(vb,la.V),this.a.uniform1f(nb,la.Ha),this.a.uniform1f(ad,la.ba),Ba=la.Qb,eb=la.Ob,this.a.uniform3f(Bh,parseFloat(Ba[0]),parseFloat(Ba[1]),parseFloat(Ba[2])),
this.a.uniform3f(Ch,parseFloat(eb[0]),parseFloat(eb[1]),parseFloat(eb[2])),this.a.uniform1f(zh,la.fa),this.a.uniform1f(Ah,la.ea),Jb=la.e,this.a.uniform1i(Ma,t),la.Na?this.a.uniform1f(ea,parseFloat(la.sa)):Jb&&Jb.O&&(la=fa.e.wa,this.a.uniform1i(Ma,q),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.Rc.get(la)),this.a.uniform1i(tb,1),this.a.uniform1f(L,Jb.sa),this.a.uniform4fv(oa,Jb.ff)));this.a.uniformMatrix4fv(Dh,t,fa.ka.R);la=1;"POINTS"==fa.Ea&&(la=fa.nd);this.a.uniform1f(Eh,
la);la=-1;fa.Ea==Bd?(la=this.a.TRIANGLES,f&&(r+=Pa.Mb/3)):"LINES"==fa.Ea?(this.a.lineWidth(fa.Ic),la=this.a.LINES,f&&(y+=Pa.Mb/2)):"POINTS"==fa.Ea?(la=this.a.POINTS,f&&(z+=Pa.Mb)):"TRIANGLE_STRIPS"==fa.Ea?(la=this.a.TRIANGLE_STRIP,f&&(r+=Pa.Mb/3)):"POLYGONS"==fa.Ea&&(la=0==Pa.Mb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(r+=Pa.Mb/3));f&&(u+=Pa.Mb);this.a.drawArrays(la,0,Pa.Mb)}}}while(--d);f&&(c="Objects: "+e+" | "+("Vertices: "+u+" | "),c+="Triangles: "+Math.round(r)+" | ",c+="Lines: "+y+" | ",c+=
"Points: "+z+" | ",c+="Textures: "+this.Rc.qe(),window.console.log(c))}};
w.remove=function(a){vh.A.remove.call(this,a);if(0<a.c.length)for(var b=a.c,c=b.length,e=0,e=0;e<c;e++)this.remove(b[e]);b=a.wa;c=this.hc.get(b);c!=s&&this.a.isBuffer(c.Q)&&this.a.deleteBuffer(c.Q);if(a.F&&(c=this.Rc.get(a.F.wa)))this.a.deleteTexture(c),this.Rc.remove(a.F.wa);c=this.ic.get(b);c!=s&&this.a.isBuffer(c.Q)&&this.a.deleteBuffer(c.Q);c=this.ld.get(b);c!=s&&this.a.isBuffer(c.Q)&&this.a.deleteBuffer(c.Q);c=this.Ac.get(b);c!=s&&this.a.isBuffer(c.Q)&&this.a.deleteBuffer(c.Q);c=this.Kc.get(b);
c!=s&&this.a.isBuffer(c.Q)&&this.a.deleteBuffer(c.Q);this.ic.remove(b);this.ld.remove(b);this.Ac.remove(b);this.hc.remove(b);this.Kc.remove(b);this.tb.remove(a);return q};w.le=function(){this.ef=s;delete this.ef;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);vh.A.le.call(this)};vh.prototype.__defineGetter__("bgColor",v("Zc"));vh.prototype.__defineSetter__("bgColor",ba("Zc"));
vh.prototype.xk=function(a,b,c,e,d){c!=s||(c=4);e!=s||(e=2);if(d==s){d=this.Rf(a,b);if(-1==d)return s;d=this.get(d);if(!d)return s}var f=We(this.M,2*(a/this.J)-1,2*((this.w-b)/this.w)-1,0);a=We(this.M,2*(a/this.J)-1,2*((this.w-b)/this.w)-1,1);f[0]+=this.B[0];f[1]+=this.B[1];f[2]+=this.B[2];a[0]+=this.B[0];a[1]+=this.B[1];a[2]+=this.B[2];b=[d.h.fb,d.h.gb,d.h.hb];var g=[d.h.bb,d.h.gb,d.h.hb],h=[d.h.bb,d.h.cb,d.h.hb],m=[d.h.fb,d.h.cb,d.h.hb],j=[d.h.fb,d.h.cb,d.h.eb],k=[d.h.fb,d.h.gb,d.h.eb],n=[d.h.bb,
d.h.cb,d.h.eb],u=[d.h.bb,d.h.gb,d.h.eb];b=[I.g.$(d.ka.R,b[0],b[1],b[2]),I.g.$(d.ka.R,g[0],g[1],g[2]),I.g.$(d.ka.R,h[0],h[1],h[2]),I.g.$(d.ka.R,m[0],m[1],m[2]),I.g.$(d.ka.R,j[0],j[1],j[2]),I.g.$(d.ka.R,k[0],k[1],k[2]),I.g.$(d.ka.R,n[0],n[1],n[2]),I.g.$(d.ka.R,u[0],u[1],u[2])];var g=[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity],r;for(r in b)r=b[r],g=[Math.min(g[0],r.x),Math.max(g[1],r.x),Math.min(g[2],r.y),Math.max(g[3],r.y),Math.min(g[4],r.d),Math.max(g[5],r.d)];r=g;b=[];g=[];for(h=0;6>
h;h++){var m=Math.floor(h/2),j=(m+1)%3,k=(m+2)%3,u=(2+2*m)%6,y=(4+2*m)%6,z=(r[h]-f[m])*(1/a[m]);Infinity!=z&&-Infinity!=z&&(n=f[j]+a[j]*z,z=f[k]+a[k]*z,n>=r[u]&&n<=r[u+1]&&z>=r[y]&&z<=r[y+1]?(u=[],u[m]=r[h],u[j]=n,u[k]=z,b.push(u)):(u=[],u[m]=r[h],u[j]=n,u[k]=z,g.push(u)))}a=[b,g];a=a[0];if(0==a.length)return s;g=Array(2);for(r=0;2>r;r++)b=a[r],g[r]=Math.sqrt((b[0]-f[0])*(b[0]-f[0])+(b[1]-f[1])*(b[1]-f[1])+(b[2]-f[2])*(b[2]-f[2]));f=b=r=s;g[0]<g[1]?(r=a[0],b=a[1]):(r=a[1],b=a[0]);f=Math.sqrt((r[0]-
b[0])*(r[0]-b[0])+(r[1]-b[1])*(r[1]-b[1])+(r[2]-b[2])*(r[2]-b[2]));f/=c;a=r;r=[b[0]-r[0],b[1]-r[1],b[2]-r[2]];b=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);g=[r[0]/b,r[1]/b,r[2]/b];h=d.h.ca;m=h.length;for(r=0;r<f;r+=c){a=[a[0]+c*g[0],a[1]+c*g[1],a[2]+c*g[2]];for(b=0;b<m;b+=3)if(j=h[b],k=h[b+1],n=h[b+2],u=new I.m(j,k,n),u=I.g.$(d.ka.R,j,k,n),Math.sqrt((a[0]-u.x)*(a[0]-u.x)+(a[1]-u.y)*(a[1]-u.y)+(a[2]-u.d)*(a[2]-u.d))<=e)return[u.x,u.y,u.d]}return s};C("X.renderer3D",vh);
C("X.renderer3D.prototype.init",vh.prototype.Xa);C("X.renderer3D.prototype.add",vh.prototype.add);C("X.renderer3D.prototype.onShowtime",vh.prototype.th);C("X.renderer3D.prototype.onRender",vh.prototype.rh);C("X.renderer3D.prototype.get",vh.prototype.get);C("X.renderer3D.prototype.render",vh.prototype.bc);C("X.renderer3D.prototype.destroy",vh.prototype.le);C("X.renderer3D.prototype.remove",vh.prototype.remove);C("X.renderer3D.prototype.resetBoundingBox",vh.prototype.Bk);
C("X.renderer3D.prototype.resetViewAndRender",vh.prototype.Nd);C("X.renderer3D.prototype.pick",vh.prototype.Rf);C("X.renderer3D.prototype.pick3d",vh.prototype.xk);C("X.renderer3D.prototype.afterRender",vh.prototype.Hg);C("X.renderer3D.prototype.addShaders",vh.prototype.Gg);function wh(){Y.call(this);this.f="mesh";Ga(this,new Rc)}D(wh,Y);C("X.mesh",wh);function xh(){Y.call(this);this.f="fibers";Ga(this,new Rc)}D(xh,Y);C("X.fibers",xh);function yh(){Rg.call(this);this.f="renderer2D";this.Ma=s;this.Ca=-1;this.Rb=[];this.sg=this.Yd=this.ng=this.Wd=s;this.Mc=this.Pc=this.Lc=this.Oc=0;this.ea=this.fa=this.V=this.U=this.kg=-1;this.tg=new Float32Array([-255,-255,-255,-255]);this.Ag=q;this.ib=1}D(yh,Rg);yh.prototype.ik=aa();yh.prototype.sk=aa();yh.prototype.Of=function(a){yh.A.Of.call(this,a);var b=this.jb[0];if(b){var c="",c=0==this.Ca?"indexX":1==this.Ca?"indexY":"indexZ";b[c]=a.da?b[c]+1:b[c]-1;eval("this.onScroll();")}};
yh.prototype.tk=function(a){var b=this.jb[0];if(b){var c=b.ea-b.fa,e=c/2,d=parseInt(c+c/15*-a.jf,10);a=parseInt(e+e/15*a.We,10);c==d&&d++;e==a&&a++;b.fa-=parseInt(e-a,10);b.fa-=parseInt(c-d,10);b.fa=Math.max(b.fa,b.Ha);b.ea-=parseInt(e-a,10);b.ea+=parseInt(c-d,10);b.ea=Math.min(b.ea,b.ba);eval("this.onWindowLevel();")}};yh.prototype.__defineGetter__("orientation",v("Ma"));
yh.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"AXIAL"==a?(a="Z",this.Ca=2):"SAGITTAL"==a?(a="X",this.Ca=0):"CORONAL"==a&&(a="Y",this.Ca=1);"X"!=a&&("Y"!=a&&"Z"!=a)&&l(Error("Invalid orientation."));this.Ma=a});yh.prototype.__defineGetter__("radiological",v("Ag"));yh.prototype.__defineGetter__("normalizedScale",v("ib"));yh.prototype.__defineGetter__("canvasWidth",function(){return this.qa.width});yh.prototype.__defineGetter__("canvasHeight",function(){return this.qa.height});
yh.prototype.__defineGetter__("sliceWidth",v("Oc"));yh.prototype.__defineGetter__("sliceHeight",v("Lc"));yh.prototype.__defineSetter__("radiological",ba("Ag"));w=yh.prototype;w.Xa=function(){this.Ma||l(Error("No 2D orientation set."));yh.A.Xa.call(this,"2d");this.a.fillStyle="rgba(50,50,50,0)";this.a.fillRect(0,0,this.qa.width,this.qa.height);this.Wd=le("canvas");this.Yd=le("canvas");P(this.M,"g",this.tk.bind(this))};w.Nf=function(){yh.A.Nf.call(this);Fh(this)};
w.Nd=function(){yh.A.Nd.call(this);Fh(this);var a=this.jb[0];a&&(a.ea=a.ba,a.fa=a.Ha)};
w.xb=function(a){yh.A.xb.call(this,a);var b=t;this.get(a.wa)&&(b=q);if(a instanceof S){var c=a.r,e=a.e,d=a.Ba;if(e!=s&&e.r!=s&&e.r.j)this.xb(e);else if(d!=s&&d.r!=s&&d.r.j)this.Z.load(d,a);else{if(c!=s&&ka(c))if(a.tc!=s){if(a.tc.Bf!=c.length||b&&!a.j)return}else{b=0;e=c.length;for(b=0;b<e;b++)this.Z.load(c[b],a);return}else if(c!=s&&c.j){this.Z.load(a,a);return}this.Ca="X"==this.Ma?0:"Y"==this.Ma?1:2;this.Wa=a.c[this.Ca].c;d=s;d=0==this.Ca?a.indexX:1==this.Ca?a.indexY:a.indexZ;c=a.c[this.Ca].c[d].rg;
e=a.c[this.Ca].c[d].qg;this.Pc=a.c[this.Ca].c[d].Sc;this.Mc=a.c[this.Ca].c[d].Dc;this.Oc=c;this.Lc=e;d=this.Wd;d.width=c;d.height=e;var f=this.Yd;f.width=c;f.height=e;this.ng=d.getContext("2d");this.sg=f.getContext("2d");b||(this.tb.add(a),Fh(this))}}};function Fh(a){var b=Math.min(a.J/(a.Oc*a.Pc),a.w/(a.Lc*a.Mc));a.M.o[14]=b}w.jk=aa();
w.Qh=function(a,b){var c=this.jb[0],e=this.M.o,d=s,f=this.Oc,g=this.Lc,h=s,m=s;if("Y"==this.Ma)d=this.Wa[parseInt(c.indexY,10)],h=d.Sc,m=d.Dc,this.Rb[0]="red",this.Rb[1]="blue";else if("Z"==this.Ma)d=this.Wa[parseInt(c.indexZ,10)],h=d.Sc,m=d.Dc,this.Rb[0]="red",this.Rb[1]="green";else{d=this.Wa[parseInt(c.indexX,10)];h=d.Dc;m=d.Sc;this.Rb[0]="green";this.Rb[1]="blue";var j=f,f=g,g=j}var k=1*e[12],n=-1*e[13];this.ib=Math.max(e[14],0.6);j=[this.J/2,this.w/2];h=f*h*this.ib;m=g*m*this.ib;e=j[0]-h/2;j=
j[1]-m/2;e+=k*this.ib;j+=n*this.ib;return a>e&&a<e+h&&b>j&&b<j+m?(k=(a-e)/h*f,n=(b-j)/m*g,m=d.Ai[4],"X"==this.Ma?(j=f-k,k=n,n=j):"Y"==this.Ma?k=f-k:"Z"==this.Ma&&(k=f-k,n=g-n),k=d.zi+k*d.Sc,n=d.ti+n*d.Dc,k=kd(k,n,m,1),f=ld(),vd(d.mi,k,f),g=ld(),vd(d.ni,k,g),d=Math.round((c.b[0].i[0]*g[0]+c.b[0].i[1]*g[1]+c.b[0].i[2]*g[2]+c.b[0].Ze)/c.b[0].Nc),d>=c.b[0].p?d=c.b[0].p-1:0>d&&(d=0),k=Math.round((c.b[1].i[0]*g[0]+c.b[1].i[1]*g[1]+c.b[1].i[2]*g[2]+c.b[1].Ze)/c.b[1].Nc),k>=c.b[1].p?k=c.b[1].p-1:0>k&&(k=
0),n=Math.round((c.b[2].i[0]*g[0]+c.b[2].i[1]*g[1]+c.b[2].i[2]*g[2]+c.b[2].Ze)/c.b[2].Nc),n>=c.b[2].p?n=c.b[2].p-1:0>n&&(n=0),[[d,k,n],[f[0],f[1],f[2]],[g[0],g[1],g[2]]]):s};
w.cc=function(a,b){yh.A.cc.call(this,a,b);if(0!=this.tb.H.length){var c=this.jb[0],e=s,e=0==this.Ca?c.indexX:1==this.Ca?c.indexY:c.indexZ,d=this.Wa[parseInt(e,10)].rg,f=this.Wa[parseInt(e,10)].qg;this.Pc=this.Wa[parseInt(e,10)].Sc;this.Mc=this.Wa[parseInt(e,10)].Dc;this.Oc=d;this.Lc=f;var g=this.J,h=this.w,m=this.M.o;this.a.save();this.a.clearRect(-g,-h,2*g,2*h);this.a.restore();this.ib=Math.max(m[14],0.1);this.a.setTransform(this.ib,0,0,this.ib,0,0);var j=1*m[12],m=-1*m[13],k=s;c.e&&(k=c.e.ff);var n=
this.Wa[parseInt(e,10)],u=n.F.Vb,n=n.e,r=s;n&&(r=n.Vb);var y=this.Oc,z=this.Lc,F=this.ng,H=this.sg,K=F.getImageData(0,0,y,z),B=H.getImageData(0,0,y,z),E=K.data,J=B.data,N=E.length,Q=c.ba,O=c.U,T=c.V,da=c.fa/Q,ea=c.ea/Q;if(this.kg!=e||this.U!=O||this.V!=T||this.fa!=da||this.ea!=ea||k&&!yg(k,this.tg,0)){var L=this.Wd;L.width=d;L.height=f;L=this.Yd;L.width=d;L.height=f;d=0;do{var L=[0,0,0,0],f=[0,0,0,0],oa=u[d]/255*Q,G=u[d],G=(G/255-da)/(ea-da),G=255*G;oa>=O&&oa<=T&&(L=new U(c.Qb[0],c.Qb[1],c.Qb[2]),
L=(new U(c.Ob[0],c.Ob[1],c.Ob[2])).scale(G).add(L.scale(255-G)),L=[Math.floor(L.x),Math.floor(L.y),Math.floor(L.d),255],n&&(-255==k[3]?f=[r[d],r[d+1],r[d+2],r[d+3]]:yg(k,r,d)&&(f=[r[d],r[d+1],r[d+2],r[d+3]])));"X"==this.Ma?(E[d]=L[0],E[d+1]=L[1],E[d+2]=L[2],E[d+3]=L[3],J[d]=f[0],J[d+1]=f[1],J[d+2]=f[2],J[d+3]=f[3]):"Y"==this.Ma?(G=Math.floor(d/(4*y)),G=4*G*y+(4*(y-1)-(d-4*G*y)),E[G]=L[0],E[G+1]=L[1],E[G+2]=L[2],E[G+3]=L[3],J[G]=f[0],J[G+1]=f[1],J[G+2]=f[2],J[G+3]=f[3]):(G=N-1-d,E[G-3]=L[0],E[G-2]=
L[1],E[G-1]=L[2],E[G]=L[3],J[G-3]=f[0],J[G-2]=f[1],J[G-1]=f[2],J[G]=f[3]);d+=4}while(d<N);F.putImageData(K,0,0);H.putImageData(B,0,0);this.kg=e;this.U=O;this.V=T;this.fa=da;this.ea=ea;n&&(this.tg=k)}this.a.globalAlpha=1;this.a.translate(g/2/this.ib,h/2/this.ib);"X"==this.Ma&&(this.a.rotate(0.5*Math.PI),e=j,j=m,m=-e);j=-y*this.Pc/2+j;m=-z*this.Mc/2+m;this.a.drawImage(this.Wd,j,m,y*this.Pc,z*this.Mc);n&&c.e.O&&(this.a.globalAlpha=c.e.sa,this.a.drawImage(this.Yd,j,m,y*this.Pc,z*this.Mc));if(this.S.SLICENAVIGATORS&&
(this.T.ae&&this.T.Eg&&!this.T.sb)&&(j=this.T.ra,j=this.Qh(j[0],j[1])))c.Ab=j[0][0],c.Bb=j[0][1],c.Cb=j[0][2],c.q(t),this.onSliceNavigation(),this.a.setTransform(1,0,0,1,0,0),this.a.lineWidth=1,this.a.beginPath(),this.a.moveTo(this.T.ra[0],0),this.a.lineTo(this.T.ra[0],this.T.ra[1]-10),this.a.moveTo(this.T.ra[0],this.T.ra[1]+10),this.a.lineTo(this.T.ra[0],this.w),this.a.strokeStyle=this.Rb[0],this.a.stroke(),this.a.closePath(),this.a.beginPath(),this.a.moveTo(0,this.T.ra[1]),this.a.lineTo(this.T.ra[0]-
10,this.T.ra[1]),this.a.moveTo(this.T.ra[0]+10,this.T.ra[1]+0.5),this.a.lineTo(this.J,this.T.ra[1]),this.a.strokeStyle=this.Rb[1],this.a.stroke(),this.a.closePath(),this.a.font="10pt Arial",this.a.textAlign="left",this.a.textBaseline="top",this.a.fillStyle="white",this.a.fillText("RAS: "+j[2][0].toFixed(2)+", "+j[2][1].toFixed(2)+", "+j[2][2].toFixed(2),0,0),y=n=m="undefined","undefined"!=typeof c.ja[j[1][2].toFixed(0)]&&"undefined"!=typeof c.ja[j[1][2].toFixed(0)][j[1][1].toFixed(0)]&&(m=c.ja[j[1][2].toFixed(0)][j[1][1].toFixed(0)][j[1][0].toFixed(0)],
c.K&&(n=c.e.ja[j[1][2].toFixed(0)][j[1][1].toFixed(0)][j[1][0].toFixed(0)],c.e.$c&&(y=c.e.$c.get(n),"undefined"!=typeof y&&(y=y[0])))),this.a.fillText("Background:  "+m+" ("+j[1][0].toFixed(0)+", "+j[1][1].toFixed(0)+", "+j[1][2].toFixed(0)+")",0,15),c.K&&this.a.fillText("Labelmap:  "+y+" ("+n+")",0,30)}};C("X.renderer2D",yh);C("X.renderer2D.prototype.init",yh.prototype.Xa);C("X.renderer2D.prototype.add",yh.prototype.add);C("X.renderer2D.prototype.onShowtime",yh.prototype.th);
C("X.renderer2D.prototype.onRender",yh.prototype.rh);C("X.renderer2D.prototype.onScroll",yh.prototype.ik);C("X.renderer2D.prototype.onWindowLevel",yh.prototype.sk);C("X.renderer2D.prototype.get",yh.prototype.get);C("X.renderer2D.prototype.resetViewAndRender",yh.prototype.Nd);C("X.renderer2D.prototype.xy2ijk",yh.prototype.Qh);C("X.renderer2D.prototype.render",yh.prototype.bc);C("X.renderer2D.prototype.destroy",yh.prototype.le);C("X.renderer2D.prototype.onSliceNavigation",yh.prototype.jk);
C("X.renderer2D.prototype.afterRender",yh.prototype.Hg);
